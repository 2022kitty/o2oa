MWF.xDesktop.requireApp("process.FormDesigner","Property",null,false);MWF.xApplication.cms.FormDesigner.Property=MWF.CMSFCProperty=new Class({Extends:MWF.FCProperty,loadScriptEditor:function(t,i){t.each(function(t){var e=t.get("title");var n=t.get("name");var s=this.data[n];MWF.require("MWF.widget.ScriptArea",function(){var o=new MWF.widget.ScriptArea(t,{title:e,maxObj:this.designer.formContentNode,onChange:function(){this.data[n]=o.toJson()}.bind(this),onSave:function(){this.designer.saveForm()}.bind(this),style:i||"default",helpStyle:"cms"});o.load(s)}.bind(this))}.bind(this))},getViewList:function(t,i){if(!this.views||i){this.form.designer.actions.listQueryView(this.form.designer.application.id,function(i){this.views=i.data;if(t)t()}.bind(this))}else{if(t)t()}},loadActionArea:function(){var t=this.propertyContent.getElements(".MWFActionArea");t.each(function(t){var i=t.get("name");var e=this.data[i];MWF.xDesktop.requireApp("cms.FormDesigner","widget.ActionsEditor",function(){var n=new MWF.xApplication.cms.FormDesigner.widget.ActionsEditor(t,this.designer,{maxObj:this.propertyNode.parentElement.parentElement.parentElement,onChange:function(){this.data[i]=n.data}.bind(this)});n.load(e)}.bind(this))}.bind(this))},loadEventsEditor:function(){var t=this.propertyContent.getElement(".MWFEventsArea");if(t){var i=t.get("name");var e=this.data[i];MWF.xDesktop.requireApp("cms.FormDesigner","widget.EventsEditor",function(){var i=new MWF.xApplication.cms.FormDesigner.widget.EventsEditor(t,this.designer,{maxObj:this.designer.formContentNode});i.load(e)}.bind(this))}},loadValidation:function(){var t=this.propertyContent.getElements(".MWFValidation");if(t.length){t.each(function(t){var i=t.get("name");MWF.xDesktop.requireApp("cms.FormDesigner","widget.ValidationEditor",function(){var e=new MWF.xApplication.cms.FormDesigner.widget.ValidationEditor(t,this.designer,{onChange:function(){var t=e.getValidationData();this.data[i]=t}.bind(this)});e.load(this.data[i])}.bind(this))}.bind(this))}}});MWF.xApplication.cms.FormDesigner.PropertyMulti=new Class({Extends:MWF.xApplication.cms.FormDesigner.Property,Implements:[Options,Events],initialize:function(t,i,e,n,s){this.setOptions(s);this.modules=i;this.form=t;this.data={};this.htmlPath=this.options.path;this.designer=n;this.maplists={};this.propertyNode=e},load:function(){if(this.fireEvent("queryLoad")){MWF.getRequestText(this.htmlPath,function(t,i){this.htmlString=t;MWF.require("MWF.widget.JsonTemplate",function(){this.fireEvent("postLoad")}.bind(this))}.bind(this))}},show:function(){if(!this.propertyContent){if(this.htmlString){this.JsonTemplate=new MWF.widget.JsonTemplate({},this.htmlString);this.propertyContent=new Element("div",{styles:{overflow:"hidden"}}).inject(this.propertyNode);this.propertyContent.set("html",this.JsonTemplate.load());this.setEditNodeEvent();this.setEditNodeStyles(this.propertyContent);this.loadPropertyTab();this.loadMaplist();this.loadScriptArea();this.loadTreeData();this.loadArrayList()}}else{this.propertyContent.setStyle("display","block")}},hide:function(){if(this.propertyContent)this.propertyContent.destroy()},changeStyle:function(t){this.modules.each(function(i){i.setPropertiesOrStyles(t)}.bind(this))},changeData:function(t,i,e){this.modules.each(function(n){n._setEditStyle(t,i,e)}.bind(this))},changeJsonDate:function(t,i){this.modules.each(function(e){e.json[t]=i}.bind(this))}});