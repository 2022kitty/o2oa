MWF.xApplication.process.FormDesigner.Module=MWF.xApplication.process.FormDesigner.Module||{};MWF.xDesktop.requireApp("process.FormDesigner","Module.$Module",null,false);MWF.xApplication.process.FormDesigner.Module.$Component=MWF.FC$Component=new Class({Extends:MWF.FC$Module,Implements:[Options,Events],_setNodeProperty:function(){this.node.store("module",this);if(this.form.moduleList.indexOf(this)==-1)this.form.moduleList.push(this);if(this.form.moduleNodeList.indexOf(this.node)==-1)this.form.moduleNodeList.push(this.node);if(this.form.moduleComponentNodeList.indexOf(this.node)==-1)this.form.moduleComponentNodeList.push(this.node)},_initModule:function(){if(!this.initialized){this.setPropertiesOrStyles("styles");this.setPropertiesOrStyles("properties");this._getContainers();this._getElements();this._setNodeProperty();this._createIconAction();this._setNodeEvent();this.initialized=true}},_getElements:function(){},_getContainers:function(){},destroy:function(){this.containers.each(function(e){e.destroy()});this.elements.each(function(e){e._deleteModule()});this._deleteModule()},_deleteModule:function(){this.form.moduleList.erase(this);this.form.moduleNodeList.erase(this.node);this.form.moduleElementNodeList.erase(this.node);this.node.destroy();this.actionArea.destroy();delete this.form.json.moduleList[this.json.id];this.json=null;delete this.json;this.treeNode.destroy()},_dragIn:function(e){e.inContainer=null;e.parentContainer=this.parentContainer;e.nextModule=this;this.parentContainer.node.setStyles({border:"1px solid #ffa200"});var t=e._getCopyNode();t.inject(this.node,"before")},_dragOut:function(e){e.inContainer=null;e.parentContainer=null;e.nextModule=null;this.parentContainer.node.setStyles(this.parentContainer.css.moduleNode);this.parentContainer.node.setStyles(this.parentContainer.json.styles);var t=e._getCopyNode();t.setStyle("display","none")},_dragDrop:function(e){this.parentContainer.node.setStyles(this.parentContainer.css.moduleNode);this.parentContainer.setCustomStyles()},copy:function(e){var t=this.copyTo();t.move(e)},copyClearContainer:function(){var e=[];this.containers.each(function(t){var o=new Element("div");var n=t.node.getFirst();while(n){var i=n.getNext();n.inject(o);n=i}e.push(o)}.bind(this));return e},copyRecoverContainer:function(e){this.containers.each(function(t,o){var n=e[o];var i=n.getFirst();while(i){var s=i.getNext();i.inject(t.node);i=s}n.destroy()}.bind(this));delete e},copyTo:function(e){if(!e)e=this.form;var t=this.copyClearContainer();var o=this.node.clone(true);var n=Object.clone(this.json);o.inject(e.node);var i=this.moduleName.capitalize();var s=new MWF["FC"+i](this.form);n.id=s._getNewId();o.set("id",n.id);this.form.json.moduleList[n.id]=n;this.copyComponentJsonData(o,n.id);s.load(n,o,e);this.copyRecoverContainer(t);this.containers.each(function(e,t){var o=e._getSubModule();o.each(function(e){if(e.moduleType=="container"){e.copySubModule(s.containers[t])}if(e.moduleType=="element"){e.copyTo(s.containers[t])}if(e.moduleType=="component"){e.copyTo(s.containers[t])}})});return s},parseModules:function(){}});