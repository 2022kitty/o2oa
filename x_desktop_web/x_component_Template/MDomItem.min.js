var MDomItem=new Class({Implements:[Options,Events],options:{existItem:null,existName:null,existId:null,objectId:"",name:"",value:"",text:"",type:"text",isEdited:true,tType:"",count:1,departments:[],companys:[],event:null,selectValue:"",selectText:"",defaultValue:"",className:"",style:{},attr:{},notEmpty:false,defaultValueAsEmpty:false,emptyTip:null,warningType:"batch",validRule:null,validMessage:null,RTFConfig:null},initialize:function(e,t,s,i,n){this.form=s;this.app=i;this.container=$(e);this.css=n;for(var a in t){if(a!="validRule"&&a!="validMessage"&&a.substr(0,2)!="on"&&typeOf(t[a])=="function"){t[a]=t[a].call()}}this.setOptions(t);this.unsetClassType=["radio","checkbox","select","multiselect","img","button","hidden"];this.valSeparator=/,|;|\^\^|\|/;this.mElement=null;this.items=[]},load:function(){this.fireEvent("queryLoad");if(this.options.existItem||this.options.existName||this.options.existId){this.processExist()}else{this.createElement()}this.fireEvent("postLoad")},processExist:function(){var e=this;var t,s;if(this.options.existItem){t=$$(this.options.existItem)}else if(this.options.existName){t=$$("[name='"+this.options.existName+"']")}else if(this.options.existId){t=$$("#"+this.options.existId)}if(!this.container){this.mElement=this.container=t[0].getParent()}this.options.type=this.options.type||this.getType(item[0]);this.options.name=this.options.name||item[0].get("name");this.options.value=this.options.value||this.getValue(this.options.name);t.each(function(e){if(this.options.className){e.setStyles(this.options.className)}if(this.options.style&&typeof this.options.style=="object"){e.setStyles(this.options.style)}var t=this.options.event;this.bindEvent(e,t,s)}.bind(this));this.items=t},createElement:function(){var e=this;var t;var s;var n=this.options.type;if(!n||n=="")n="text";var a=this.options.tType;var l=this.options.name;var r;if(typeOf(this.options.value)==="boolean"){r=this.options.value.toString()}else{r=this.options.value||this.options.defaultValue}var o=this.options.selectValue||this.options.selectText;var c=this.options.selectText||this.options.selectValue;var h=this.options.event;var u=this.options.style||{};var p=this.options.attr||{};var f=this.options.isEdited;var d=this.mElement=this.container;var m=null;if(this.options.className=="none"){}else if(this.options.className!=""){m=this.options.className}else if(!f){}else{switch(n.toLowerCase()){case"text":if(!a){m="inputText"}else if(a=="number"){m="inputText"}else if(a=="time"||a=="date"||a.toLowerCase()=="datetime"){m="inputTime"}else if(a=="person"||a=="department"||a=="company"||a=="identity"){m="inputPerson"}else{m="inputText"}break;case"number":m="inputText";break;case"password":m="inputPassword";break;case"radio":m="inputRadio";break;case"checkbox":m="inputCheckbox";break;case"select":m="inputSelect";break;case"multiselect":m="inputMultiselect";break;case"img":break;case"textarea":m="inputTextarea";break;case"button":m="inputButton";break;case"hidden":break;case"innertext":break;case"rtf":break;case"file":m="inputFile";break;case"attachment":m="inputFile";break;default:m="inputText"}}if(f){switch(n.toLowerCase()){case"text":t=new Element("input",{type:"text",name:l,value:r});t.set(p);if(m&&this.css&&this.css[m])t.setStyles(this.css[m]);t.setStyles(u);this.bindEvent(t,h,n,a);if(d)t.inject(d);this.items.push(t);break;case"password":t=new Element("input",{type:"password",name:l,value:r});t.set(p);if(m&&this.css&&this.css[m])t.setStyles(this.css[m]);t.setStyles(u);this.bindEvent(t,h,n,a);if(d)t.inject(d);this.items.push(t);break;case"radio":selectValues=typeOf(o)=="array"?o:o.split(this.valSeparator);selectTexts=typeOf(c)=="array"?c:c.split(this.valSeparator);for(i=0;i<selectValues.length;i++){t=new Element("div");if(m&&this.css&&this.css[m])t.setStyles(this.css[m]);t.setStyles(u);var v=new Element("input",{type:"radio",name:l,value:selectValues[i],checked:selectValues[i]==r}).inject(t);v.set(p);var y=new Element("span",{text:selectTexts[i]}).inject(t);y.addEvent("click",function(){this.input.checked=!this.input.checked}.bind({input:v}));this.bindEvent(t,h,n);if(d)t.inject(d);this.items.push(t)}break;case"checkbox":s=typeOf(r)=="string"?r.split(this.valSeparator):r;s=typeOf(r)=="array"?r:[r];selectValues=typeOf(o)=="array"?o:o.split(this.valSeparator);selectTexts=typeOf(c)=="array"?c:c.split(this.valSeparator);for(i=0;i<selectValues.length;i++){t=new Element("div");if(m&&this.css&&this.css[m])t.setStyles(this.css[m]);t.setStyles(u);var v=new Element("input",{type:"checkbox",name:l,value:selectValues[i],checked:s.contains(selectValues[i])}).inject(t);v.set(p);var y=new Element("span",{text:selectTexts[i]}).inject(t);y.addEvent("click",function(){this.input.checked=!this.input.checked}.bind({input:v}));this.bindEvent(t,h,n);if(d)t.inject(d);this.items.push(t)}break;case"select":t=new Element("select",{name:l});t.set(p);if(m&&this.css&&this.css[m])t.setStyles(this.css[m]);t.setStyles(u);selectValues=typeOf(o)=="array"?o:o.split(this.valSeparator);selectTexts=typeOf(c)=="array"?c:c.split(this.valSeparator);for(i=0;i<selectValues.length;i++){new Element("option",{value:selectValues[i],selected:selectValues[i]==r,text:selectTexts[i]}).inject(t)}this.bindEvent(t,h,n);if(d)t.inject(d);this.items.push(t);break;case"multiselect":s=typeOf(r)=="string"?r.split(this.valSeparator):r;s=typeOf(r)=="array"?r:[r];t=new Element("select",{name:l,multiple:true});t.set(p);if(m&&this.css&&this.css[m])t.setStyles(this.css[m]);t.setStyles(u);selectValues=typeOf(o)=="array"?o:o.split(this.valSeparator);selectTexts=typeOf(c)=="array"?c:c.split(this.valSeparator);for(i=0;i<selectValues.length;i++){new Element("option",{value:selectValues[i],selected:s.contains(selectValues[i]),text:selectTexts[i]}).inject(t)}this.bindEvent(t,h,n);if(d)t.inject(d);this.items.push(t);break;case"img":t=new Element("img",{name:l,src:r});t.set(p);if(m&&this.css&&this.css[m])t.setStyles(this.css[m]);t.setStyles(u);this.bindEvent(t,h,n);if(d)t.inject(d);this.items.push(t);break;case"textarea":t=new Element("textarea",{name:l,value:r});t.set(p);if(m&&this.css&&this.css[m])t.setStyles(this.css[m]);t.setStyles(u);this.bindEvent(t,h,n);if(d)t.inject(d);this.items.push(t);break;case"button":t=new Element("button",{name:l,value:r,text:r});t.set(p);if(m&&this.css&&this.css[m])t.setStyles(this.css[m]);t.setStyles(u);this.bindEvent(t,h,n);if(d)t.inject(d);this.items.push(t);break;case"hidden":t=new Element("input",{type:"hidden",name:l,value:r,styles:u});t.set(p);if(d)t.inject(d);this.items.push(t);break;case"innertext":if(this.options.selectValue&&this.options.selectText){r=this.replaceText(r,this.options.selectValue,this.options.selectText);r=r.join(",")}t=new Element("span",{name:l,text:r});t.set(p);if(m&&this.css&&this.css[m])t.setStyles(this.css[m]);t.setStyles(u);this.bindEvent(t,h,n);if(d)t.inject(d);this.items.push(t);break;case"rtf":COMMON.AjaxModule.load("ckeditor",function(){var t=new Element("div",{name:l,id:l});t.set(p);if(d)t.inject(d);if(r)t.set("html",r);var s={resize_enabled:true,autoParagraph:true,autoUpdateElement:true,enterMode:1,readOnly:false};if(this.options.RTFConfig){s=Object.merge(s,this.options.RTFConfig)}if(!s.filebrowserFilesImage&&!s.cloudFileDisable){s.filebrowserFilesImage=function(t,s){MWF.xDesktop.requireApp("File","FileSelector",function(){e.selector_cloud=new MWF.xApplication.File.FileSelector(document.body,{style:"default",title:"选择云文件图片",toBase64:true,listStyle:"preview",selectType:"images",onPostSelectAttachment:function(e,t){if(s)s(e,t)}});e.selector_cloud.load()},true)}}this.editor=CKEDITOR.replace(t,s);this.items.push(this.editor)}.bind(this));break;case"file":t=new Element("input",{type:"file",name:l,id:l,value:r});t.set(p);if(m&&this.css&&this.css[m])t.setStyles(this.css[m]);t.setStyles(u);this.bindEvent(t,h,n);if(d)t.inject(d);this.items.push(t);break;default:t=new Element("input",{type:"text",name:l,value:r});t.set(p);if(m&&this.css&&this.css[m])t.setStyles(this.css[m]);t.setStyles(u);this.bindEvent(t,h,n);if(d)t.inject(d);this.items.push(t)}}else{switch(n.toLowerCase()){case"radio":case"checkbox":case"select":case"multiselect":case"innertext":if(this.options.selectValue&&this.options.selectText){r=this.replaceText(r,this.options.selectValue,this.options.selectText);r=r.join(",")}t=new Element("span",{name:l,text:r});t.set(p);if(m&&this.css&&this.css[m])t.setStyles(this.css[m]);t.setStyles(u);if(d)t.inject(d);this.items.push(t);break;case"img":t=new Element("img",{name:l,src:r});t.set(p);if(m&&this.css&&this.css[m])t.setStyles(this.css[m]);t.setStyles(u);this.bindEvent(t,h,n);if(d)t.inject(d);this.items.push(t);break;case"button":t=new Element("button",{name:l,value:r,text:r});t.set(p);if(m&&this.css&&this.css[m])t.setStyles(this.css[m]);t.setStyles(u);this.bindEvent(t,h,n);if(d)t.inject(d);this.items.push(t);break;case"hidden":t=new Element("input",{type:"hidden",name:l,value:r,styles:u});t.set(p);if(d)t.inject(d);this.items.push(t);break;case"rtf":t=new Element("span",{name:l,html:r});t.set(p);if(m&&this.css&&this.css[m])t.setStyles(this.css[m]);t.setStyles(u);if(d)t.inject(d);this.items.push(t);break;case"file":t=new Element("input",{type:"file",name:l,id:l,value:r});t.set(p);if(m&&this.css&&this.css[m])t.setStyles(this.css[m]);t.setStyles(u);this.bindEvent(t,h,n);if(d)t.inject(d);this.items.push(t);break;case"text":case"textarea":default:t=new Element("span",{name:l,text:r});t.set(p);if(m&&this.css&&this.css[m])t.setStyles(this.css[m]);t.setStyles(u);if(d)t.inject(d);this.items.push(t);break}}return d},replaceText:function(e,t,s){var i=typeOf(e)=="array"?e:e.split(this.valSeparator);var n=typeOf(t)=="array"?t:t.split(this.valSeparator);var a=typeOf(s)=="array"?s:s.split(this.valSeparator);for(var l=0;l<i.length;l++){for(var r=0;r<n.length;r++){if(i[l]==n[r]){i[l]=a[r]}}}return i},bindEvent:function(item,events,type,tType){if(tType)this.bindTTypeEvent(item,tType);if(!events||events==""||events=="$none")return;var _self=this;if(typeof events=="string"){if(events.indexOf("^^")>-1){var eventsArr=events.split("##");if(eventsArr[0].split("^^").length!=2)return;events={};for(var i=0;i<eventsArr.length;i++){var ename=eventsArr[i].split("^^")[0];var efunction=eventsArr[i].split("^^")[1];events[ename]=eval("(function(){ return "+efunction+" })()")}}else{eval("var events = "+events)}}if(typeOf(events)=="object"){for(var e in events){item.addEvent(e,function(e){this.fun.call(e?e.target:null,_self,e)}.bind({fun:events[e]}))}}},bindTTypeEvent:function(e,t){if(t=="number"){e.addEvent("keyup",function(){this.value=this.value.replace(/[^\d.]/g,"")})}else if(t=="time"||t.toLowerCase()=="datetime"||t=="date"){e.addEvent("click",function(){this.selectCalendar(e,t)}.bind(this))}else if(t=="person"||t=="department"||t=="company"||t=="identity"){e.addEvent("click",function(){this.selectPerson(e,t)}.bind(this))}},selectCalendar:function(e,t){this.fireEvent("querySelect",this);MWF.require("MWF.widget.Calendar",function(){var s=new MWF.widget.Calendar(e,{style:"xform",isTime:t=="time"||t.toLowerCase()=="datetime",timeOnly:t=="time",target:this.app.content});s.show()}.bind(this))},selectPerson:function(e,t){MWF.xDesktop.requireApp("Organization","Selector.package",null,false);this.fireEvent("querySelect",this);var s=e.get("value").split(this.valSeparator);var i={type:t,title:this.options.text,count:this.options.count,names:s||[],departments:this.options.departments,companys:this.options.companys,onComplete:function(t){var s=[];t.each(function(e){s.push(e.data.name)}.bind(this));e.set("value",s.join(","));this.items[0].fireEvent("change")}.bind(this)};var n=new MWF.OrgSelector(this.app.content,i)},getType:function(e){var t=e.tagName.toLowerCase();if(t=="input"){type=e.get("type")?e.get("type").toLowerCase():"text"}else if(t=="select"){if(e.get("multiple")){type="multiselect"}else if(e.get("type")&&e.get("type").toLowerCase()=="select-multiple"){type="multiselect"}else{type="select"}}else{type=t}},get:function(e,t){var s;var i;var n;var a;if(!t){t=this.options.name;a=this.mElement.getElements("[name='"+t+"']");n=this.options.type}else{a=$$("[name='"+t+"']");n=this.getType(a[0])}if(this.options.isEdited){switch(n.toLowerCase()){case"text":s=a[0].get("value");break;case"password":s=a[0].get("value");break;case"hidden":s=a[0].get("value");break;case"innertext":i=a[0].get("text");if(this.options.selectValue&&this.options.selectText){s=this.replaceText(i,this.options.selectText,this.options.selectValue)}else{s=i}break;case"radio":a.each(function(e){if(e.checked){s=e.get("value");i=e.getParent().get("text").trim()}});break;case"checkbox":s=[];i=[];a.each(function(e){if(e.checked){s.push(e.get("value"));i.push(e.getParent().get("text").trim())}});break;case"textarea":s=a[0].get("value");break;case"select":a[0].getElements("option").each(function(e){if(e.selected){s=e.get("value");i=e.get("text").trim()}});break;case"multiselect":s=[];i=[];a[0].getElements("option").each(function(e){if(e.selected){s.push(e.get("value"));i.push(e.get("text").trim())}});break;case"rtf":if(this.options.RTFConfig&&this.options.RTFConfig.isSetImageMaxWidth){var l=new Element("div",{styles:{display:"none"},html:this.editor.getData()}).inject(this.container);l.getElements("img").each(function(e){e.setStyle("max-width","100%")});s=l.get("html");l.destroy()}else{s=this.editor.getData()}break;case"file":s=a[0].get("value");break;default:s=a[0].get("value")}}else{switch(n.toLowerCase()){case"text":case"textarea":s=a[0].get("text");break;case"hidden":s=a[0].get("value");break;case"innertext":case"radio":case"checkbox":case"select":case"multiselect":i=a[0].get("text");if(this.options.selectValue&&this.options.selectText){s=this.replaceText(i,this.options.selectText,this.options.selectValue)}else{s=i}break;case"rtf":s=a[0].get("html");break;case"file":s=a[0].get("value");break;default:s=a[0].get("text")}}if(!s)s="";if(!i)i=s;var r={};r.value=s;r.text=i;if(e=="value")return s;if(e=="text")return i;return r},getValue:function(e){return this.get(null,e).value},getText:function(e){return this.get(null,e).text},getModifiedValue:function(){var e=this.getValue();return e==this.options.value?null:e},getModifiedText:function(){var e=this.getText();return text==this.options.text?null:text},set:function(e,t){this.setValue(t)},resetItemOptions:function(e,t){var s="radio,checkbox,select,multiselect".split(",");if(!s.contains(this.options.type))return;this.dispose();this.options.selectValue=e;this.options.selectText=t;this.createElement()},setValue:function(e){var t=this.mElement.getElements("[name='"+this.options.name+"']");if(this.options.isEdited){switch(this.options.type.toLowerCase()){case"text":t[0].set("value",e);break;case"password":t[0].set("value",e);break;case"hidden":t[0].set("value",e);break;case"innertext":t[0].set("text",e);break;case"radio":t.each(function(t){if(t.get("value")==e)this.checked=true});break;case"checkbox":values=typeOf(e)=="array"?e:e.split("^^");t.each(function(e){if(values.contains(e.get("value"))!=-1){this.checked=true}else{this.checked=false}});break;case"textarea":t[0].set("value",e);break;case"rtf":this.editor.setData(e);break;case"select":t[0].getElements("option").each(function(t){if(t.get("value")==e)this.selected=true});break;case"multiselect":values=typeOf(e)=="array"?e:e.split("^^");t[0].getElements("option").each(function(e){if(values.contains(e.get("value"))!=-1){this.selected=true}else{this.selected=false}});break;default:t[0].set("value",e)}}else{if(this.options.type.toLowerCase()=="rtf"){t[0].set("html",e)}else{t[0].set("text",e)}}},setStyles:function(e){this.items.each(function(t){t.setStyles(e)})},getElements:function(){return this.mElement.getElements("[name='"+this.options.name+"']")},dispose:function(){this.container.empty()},verify:function(e){var t=true;if(!this.options.isEdited)return t;if(this.options.warningType=="batch"){if(!this.isNotEmpty(e))t=false;if(!this.checkValid(e))t=false}else{if(!this.isNotEmpty(e)||!this.checkValid(e)){return false}}return t},isNotEmpty:function(e){if(!this.options.isEdited)return true;if(this.options.notEmpty==true||this.options.notEmpty=="yes"){if(!this.checkNotEmpty(e)){return false}}return true},checkNotEmpty:function(e){var t=this.getValue();var s=typeOf(t)==="array"?t.length==0:t==""||t==" ";if(!s&&this.options.defaultValueAsEmpty){s=typeOf(t)==="array"?t.length==1&&t[0]==this.options.defaultValue:t==this.options.defaultValue}if(!s){this.clearWarning("empty");return true}if(!e)return false;var i=this.options.text;var n=this.mElement.getElements("[name='"+this.options.name+"']");var a="";var l=false;var r=null;try{switch(this.options.type.toLowerCase()){case"text":a=this.options.emptyTip||i+"不能为空";l=false;break;case"password":a=this.options.emptyTip||i+"不能为空";l=false;break;case"hidden":a=this.options.emptyTip||i+"不能为空";break;case"radio":a=this.options.emptyTip||"请先选择"+i;break;case"checkbox":a=this.options.emptyTip||"请先选择"+i;break;case"textarea":a=this.options.emptyTip||i+"不能为空";l=false;break;case"select":a=this.options.emptyTip||"请先选择"+i;l=false;break;case"multiselect":a=this.options.emptyTip||"请先选择"+i;l=false;break;case"file":a=this.options.emptyTip||"请先上传"+i;break;case"attachment":a=this.options.emptyTip||"请先上传"+i;break;default:a=this.options.emptyTip||i+"不能为空";l=false}if(this.options.warningType=="batch"){this.setWarning(a,"empty")}else if(this.options.warningType=="single"){this.setWarning(a,"empty")}else{this.app.notice(a,"error");n[0].focus()}this.fireEvent("empty",this)}catch(e){}return false},clearWarning:function(e){if(this.tipNode&&this.setedEmpty){this.fireEvent("unempty",this);this.tipNode.empty();this.setedEmpty=false}if(e=="empty"){if(this.warningEmptyNode){this.fireEvent("unempty",this);this.warningEmptyNode.destroy();this.warningEmptyNode=null}}else{if(this.warningInvalidNode){this.fireEvent("unempty",this);this.warningInvalidNode.destroy();this.warningInvalidNode=null}}this.warningStatus=false},setWarning:function(e,t){if(t=="empty"){if(this.tipNode){this.setedEmpty=true;var s=this.tipNode;s.set("html","")}else if(this.warningEmptyNode){var s=this.warningEmptyNode;s.set("html","")}else{var s=this.warningEmptyNode=new Element("div");s.inject(this.container)}}else{if(this.tipNode){this.setedEmpty=true;var s=this.tipNode;s.set("html","")}else if(this.warningInvalidNode){var s=this.warningInvalidNode;s.set("html","")}else{var s=this.warningInvalidNode=new Element("div");s.inject(this.container)}}this.warningStatus=true;if(typeOf(e)!="array"){e=[e]}e.each(function(e){var t=new Element("div",{text:e,styles:this.css.warningMessageNode}).inject(s)}.bind(this))},checkValid:function(e){var t=this.getValue();var s=this.options.validRule;if(!s)return true;var i=[];var n=true;if(t&&t!=""&&t!=" "){for(var a in s){var l=true;var r=s[a];if(typeof r=="function"){l=r.call(this,t,this)}else if(this.validMethod[a]){var o=this.validMethod[a];l=o.call(this,t,r,this)}if(!l&&e){var c=this.getValidMessage(a,r);if(c!="")i.push(c)}if(!l)n=false}}if(i.length>0){if(this.options.warningType=="batch"){this.setWarning(i,"invaild")}else if(this.options.warningType=="single"){this.setWarning(i,"invaild")}else{this.app.notice(i.join("\n"),"error")}this.fireEvent("empty",this)}else{if(this.warningInvalidNode&&this.warningInvalidNode.length){this.warningInvalidNode.destroy();this.warningInvalidNode=null}this.fireEvent("unempty",this)}return n},validMethod:{email:function(e){return/^[a-zA-Z0-9.!#$%&'*+\/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/.test(e)},url:function(e){return/^(https?|s?ftp):\/\/(((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:)*@)?(((\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5]))|((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?)(:\d*)?)(\/((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)+(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*)?)?(\?((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|[\uE000-\uF8FF]|\/|\?)*)?(#((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|\/|\?)*)?$/i.test(e)},phoneNumber:function(e){return/^0?1[0-9]\d{9}$/.test(e)},date:function(e){return!/Invalid|NaN/.test(new Date(e).toString())},dateISO:function(e){return/^\d{4}[\/\-](0?[1-9]|1[012])[\/\-](0?[1-9]|[12][0-9]|3[01])$/.test(e)},number:function(e){return/^-?(?:\d+|\d{1,3}(?:,\d{3})+)?(?:\.\d+)?$/.test(e)},digits:function(e){return/^\d+$/.test(e)},minlength:function(e,t){return e.length>=t},maxlength:function(e,t){return e.length<=t},rangelength:function(e,t){return e.length>=t[0]&&e.length<=t[1]},min:function(e,t){return e>=t},max:function(e,t){return e<=t},range:function(e,t){return e>=t[0]&&e<=t[1]},extension:function(e,t){t=typeOf(t)=="array"?t.join("|"):t.replace(/,/g,"|");return e.match(new RegExp(".("+t+")$","i"))}},getValidMessage:function(e,t){var s=this.options.validMessage;if(s&&typeOf(s)=="object"){if(s[e]){if(typeof s[e]=="function"){return s[e].call(this)}else{return s[e]}}}switch(e){case"email":return"请输入正确格式的电子邮件";case"url":return"请输入合法的网址";case"phoneNumber":return"请输入正确的手机号码";case"date":return"请输入合法的日期";case"dateISO":return"请输入合法的日期 .";case"number":return"请输入合法的数字";case"digits":return"只能输入整数";case"maxlength":return"长度不能超过"+t;case"minlength":return"长度不能小于"+t;case"rangelength":return"长度不能要介于"+t[0]+"和"+t[1]+"之间";case"range":return"请输入一个介于"+t[0]+" 和 "+t[1]+"之间的值";case"min":return"请输入一个最小为"+t+" 的值";case"max":return"请输入一个最大为"+t+"的值";case"extension":return"请上传"+t+"格式的附件";default:return"请输入正确的"+this.options.text}}});