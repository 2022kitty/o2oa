MWF.xApplication.Execution=MWF.xApplication.Execution||{};MWF.xDesktop.requireApp("Template","Explorer",null,false);MWF.require("MWF.widget.Identity",null,false);MWF.xApplication.Execution.WorkStat=new Class({Extends:MWF.widget.Common,Implements:[Options,Events],options:{style:"default"},initialize:function(t,e,i,s){this.app=e;this.lp=e.lp.workStat;this.path="/x_component_Execution/$WorkStat/";this.actions=i;this.options.style=this.getViewStyle();this.setOptions(s);this.loadCss();this.node=$(t)},loadCss:function(){this.cssPath="/x_component_Execution/$WorkStat/"+this.options.style+"/css.wcss";this._loadCss()},load:function(){this.middleContent=this.app.middleContent;this.createNaviContent();this.resizeWindow();this.app.addEvent("resize",function(){this.resizeWindow()}.bind(this))},resizeWindow:function(){var t=this.app.middleContent.getSize();this.naviDiv.setStyles({height:t.y-40+"px"});this.naviContentDiv.setStyles({height:t.y-180+"px"});this.contentDiv.setStyles({height:t.y-60+"px"});if(this.deptStatContent){this.deptStatContent.setStyles({height:t.y-130+"px"})}if(this.statViewListDiv){var e=this.contentDiv.getSize().y-this.dateToolbar.getSize().y-this.dateStatListDiv.getSize().y;this.statViewListDiv.setStyles({height:e-40+"px"})}},createNaviContent:function(){this.naviDiv=new Element("div.naviDiv",{styles:this.css.naviDiv}).inject(this.middleContent);this.naviTitleDiv=new Element("div.naviTitleDiv",{styles:this.css.naviTitleDiv,text:this.lp.minderExplorerTitle}).inject(this.naviDiv);this.naviContentDiv=new Element("div.naviContentDiv",{styles:this.css.naviContentDiv}).inject(this.naviDiv);this.naviBottomDiv=new Element("div.naviBottomDiv",{styles:this.css.naviBottomDiv}).inject(this.naviDiv);this.createContentDiv();var t=this.path+"navi.json";MWF.getJSON(t,function(t){t.each(function(t,e){var i=new Element("li.naviContentLi",{styles:this.css.naviContentLi}).inject(this.naviContentDiv);i.addEvents({mouseover:function(t){if(this.bindObj.currentNaviItem!=this.node)this.node.setStyles(this.styles)}.bind({styles:this.css.naviContentLi_over,node:i,bindObj:this}),mouseout:function(t){if(this.bindObj.currentNaviItem!=this.node)this.node.setStyles(this.styles)}.bind({styles:this.css.naviContentLi,node:i,bindObj:this}),click:function(t){if(this.bindObj.currentNaviItem)this.bindObj.currentNaviItem.setStyles(this.bindObj.css.naviContentLi);this.node.setStyles(this.styles);this.bindObj.currentNaviItem=this.node;if(this.action&&this.bindObj[this.action]){this.bindObj[this.action]()}}.bind({styles:this.css.naviContentLi_current,node:i,bindObj:this,action:t.action})});var s=new Element("img.naviContentImg",{styles:this.css.naviContentImg,src:this.path+"default/icon/"+t.icon}).inject(i);var n=new Element("span.naviContentSpan",{styles:this.css.naviContentSpan,text:t.title}).inject(i);if(e==0){i.click()}}.bind(this))}.bind(this))},createContentDiv:function(){this.contentDiv=new Element("div.contentDiv",{styles:this.css.contentDiv}).inject(this.middleContent)},openCenterWork:function(){this.contentDiv.empty();this.loadCategoryBar();this.loadToolbar()},loadCategoryBar:function(){var t=this;this.categoryBar=new Element("div.categoryBar",{styles:this.css.categoryBar}).inject(this.contentDiv);this.allCategoryNode=new Element("li.allCategoryNode",{styles:this.css.categoryNode,text:this.lp.category.all}).inject(this.categoryBar);this.allCategoryNode.addEvents({mouseover:function(){if(this.currentCategoryNode!=this.allCategoryNode)this.allCategoryNode.setStyles(this.css.categoryNode_over)}.bind(this),mouseout:function(){if(this.currentCategoryNode!=this.allCategoryNode)this.allCategoryNode.setStyles(this.css.categoryNode)}.bind(this),click:function(){if(this.currentCategoryNode)this.currentCategoryNode.setStyles(this.css.categoryNode);this.currentCategoryNode=this.allCategoryNode;this.allCategoryNode.setStyles(this.css.categoryNode_current);this.loadView()}.bind(this)});this.actions.getCategoryCountAll(function(e){e.data.each(function(e){var i=new Element("li.categoryNode",{styles:this.css.categoryNode,text:e.workTypeName+"("+e.centerCount+")"}).inject(this.categoryBar);i.store("workTypeName",e.workTypeName);i.addEvents({mouseover:function(){if(t.currentCategoryNode!=this.node)this.node.setStyles(t.css.categoryNode_over)}.bind({node:i}),mouseout:function(){if(t.currentCategoryNode!=this.node)this.node.setStyles(t.css.categoryNode)}.bind({node:i}),click:function(){if(t.currentCategoryNode)t.currentCategoryNode.setStyles(t.css.categoryNode);t.currentCategoryNode=this.node;this.node.setStyles(t.css.categoryNode_current);t.loadView()}.bind({name:e.workTypeName,node:i})})}.bind(this))}.bind(this),null,false);this.allCategoryNode.click()},loadToolbar:function(){this.toolbar=new Element("div.toolbar",{styles:this.css.toolbar}).inject(this.categoryBar);this.fileterNode=new Element("div.fileterNode",{styles:this.css.fileterNode}).inject(this.toolbar);this.loadFilter()},loadFilter:function(){var t=this;var e="<table bordr='0' cellpadding='5' cellspacing='0' styles='filterTable'>"+"<tr>"+"    <td styles='filterTableValue' item='title'></td>"+"    <td styles='filterTableValue' item='searchAction'></td>"+"    <td styles='filterTableValue' item='returnAction' style='display:none;'></td>"+"</tr>"+"</table>";this.fileterNode.set("html",e);MWF.xDesktop.requireApp("Template","MForm",function(){this.filter=new MForm(this.fileterNode,{},{style:"execution",isEdited:true,itemTemplate:{title:{style:this.css.filterTitle,defaultValue:this.lp.searchText,event:{focus:function(e){if(e.get("value")==t.lp.searchText)e.setValue("")},blur:function(e){if(e.get("value").trim()=="")e.setValue(t.lp.searchText)},keydown:function(e,i){if(i.code==13){t.fileterNode.getElements("[item='returnAction']").setStyle("display","");t.loadView()}}.bind(this)}},searchAction:{type:"button",value:this.lp.search,style:this.css.filterButton,event:{click:function(){t.fileterNode.getElements("[item='returnAction']").setStyle("display","");t.loadView()}}},returnAction:{type:"button",value:this.lp.return,style:this.css.filterButton,event:{click:function(){t.filter.getItem("title").setValue(t.lp.searchText);t.fileterNode.getElements("[item='returnAction']").setStyle("display","none");t.loadView()}}}}},this.app,this.css);this.filter.load()}.bind(this),true)},loadView:function(){var t={};if(this.currentCategoryNode){var e=this.currentCategoryNode.retrieve("workTypeName");if(e&&e!=""){t.defaultWorkTypes=[e]}}if(this.filter){var i=this.filter.getResult(true,",",true,true,true);i.title=i.title.replace(this.lp.searchText,"");for(var s in i){if(i[s]!=""){t[s]=i[s]}}}var n=false;if(this.viewContainer){n=true;this.viewContainer.destroy()}this.viewContainer=Element("div",{styles:this.css.viewContainer}).inject(this.contentDiv);this.setViewSize();if(!n){this.setViewSizeFun=this.setViewSize.bind(this);this.app.addEvent("resize",this.setViewSizeFun)}if(this.view){this.view.destroy()}this.getViewStyle();this.view=new MWF.xApplication.Execution.WorkStat.WorkView(this.viewContainer,this.app,this,{templateUrl:this.path+"listItem_stat.json",scrollEnable:true},{lp:this.lp.centerWorkView});if(t)this.view.filterData=t;this.view.load()},getViewStyle:function(){if(this.viewStyle)return this.viewStyle;this.actions.getProfileByCode({configCode:"MIND_LISTSTYLE"},function(t){if(t.data){this.viewStyle=t.data.configValue=="ICON"?"graph":"default"}else{this.viewStyle="default"}}.bind(this),function(){this.viewStyle="default"}.bind(this),false);return this.viewStyle||"default"},setViewSize:function(){var t=this.app.middleContent.getSize();var e=this.categoryBar?this.categoryBar.getSize():{x:0,y:0};this.viewContainer.setStyles({height:t.y-e.y-56+"px"})},statDepartment:function(){this.contentDiv.empty();this.deptToolbar=new Element("div.deptToolbar",{styles:this.css.deptToolbar}).inject(this.contentDiv);this.deptFileterNode=new Element("div.deptFileterNode",{styles:this.css.fileterNode}).inject(this.deptToolbar);this.loadDeptFilter()},loadDeptFilter:function(){var t=this;t.nowDate=new Date;t.day=new Date(t.nowDate.getFullYear(),t.nowDate.getMonth()+1,0);var e="<table bordr='0' cellpadding='5' cellspacing='0' styles='filterTable'>"+"<tr>"+"    <td styles='filterTableValue' item='beginDate'></td>"+"    <td styles='filterTableValue' item='endDate'></td>"+"    <td styles='filterTableValue' item='reportCycle'></td>"+"    <td styles='filterTableValue' item='searchAction'></td>"+"    <td styles='filterTableValue' item='returnAction' style='display:none;'></td>"+"</tr>"+"</table>";this.deptFileterNode.set("html",e);MWF.xDesktop.requireApp("Template","MForm",function(){this.deptFilter=new MForm(this.deptFileterNode,{},{style:"execution",isEdited:true,onPostLoad:function(){t.loadDeptStat()}.bind(this),itemTemplate:{beginDate:{style:this.css.filterTitle,tType:"date",name:"beginDate",readonly:true,notEmpty:true,defaultValue:t.nowDate.getFullYear()+"-"+(t.nowDate.getMonth()+1)+"-01",event:{focus:function(e){if(e.get("value")==t.lp.deptStat.beginDate)e.setValue("")},blur:function(e){if(e.get("value").trim()=="")e.setValue(t.lp.deptStat.beginDate)}}},endDate:{style:this.css.filterTitle,tType:"date",name:"endDate",readonly:true,notEmpty:true,defaultValue:t.nowDate.getFullYear()+"-"+(t.nowDate.getMonth()+1)+"-"+t.day.getDate(),event:{focus:function(e){if(e.get("value")==t.lp.deptStat.endDate)e.setValue("")},blur:function(e){if(e.get("value").trim()=="")e.setValue(t.lp.deptStat.endDate)}}},reportCycle:{text:this.lp.reportCycle+":",type:"radio",notEmpty:true,selectText:this.lp.reportCycleText.split(","),defaultValue:this.lp.reportCycleText.split(",")[0],event:{}},searchAction:{type:"button",value:this.lp.search,style:this.css.filterButton,event:{click:function(){t.loadDeptStat()}}},returnAction:{type:"button",value:this.lp.return,style:this.css.filterButton,event:{click:function(){t.deptFilter.getItem("beginDate").setValue(t.lp.deptStat.beginDate);t.deptFilter.getItem("endDate").setValue(t.lp.deptStat.endDate);t.deptFileterNode.getElements("[item='returnAction']").setStyle("display","none")}}}}},this.app,this.css);this.deptFilter.load()}.bind(this),true)},loadDeptStat:function(){if(this.deptStatContent){this.deptStatContent.set("text","loading...");this.deptStatContent.setStyles({"padding-left":"20px"})}this.bDate=this.deptFilter.getItem("beginDate").get("value");this.eDate=this.deptFilter.getItem("endDate").get("value");this.cycleType=this.deptFilter.getItem("reportCycle").get("value");if(this.bDate==""||this.bDate==this.lp.deptStat.beginDate||this.eDate==""||this.eDate==this.lp.deptStat.endDate){}var t={cycleType:this.cycleType,startDate:this.bDate,endDate:this.eDate};this.actions.getStatType(t,function(t){if(t.type=="success"){this.deptStatData=t.data;this.displayDeptStat();var e=this.contentDiv.getSize().y-this.deptToolbar.getSize().y;this.deptStatContent.setStyles({height:e-20+"px"})}}.bind(this),function(t,e,i){this.showErrorMessage(t,e,i)}.bind(this),true)},displayDeptStat:function(){if(this.deptStatContent)this.deptStatContent.destroy();this.deptStatContent=new Element("div.deptStatContent",{styles:this.css.deptStatContent}).inject(this.contentDiv);if(this.deptStatData){this.deptStatInfo=new Element("div.deptStatInfo",{styles:this.css.deptStatInfo}).inject(this.deptStatContent);var t="<span >已汇报:</span> <img src='"+this.path+"default/icon/Checkmark-24.png' style='vertical-align:middle;margin-right:20px; width:20px;' />";t+="<span>不需要汇报: </span><img src='"+this.path+"default/icon/Circle24.png' style='vertical-align:middle;margin-right:20px;width:20px;' />";t+="<span>未汇报:</span> <img src='"+this.path+"default/icon/Delete-24.png' style='vertical-align:middle;margin-right:20px;width:20px;' />";this.deptStatInfo.set("html",t);this.deptStatText=new Element("div.deptStatText",{styles:this.css.deptStatText}).inject(this.deptStatInfo);this.deptStatText.set("html","统计类别: "+this.cycleType+"  统计周期: "+this.bDate+" --- "+this.eDate);if(this.deptStatData.header)cols=this.deptStatData.header.length;this.deptStatTable=new Element("table.deptStatTable",{styles:this.css.deptStatTable}).inject(this.deptStatContent);this.deptStatHeadTr=new Element("tr.deptStatHeadTr",{styles:this.css.deptStatHeadTr}).inject(this.deptStatTable);this.deptStatData.header.each(function(t,e){this.tmpTd=new Element("td.deptStatTh",{styles:this.css.deptStatTh,text:t.title}).inject(this.deptStatHeadTr);if(e==0){this.tmpTd.setStyles({width:"100px"})}else if(e==1||e==2){this.tmpTd.setStyles({width:"300px",height:"auto","max-height":"50px","overflow-y":"hidden"})}else{var i=t.startDate;var s=t.endDate;tmpstr=i.split("-")[1]+"."+i.split("-")[2]+"-"+s.split("-")[1]+"."+s.split("-")[2];this.tmpTd.set("text",tmpstr)}}.bind(this));this.deptStatTable.setStyles({width:cols*50+680+"px"});if(this.deptStatData.content){var e=0;var i=this.deptStatData.content.length;this.deptStatData.content.each(function(t,i){if(t.array){var s=t.array.length;var n=t.rowCount;t.array.each(function(i,s){var a=i.array.length;var l=i.rowCount;if(i.array){var o=this;i.array.each(function(a,r){o.tmpTr=new Element("tr.deptStatTr",{styles:o.css.deptStatTr}).inject(o.deptStatTable);e++;if(r==0){if(s==0){o.tmpTd=new Element("td.deptStatTd",{styles:o.css.deptStatTd,rowspan:n,text:t.title}).inject(o.tmpTr);o.tmpTd.setStyles({"text-align":"center"});o.tmpTd=new Element("td.deptStatTd",{styles:o.css.deptStatTd,rowspan:l,text:i.title}).inject(o.tmpTr)}else{o.tmpTd=new Element("td.deptStatTd",{styles:o.css.deptStatTd,rowspan:l,text:i.title}).inject(o.tmpTr)}}o.tmpTd=new Element("td.deptStatTd",{styles:o.css.deptStatTd,text:a.title,col:1,row:e}).inject(o.tmpTr);o.tmpTd.setStyles({cursor:"pointer","text-decoration":"underline"});o.tmpTd.addEvents({click:function(){MWF.xDesktop.requireApp("Execution","WorkDetail",function(){var t=new MWF.xApplication.Execution.WorkDetail(o,o.app.restActions,{id:a.id},{isNew:false,isEdited:false,tabLocation:o.category});t.load()}.bind(o))}.bind(o),mouseenter:function(t){o.overStyles(t)}.bind(o),mouseleave:function(t){o.outStyles(t)}.bind(o)});if(a.fields){a.fields.each(function(t,i){o.tmpTd=new Element("td.deptStatTd",{styles:o.css.deptStatTdStatus,row:e,col:i+2}).inject(o.tmpTr);o.tmpTd.addEvents({mouseenter:function(t){o.overStyles(t)}.bind(o),mouseleave:function(t){o.outStyles(t)}.bind(o)});var s="";if(t.reportStatus==-1){s="Circle24.png"}else if(t.reportStatus==0){s="Delete-24.png"}else if(t.reportStatus==1){s="Checkmark-24.png"}o.deptStatStatusSpan=new Element("span.deptStatStatusSpan",{styles:this.css.deptStatStatusSpan}).inject(o.tmpTd);o.deptStatStatusSpan.setStyles({background:"url('"+o.path+"default/icon/"+s+"')"})}.bind(o))}}.bind(o))}}.bind(this))}}.bind(this))}}},overStyles:function(t){var e=$(t.target).get("row");var i=$(t.target).get("col")},outStyles:function(t){var e=$(t.target).get("row");var i=$(t.target).get("col")},statDate:function(){this.contentDiv.empty();this.dateToolbar=new Element("div.dateToolbar",{styles:this.css.dateToolbar}).inject(this.contentDiv);this.dateFileterNode=new Element("div.dateFileterNode",{styles:this.css.fileterNode}).inject(this.dateToolbar);this.loadDateFilter()},loadDateFilter:function(){var t=this;t.nowDate=new Date;t.day=new Date(t.nowDate.getFullYear(),t.nowDate.getMonth()+1,0);var e="<table bordr='0' cellpadding='5' cellspacing='0' styles='filterTable'>"+"<tr>"+"    <td styles='filterTableValue' item='beginDate'></td>"+"    <td styles='filterTableValue' item='endDate'></td>"+"    <td styles='filterTableValue' item='reportCycle'></td>"+"    <td styles='filterTableValue' item='searchAction'></td>"+"    <td styles='filterTableValue' item='returnAction' style='display:none;'></td>"+"    <td styles='filterTableValue' item='exportAction'></td>"+"</tr>"+"</table>";this.dateFileterNode.set("html",e);MWF.xDesktop.requireApp("Template","MForm",function(){this.dateFilter=new MForm(this.dateFileterNode,{},{style:"execution",isEdited:true,onPostLoad:function(){t.loadDateStat()}.bind(this),itemTemplate:{beginDate:{style:this.css.filterTitle,tType:"date",name:"beginDate",readonly:true,notEmpty:true,defaultValue:t.nowDate.getFullYear()+"-"+(t.nowDate.getMonth()+1)+"-01",event:{focus:function(e){if(e.get("value")==t.lp.dateStat.beginDate)e.setValue("")},blur:function(e){if(e.get("value").trim()=="")e.setValue(t.lp.dateStat.beginDate)}}},endDate:{style:this.css.filterTitle,tType:"date",name:"endDate",readonly:true,notEmpty:true,defaultValue:t.nowDate.getFullYear()+"-"+(t.nowDate.getMonth()+1)+"-"+t.day.getDate(),event:{focus:function(e){if(e.get("value")==t.lp.dateStat.endDate)e.setValue("")},blur:function(e){if(e.get("value").trim()=="")e.setValue(t.lp.dateStat.endDate)}}},reportCycle:{text:this.lp.reportCycle+":",type:"radio",notEmpty:true,selectText:this.lp.reportCycleText.split(","),defaultValue:this.lp.reportCycleText.split(",")[0],event:{}},searchAction:{type:"button",value:this.lp.search,style:this.css.filterButton,event:{click:function(){t.loadDateStat()}}},returnAction:{type:"button",value:this.lp.return,style:this.css.filterButton,event:{click:function(){t.dateFilter.getItem("beginDate").setValue(t.lp.dateStat.beginDate);t.dateFilter.getItem("endDate").setValue(t.lp.dateStat.endDate);t.dateFileterNode.getElements("[item='returnAction']").setStyle("display","none")}}},exportAction:{type:"button",value:this.lp.export,style:this.css.filterButton,event:{click:function(){t.exportDateExcel()}}}}},this.app,this.css);this.dateFilter.load()}.bind(this),true)},loadDateStat:function(){this.bDate=this.dateFilter.getItem("beginDate").get("value");this.eDate=this.dateFilter.getItem("endDate").get("value");this.cycleType=this.dateFilter.getItem("reportCycle").get("value");if(this.bDate==""||this.bDate==this.lp.dateStat.beginDate||this.eDate==""||this.eDate==this.lp.dateStat.endDate){}if(this.dateStatListDiv)this.dateStatListDiv.destroy();if(this.statViewListDiv)this.statViewListDiv.destroy();var t={reportCycle:this.cycleType,startDate:this.bDate,endDate:this.eDate};this.actions.getStatDateList(t,function(t){if(t.type=="success"){this.dateStatListData=t.data;this.displayDateStatList()}}.bind(this),function(t,e,i){this.showErrorMessage(t,e,i)}.bind(this),true)},displayDateStatList:function(){if(this.dateStatListDiv)this.dateStatListDiv.destroy();if(this.statViewListDiv)this.statViewListDiv.destroy();this.dateStatListDiv=new Element("div.dateStatListDiv",{styles:this.css.dateStatListDiv}).inject(this.contentDiv);var t=new Element("div.dateStatListTitleDiv",{styles:this.css.dateStatListTitleDiv,text:this.lp.dateStatListTitle}).inject(this.dateStatListDiv);this.dateStatContentDiv=new Element("div.dateStatContentDiv",{styles:this.css.dateStatContentDiv}).inject(this.dateStatListDiv);this.loadDateStatList()},loadDateStatList:function(){if(this.dateStatListData){this.dateStatListData.each(function(t,e){var i=new Element("li.dateStatContentLi",{styles:this.css.dateStatContentLi,text:t.datetime,title:t.reportCycle}).inject(this.dateStatContentDiv);i.addEvents({click:function(){this.dateStatContentDiv.getElements("li").setStyles({"background-color":"",color:""});i.setStyles({"background-color":"#3c76c1",color:"#ffffff"});this.currentDateData=t;this.displayDateStat(t)}.bind(this)})}.bind(this));if(this.dateStatContentDiv.getElements("li"))this.dateStatContentDiv.getElements("li")[0].click()}},displayDateStat:function(t,e){if(this.statViewListDiv){this.statViewListDiv.empty();this.statViewListDiv.set("text","loading...");this.statViewListDiv.setStyles({"padding-left":"15px"})}if(t){var i={statisticTimeFlag:t.datetime,reportCycle:t.reportCycle};if(e){i.centerId=e}this.actions.getStatDate(i,function(t){if(t.type=="success"){this.dateStatData=t.data;this.displayDateStatTable()}}.bind(this),function(t,e,i){this.showErrorMessage(t,e,i)}.bind(this),true)}},displayDateStatTable:function(){if(this.statViewListDiv)this.statViewListDiv.empty();if(this.dateStatData){if(this.statViewListDiv)this.statViewListDiv.destroy();this.statViewListDiv=new Element("div.statViewListDiv",{styles:this.css.statViewListDiv}).inject(this.contentDiv);var t=this.contentDiv.getSize().y-this.dateToolbar.getSize().y-this.dateStatListDiv.getSize().y;this.statViewListDiv.setStyles({height:t-50+"px"});this.statTable=new Element("table.statTable",{styles:this.css.statTable}).inject(this.statViewListDiv);this.statHeadTr=new Element("tr.statHeadTr",{styles:this.css.statHeadTr}).inject(this.statTable);for(var e in this.lp.statTable){var i=new Element("td.statHeadTd",{styles:this.css.statHeadTd,text:this.lp.statTable[e]}).inject(this.statHeadTr)}this.dateStatData.each(function(t,e){var i=new Element("tr.centerTr").inject(this.statTable);var s=new Element("td.dateStatCenterTd",{styles:this.css.dateStatCenterTd,colspan:9,text:t.title}).inject(i);if(t.contents&&t.contents.length>0){t.contents.each(function(t,e){var i=new Element("tr.baseTr").inject(this.statTable);for(var s in this.lp.statTable){var n="";if(s=="opinions"){if(t[s]){t[s].each(function(t){n=n+t.processorName+"：\n"+t.opinion+"\n"})}}else{if(t[s])n=t[s]}var a=new Element("td.dateStatBaseTd",{styles:this.css.dateStatBaseTd,html:n.length>50?n.substring(0,50)+"...":n,title:n}).inject(i);if(s=="serialNumber"){a.setStyles({width:"35px","padding-left":"15px","min-width":""})}if(s=="responsibilityOrganizationName"){a.setStyles({width:"87px"})}if(s=="workDetail"){}}}.bind(this))}}.bind(this))}},exportDateExcel:function(){if(this.currentDateData){var t={};t.statisticTimeFlag=this.currentDateData.datetime;t.reportCycle=this.currentDateData.reportCycle;this.actions.exportByCenterWork(t,function(t){if(t.data&&t.data.id){var e=this.actions.action.address;var i=e+"/servlet/export/statisticreportcontent/"+t.data.id+"/stream";window.open(i)}}.bind(this),function(t,e,i){this.showErrorMsg(t,e,i)}.bind(this),false)}},showErrorMessage:function(t,e,i){var s=i;if(t)errorMessage=t.responseText;if(errorMessage!=""){var n=JSON.parse(errorMessage);if(n.message){this.app.notice(n.message,"error")}else{this.app.notice(s,"error")}}else{this.app.notice(s,"error")}},setScrollBar:function(t,e,i,s){if(!e)e="attachment";if(!i){i={V:{x:0,y:0},H:{x:0,y:0}}}MWF.require("MWF.widget.ScrollBar",function(){new MWF.widget.ScrollBar(t,{style:e,offset:i,indent:false});if(s)s()});return false}});MWF.xApplication.Execution.WorkStat.WorkView=new Class({Extends:MWF.xApplication.Template.Explorer.ComplexView,_createDocument:function(t){return new MWF.xApplication.Execution.WorkStat.WorkDocument(this.viewNode,t,this.explorer,this)},_getCurrentPageData:function(t,e){if(!e)e=20;var i=this.items.length?this.items[this.items.length-1].data.id:"(0)";var s=this.filterData||{};this.actions.getCenterWorkListNext(i,e,s,function(e){if(t)t(e)}.bind(this))},_removeDocument:function(t,e){},_create:function(){},_openDocument:function(t){MWF.xDesktop.requireApp("Execution","StatForm",function(){var e=new MWF.xApplication.Execution.StatForm(this,this.app.restActions,t,{centerWorkId:t.id});e.load()}.bind(this),false)},_queryCreateViewNode:function(){},_postCreateViewNode:function(t){},_queryCreateViewHead:function(){},_postCreateViewHead:function(t){}});MWF.xApplication.Execution.WorkStat.WorkDocument=new Class({Extends:MWF.xApplication.Template.Explorer.ComplexDocument,mouseoverDocument:function(){this.node.getElements("[styles='documentItemTitleNode']").setStyles(this.css["documentItemTitleNode_over"]);this.node.getElements("[styles='documentItemIconNode']").setStyles(this.css["documentItemIconNode_over"]);this.node.getElements("[styles='documentItemStatNode']").setStyles(this.css["documentItemStatNode_over"])},mouseoutDocument:function(){this.node.getElements("[styles='documentItemTitleNode']").setStyles(this.css["documentItemTitleNode"]);this.node.getElements("[styles='documentItemIconNode']").setStyles(this.css["documentItemIconNode"]);this.node.getElements("[styles='documentItemStatNode']").setStyles(this.css["documentItemStatNode"])},_queryCreateDocumentNode:function(t){},_postCreateDocumentNode:function(t,e){},removeCenterWork:function(t){return false}});