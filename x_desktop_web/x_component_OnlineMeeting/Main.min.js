MWF.xDesktop.requireApp("OnlineMeeting","Actions.RestActions",null,false);MWF.xApplication.OnlineMeeting.options.multitask=false;MWF.xApplication.OnlineMeeting.Main=new Class({Extends:MWF.xApplication.Common.Main,Implements:[Options,Events],options:{style:"default",name:"OnlineMeeting",icon:"icon.png",width:"500",height:"600",isResize:true,isMax:true,title:MWF.xApplication.OnlineMeeting.LP.title},onQueryLoad:function(){this.lp=MWF.xApplication.OnlineMeeting.LP;this.actions=new MWF.xApplication.OnlineMeeting.Actions.RestActions},getLogin:function(t,i){if(i)i()},loginOpenMeeting:function(t,i,n){var e=this.actions.getLoginUri(t);var s=new Element("iframe",{src:e,styles:{display:"none"}}).inject(this.content);window.setTimeout(function(){if(i)i()}.bind(this),3e3)},loadApplication:function(t){this.actions.getOpenMeeting(function(t){this.meetingLoginData=t.data;this.getLogin(function(){this.loadMeetingRoom()}.bind(this),function(){if(this.meetingLoginData){this.loginOpenMeeting(this.meetingLoginData,function(){this.loadMeetingRoom()}.bind(this))}}.bind(this))}.bind(this))},loadMeetingRoom:function(){this.titleNode=new Element("div",{styles:this.css.titleNode}).inject(this.content);this.titleNode.set("text",this.lp.netMeetingRoom);this.contentNode=new Element("div",{styles:this.css.contentNode}).inject(this.content);this.setContentSize();this.addEvent("resize",this.setContentSize.bind(this));this.loadCountent()},setContentSize:function(){var t=this.content.getSize();var i=this.titleNode.getSize();var n=t.y-i.y;this.contentNode.setStyle("height",""+n+"px")},loadCountent:function(){this.actions.listRoom(function(t){t.data.each(function(t){t.url=this.actions.getRoomUri(t);new MWF.xApplication.OnlineMeeting.room(this,t)}.bind(this))}.bind(this))}});MWF.xApplication.OnlineMeeting.room=new Class({initialize:function(t,i){this.data=i;this.app=t;this.css=this.app.css;this.container=this.app.contentNode;this.lp=this.app.lp;this.load()},load:function(){this.node=new Element("div",{styles:this.css.roomNode}).inject(this.container);this.iconNode=new Element("div",{styles:this.css.roomIconNode}).inject(this.node);this.textNode=new Element("div",{styles:this.css.roomTextNode}).inject(this.node);this.textNode.set("text",this.data.name);this.node.addEvent("click",function(t){var i=this;var n={url:this.data.url};this.app.desktop.openApplication(t,"OnlineMeetingRoom",n)}.bind(this))}});