MWF.xApplication.cms.ApplicationManager=MWF.xApplication.cms.ApplicationManager||{};MWF.xApplication.cms.ApplicationManager.Actions=MWF.xApplication.cms.ApplicationManager.Actions||{};MWF.xDesktop.requireApp("cms.ApplicationManager","package",null,false);MWF.require("MWF.xDesktop.Actions.RestActions",null,false);MWF.require("MWF.widget.UUID",null,false);MWF.xApplication.cms.ApplicationManager.Actions.RestActions=new Class({initialize:function(){this.action=new MWF.xDesktop.Actions.RestActions("/Actions/action.json","x_cms_assemble_control","x_component_cms_ApplicationManager")},getId:function(i,e,a,t){this.action.invoke({name:"getId",async:t,parameter:{count:i},success:e,failure:a})},getUUID:function(i){var e="";this.action.invoke({name:"getId",async:false,parameter:{count:"1"},success:function(a){e=a.data[0];if(i)i(e)},failure:null});return e},listColumn:function(i,e,a){this.action.invoke({name:"listColumn",async:a,success:i,failure:e})},getColumn:function(i,e,a){this.action.invoke({name:"getColumn",parameter:{id:i.id},success:e,failure:a})},saveColumn:function(i,e,a){if(!i.isNewColumn){this.updateColumn(i,e,a)}else{this.addColumn(i,e,a)}},addColumn:function(i,e,a){this.action.invoke({name:"addColumn",data:i,success:e,failure:a})},updateColumn:function(i,e,a){this.action.invoke({name:"updateColumn",data:i,parameter:{id:i.id},success:e,failure:a})},removeColumn:function(i,e,a,t){this.action.invoke({name:"removeColumn",async:t,parameter:{id:i},success:e,failure:a})},getColumnIcon:function(i,e,a){this.action.invoke({name:"getColumnIcon",parameter:{id:i},success:e,failure:a})},updataColumnIcon:function(i,e,a,t,n){this.action.invoke({name:"updataColumnIcon",parameter:{id:i},data:t,file:n,success:e,failure:a})},listAllCategory:function(i,e,a){this.action.invoke({name:"listAllCategory",async:a,success:i,failure:e})},listCategory:function(i,e,a,t){var n=this;this.action.invoke({name:"listCategory",parameter:{appId:i},async:t,success:function(i){n.transCategoryData(i);e.call(this,i)},failure:a})},getCategory:function(i,e,a){var t=this;this.action.invoke({name:"getCategory",parameter:{id:i},success:function(i){t.transCategoryData(i);e.call(this,i)},failure:a})},saveCategory:function(i,e,a){if(!i.isNew){this.updateCategory(i,e,a)}else{this.addCategory(i,e,a)}},addCategory:function(i,e,a){this.action.invoke({name:"addCategory",data:i,success:e,failure:a})},updateCategory:function(i,e,a){this.action.invoke({name:"updateCategory",data:i,parameter:{id:i.id},success:e,failure:a})},removeCategory:function(i,e,a,t){this.action.invoke({name:"removeCategory",async:t,parameter:{id:i},success:e,failure:a})},transCategoryData:function(i){var e=function(i){if(!i.name)i.name=i.catagoryName;if(!i.alias)i.alias=i.catagoryAlias;if(!i.catagoryName)i.catagoryName=i.name;if(!i.catagoryAlias)i.catagoryAlias=i.alias};if(i.data){if(typeOf(i.data)=="array"){i.data.each(function(i){e(i)})}else{e(i.data)}}else{i.data=[]}},listAllForm:function(i,e,a){this.action.invoke({name:"listAllForm",async:a,success:i,failure:e})},listForm:function(i,e,a,t){this.action.invoke({name:"listForm",async:t,parameter:{appId:i},success:e,failure:a})},getForm:function(i,e,a,t){this.action.invoke({name:"getForm",async:t,parameter:{id:i},success:e,failure:a})},saveForm:function(i,e,a,t){if(!i.isNewForm){this.updateForm(i,e,a,t)}else{this.addForm(i,e,a,t)}},updateForm:function(i,e,a,t){var n,e;if(i)n=MWF.encodeJsonString(JSON.encode(i));if(e)e=MWF.encodeJsonString(JSON.encode(e));var s={id:i.json.id,name:i.json.name,alias:i.json.name,description:i.json.description,appId:i.json.application};if(i)s.data=n;if(e)s.mobileData=e;this.action.invoke({name:"updataForm",data:s,parameter:{id:i.json.id},success:a,failure:t})},addForm:function(i,e,a,t){var n,e;if(!i.json.id){this.getUUID(function(s){i.json.id=s;if(i)n=MWF.encodeJsonString(JSON.encode(i));if(e)e=MWF.encodeJsonString(JSON.encode(e));var o={id:i.json.id,name:i.json.name,alias:i.json.name,description:i.json.description,appId:i.json.application};if(i)o.data=n;if(e)o.mobileData=e;this.action.invoke({name:"addForm",data:o,parameter:{id:i.json.id},success:a,failure:t})}.bind(this))}else{if(i)n=MWF.encodeJsonString(JSON.encode(i));if(e)e=MWF.encodeJsonString(JSON.encode(e));var s={id:i.json.id,name:i.json.name,alias:i.json.name,description:i.json.description,appId:i.json.application};if(i)s.data=n;if(e)s.mobileData=e;this.action.invoke({name:"addForm",data:s,parameter:{id:i.json.categoryId},success:a,failure:t})}},deleteForm:function(i,e,a,t){this.action.invoke({name:"removeForm",async:t,parameter:{id:i},success:e,failure:a})},listDictionary:function(i,e,a,t){this.action.invoke({name:"listDictionary",async:t,parameter:{appId:i},success:e,failure:a})},getDictionary:function(i,e,a,t){this.action.invoke({name:"getDictionary",async:t,parameter:{appDictId:i},success:e,failure:a})},saveDictionary:function(i,e,a){if(i.id||i.appDictId){this.updateDictionary(i,e,a)}else{this.addDictionary(i,e,a)}},updateDictionary:function(i,e,a){if(!i.alias||i.alias=="")i.alias=i.name;this.action.invoke({name:"updataDictionary",data:i,parameter:{appDictId:i.id},success:e,failure:a})},addDictionary:function(i,e,a){if(!i.id){this.getUUID(function(t){i.id=t;i.appDictId=t;if(!i.alias||i.alias=="")i.alias=i.name;this.action.invoke({name:"addDictionary",data:i,parameter:{appDictId:i.id},success:e,failure:a})}.bind(this))}},deleteDictionary:function(i,e,a,t){this.action.invoke({name:"removeDictionary",async:t,parameter:{appDictId:i},success:e,failure:a})},listScript:function(i,e,a,t){var n=this;this.action.invoke({name:"listScript",async:t,parameter:{appId:i},success:e,failure:a})},getScript:function(i,e,a,t){var n=this;this.action.invoke({name:"getScript",async:t,parameter:{id:i},success:function(i){n.transScriptData(i);e.call(this,i)},failure:a})},getScriptByName:function(i,e,a,t,n){var s=this;this.action.invoke({name:"getScriptByName",async:n,parameter:{name:i,appId:e},success:function(i){s.transScriptData(i);a.call(this,i)},failure:t})},saveScript:function(i,e,a){if(!i.isNewScript){this.updateScript(i,e,a)}else{this.addScript(i,e,a)}},updateScript:function(i,e,a){this.transScriptData(i,"send");this.action.invoke({name:"updataScript",data:i,parameter:{id:i.id},success:e,failure:a})},addScript:function(i,e,a){this.transScriptData(i,"send");var t=this;if(!i.id){this.getUUID(function(t){i.id=t;this.action.invoke({name:"addScript",data:i,success:e,failure:a})}.bind(this))}else{this.action.invoke({name:"addScript",data:i,success:e,failure:a})}},deleteScript:function(i,e,a,t){this.action.invoke({name:"removeScript",async:t,parameter:{id:i},success:e,failure:a})},transScriptData:function(i,e){var a=function(i){if(e&&e=="send"){if(!i.appId)i.appId=i.application;if(!i.appName)i.appName=i.applicationName;if(i.application)delete i.application;if(i.applicationName)delete i.applicationName}else{if(!i.appId)i.appId=i.application;if(!i.appName)i.appName=i.applicationName;if(!i.application)i.application=i.appId;if(!i.applicationName)i.application=i.appName}};if(typeOf(i)=="array"){i.each(function(i){a(i)})}else{a(i)}},listController:function(i,e,a,t,n){this.action.invoke({name:"listController",async:n,parameter:{person:i,objectType:e},success:a,failure:t})},listAllController:function(i,e,a){this.action.invoke({name:"listAllController",async:a,success:i,failure:e})},listCategoryController:function(i,e,a,t){this.action.invoke({name:"listCategoryController",async:t,parameter:{catagoryId:i},success:e,failure:a})},listColumnController:function(i,e,a,t){this.action.invoke({name:"listColumnController",async:t,parameter:{appId:i},success:e,failure:a})},listControllerByPerson:function(i,e,a,t){this.action.invoke({name:"listControllerByPerson",async:t,parameter:{person:i},success:e,failure:a})},getController:function(i,e,a,t){this.action.invoke({name:"getController",async:t,parameter:{appDictId:appDictId},success:e,failure:a})},saveController:function(i,e,a,t){if(i.id){this.updateController(i,e,a,t)}else{this.addController(i,e,a,t)}},updateController:function(i,e,a,t){this.action.invoke({name:"updateController",async:t,data:i,parameter:{id:i.id},success:e,failure:a})},addController:function(i,e,a,t){if(!i.id){this.getUUID(function(n){i.id=n;this.action.invoke({name:"addController",async:t,data:i,parameter:{id:i.id},success:e,failure:a})}.bind(this))}},removeController:function(i,e,a,t){this.action.invoke({name:"removeController",async:t,parameter:{id:i},success:e,failure:a})},listPermission:function(i,e,a,t,n){this.action.invoke({name:"listPermission",async:n,parameter:{person:i,objectType:e},success:a,failure:t})},listAllPermission:function(i,e,a){this.action.invoke({name:"listAllPermission",async:a,success:i,failure:e})},listColumnPermission:function(i,e,a,t){this.action.invoke({name:"listColumnPermission",async:t,parameter:{appId:i},success:e,failure:a})},listPermissionByPerson:function(i,e,a,t){this.action.invoke({name:"listPermissionByPerson",async:t,parameter:{person:i},success:e,failure:a})},getPermission:function(i,e,a,t){this.action.invoke({name:"getPermission",async:t,parameter:{appDictId:appDictId},success:e,failure:a})},savePermission:function(i,e,a,t){if(i.id){this.updatePermission(i,e,a,t)}else{this.addPermission(i,e,a,t)}},updatePermission:function(i,e,a,t){this.action.invoke({name:"updatePermission",data:i,parameter:{id:i.id},async:t,success:e,failure:a})},addPermission:function(i,e,a,t){if(!i.id){this.getUUID(function(n){i.id=n;this.action.invoke({name:"addPermission",data:i,parameter:{id:i.id},async:t,success:e,failure:a})}.bind(this))}},removePermission:function(i,e,a,t){this.action.invoke({name:"removePermission",async:t,parameter:{id:i},success:e,failure:a})},listView:function(i,e,a,t){this.action.invoke({name:"listView",async:t,parameter:{appId:i},success:e,failure:a})},listViewByCategory:function(i,e,a,t){this.action.invoke({name:"listViewByCategory",async:t,parameter:{catagoryId:i},success:e,failure:a})},listViewByForm:function(i,e,a,t){this.action.invoke({name:"listViewByForm",async:t,parameter:{formId:i},success:e,failure:a})},getView:function(i,e,a){this.action.invoke({name:"getView",parameter:{id:i},success:e,failure:a})},saveView:function(i,e,a){if(!i.isNew){this.updateView(i,e,a)}else{this.addView(i,e,a)}},addView:function(i,e,a){this.action.invoke({name:"addView",data:i,success:e,failure:a})},updateView:function(i,e,a){this.action.invoke({name:"updateView",data:i,parameter:{id:i.id},success:e,failure:a})},deleteView:function(i,e,a,t){this.action.invoke({name:"deleteView",async:t,parameter:{id:i},success:e,failure:a})},listViewColumn:function(i,e,a,t){this.action.invoke({name:"listViewColumn",async:t,parameter:{viewId:i},success:e,failure:a})},getViewColumn:function(i,e,a){this.action.invoke({name:"getViewColumn",parameter:{id:i},success:e,failure:a})},saveViewColumn:function(i,e,a,t){if(!i.isNew){this.updateViewColumn(i,e,a,t)}else{this.addViewColumn(i,e,a,t)}},addViewColumn:function(i,e,a,t){this.action.invoke({name:"addViewColumn",async:t,data:i,success:e,failure:a})},updateViewColumn:function(i,e,a,t){this.action.invoke({name:"updateViewColumn",async:t,data:i,parameter:{id:i.id},success:e,failure:a})},deleteViewColumn:function(i,e,a,t){this.action.invoke({name:"deleteViewColumn",async:t,parameter:{id:i},success:e,failure:a})},listCategoryViewByView:function(i,e,a,t){this.action.invoke({name:"listCategoryViewByView",async:t,parameter:{viewId:i},success:e,failure:a})},listCategoryViewByCatagory:function(i,e,a,t){this.action.invoke({name:"listCategoryViewByCatagory",async:t,parameter:{catagoryId:i},success:e,failure:a})},getCategoryView:function(i,e,a){this.action.invoke({name:"getCategoryView",parameter:{id:i},success:e,failure:a})},saveCategoryView:function(i,e,a,t){if(!i.isNew){this.updateViewColumn(i,e,a,t)}else{this.addViewColumn(i,e,a,t)}},addCategoryView:function(i,e,a,t){this.action.invoke({name:"addCategoryView",async:t,data:i,success:e,failure:a})},updateCategoryView:function(i,e,a,t){this.action.invoke({name:"updateCategoryView",async:t,data:i,parameter:{id:i.id},success:e,failure:a})},deleteCategoryView:function(i,e,a,t){this.action.invoke({name:"deleteCategoryView",async:t,parameter:{id:i},success:e,failure:a})},listQueryView:function(i,e,a,t){this.action.invoke({name:"listQueryView",async:t,parameter:{applicationId:i},success:e,failure:a})},listQueryViewNextPage:function(i,e,a,t,n){this.action.invoke({name:"listQueryViewNextPage",async:n,parameter:{id:i,count:e},success:a,failure:t})},listQueryViewPrevPage:function(i,e,a,t,n){this.action.invoke({name:"listQueryViewPrevPage",async:n,parameter:{id:i,count:e},success:a,failure:t})},getQueryView:function(i,e,a){this.action.invoke({name:"getQueryView",parameter:{id:i},success:e,failure:a})},saveQueryView:function(i,e,a,t){if(i.isNewView){i.isNewView=false;this.addQueryView(i,e,a,t)}else{this.updateQueryView(i,e,a,t)}},addQueryView:function(i,e,a,t){var n=i.data;var s=JSON.encode(i.data);i.data=s;if(!n.id){this.getUUID(function(s){i.id=s;this.action.invoke({name:"addQueryView",data:i,success:e,failure:a,async:t});i.data=n}.bind(this))}else{this.action.invoke({name:"addQueryView",data:i,success:e,failure:a,async:t});i.data=n}},updateQueryView:function(i,e,a,t){var n=i.data;var s=JSON.encode(i.data);i.data=s;this.action.invoke({name:"updateQueryView",data:i,async:t,parameter:{id:i.id},success:e,failure:a});i.data=n},deleteQueryView:function(i,e,a,t){this.action.invoke({name:"deleteQueryView",async:t,parameter:{id:i},success:e,failure:a})},getQueryViewContent:function(i,e,a,t){this.action.invoke({name:"getQueryViewContent",async:t,parameter:{flag:i},success:e,failure:a})},loadQueryView:function(i,e,a,t){this.action.invoke({name:"loadQueryView",async:t,data:{},parameter:{flag:i},success:e,failure:a})}});