(function(e){if(typeof exports=="object"&&typeof module=="object")e(require("../../lib/codemirror"),require("../htmlmixed/htmlmixed"));else if(typeof define=="function"&&define.amd)define(["../../lib/codemirror","../htmlmixed/htmlmixed"],e);else e(CodeMirror)})(function(e){"use strict";e.defineMode("htmlembedded",function(t,n){var i=n.scriptStartRegex||/^<%/i,r=n.scriptEndRegex||/^%>/i;var o,a;function d(e,t){if(e.match(i,false)){t.token=c;return o.token(e,t.scriptState)}else return a.token(e,t.htmlState)}function c(e,t){if(e.match(r,false)){t.token=d;return a.token(e,t.htmlState)}else return o.token(e,t.scriptState)}return{startState:function(){o=o||e.getMode(t,n.scriptingModeSpec);a=a||e.getMode(t,"htmlmixed");return{token:n.startOpen?c:d,htmlState:e.startState(a),scriptState:e.startState(o)}},token:function(e,t){return t.token(e,t)},indent:function(e,t){if(e.token==d)return a.indent(e.htmlState,t);else if(o.indent)return o.indent(e.scriptState,t)},copyState:function(t){return{token:t.token,htmlState:e.copyState(a,t.htmlState),scriptState:e.copyState(o,t.scriptState)}},innerMode:function(e){if(e.token==c)return{state:e.scriptState,mode:o};else return{state:e.htmlState,mode:a}}}},"htmlmixed");e.defineMIME("application/x-ejs",{name:"htmlembedded",scriptingModeSpec:"javascript"});e.defineMIME("application/x-aspx",{name:"htmlembedded",scriptingModeSpec:"text/x-csharp"});e.defineMIME("application/x-jsp",{name:"htmlembedded",scriptingModeSpec:"text/x-java"});e.defineMIME("application/x-erb",{name:"htmlembedded",scriptingModeSpec:"ruby"})});