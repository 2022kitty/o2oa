(function(e){if(typeof exports=="object"&&typeof module=="object")e(require("../../lib/codemirror"));else if(typeof define=="function"&&define.amd)define(["../../lib/codemirror"],e);else e(CodeMirror)})(function(e){"use strict";e.defineMode("coffeescript",function(e){var t="error";function r(e){return new RegExp("^(("+e.join(")|(")+"))\\b")}var n=/^(?:->|=>|\+[+=]?|-[\-=]?|\*[\*=]?|\/[\/=]?|[=!]=|<[><]?=?|>>?=?|%=?|&=?|\|=?|\^=?|\~|!|\?|(or|and|\|\||&&|\?)=)/;var i=/^(?:[()\[\]{},:`=;]|\.\.?\.?)/;var f=/^[_A-Za-z$][_A-Za-z$0-9]*/;var o=/^(@|this\.)[_A-Za-z$][_A-Za-z$0-9]*/;var a=r(["and","or","not","is","isnt","in","instanceof","typeof"]);var c=["for","while","loop","if","unless","else","switch","try","catch","finally","class"];var s=["break","by","continue","debugger","delete","do","in","of","new","return","then","this","@","throw","when","until","extends"];var l=r(c.concat(s));c=r(c);var u=/^('{3}|\"{3}|['\"])/;var p=/^(\/{3}|\/)/;var d=["Infinity","NaN","undefined","null","true","false","on","off","yes","no"];var v=r(d);function m(e,r){if(e.sol()){if(r.scope.align===null)r.scope.align=false;var c=r.scope.offset;if(e.eatSpace()){var s=e.indentation();if(s>c&&r.scope.type=="coffee"){return"indent"}else if(s<c){return"dedent"}return null}else{if(c>0){b(e,r)}}}if(e.eatSpace()){return null}var d=e.peek();if(e.match("####")){e.skipToEnd();return"comment"}if(e.match("###")){r.tokenize=k;return r.tokenize(e,r)}if(d==="#"){e.skipToEnd();return"comment"}if(e.match(/^-?[0-9\.]/,false)){var m=false;if(e.match(/^-?\d*\.\d+(e[\+\-]?\d+)?/i)){m=true}if(e.match(/^-?\d+\.\d*/)){m=true}if(e.match(/^-?\.\d+/)){m=true}if(m){if(e.peek()=="."){e.backUp(1)}return"number"}var y=false;if(e.match(/^-?0x[0-9a-f]+/i)){y=true}if(e.match(/^-?[1-9]\d*(e[\+\-]?\d+)?/)){y=true}if(e.match(/^-?0(?![\dx])/i)){y=true}if(y){return"number"}}if(e.match(u)){r.tokenize=h(e.current(),false,"string");return r.tokenize(e,r)}if(e.match(p)){if(e.current()!="/"||e.match(/^.*\//,false)){r.tokenize=h(e.current(),true,"string-2");return r.tokenize(e,r)}else{e.backUp(1)}}if(e.match(n)||e.match(a)){return"operator"}if(e.match(i)){return"punctuation"}if(e.match(v)){return"atom"}if(e.match(l)){return"keyword"}if(e.match(f)){return"variable"}if(e.match(o)){return"property"}e.next();return t}function h(r,n,i){return function(f,o){while(!f.eol()){f.eatWhile(/[^'"\/\\]/);if(f.eat("\\")){f.next();if(n&&f.eol()){return i}}else if(f.match(r)){o.tokenize=m;return i}else{f.eat(/['"\/]/)}}if(n){if(e.mode.singleLineStringErrors){i=t}else{o.tokenize=m}}return i}}function k(e,t){while(!e.eol()){e.eatWhile(/[^#]/);if(e.match("###")){t.tokenize=m;break}e.eatWhile("#")}return"comment"}function y(t,r,n){n=n||"coffee";var i=0,f=false,o=null;for(var a=r.scope;a;a=a.prev){if(a.type==="coffee"||a.type=="}"){i=a.offset+e.indentUnit;break}}if(n!=="coffee"){f=null;o=t.column()+t.current().length}else if(r.scope.align){r.scope.align=false}r.scope={offset:i,type:n,prev:r.scope,align:f,alignOffset:o}}function b(e,t){if(!t.scope.prev)return;if(t.scope.type==="coffee"){var r=e.indentation();var n=false;for(var i=t.scope;i;i=i.prev){if(r===i.offset){n=true;break}}if(!n){return true}while(t.scope.prev&&t.scope.offset!==r){t.scope=t.scope.prev}return false}else{t.scope=t.scope.prev;return false}}function g(e,r){var n=r.tokenize(e,r);var i=e.current();if(i==="."){n=r.tokenize(e,r);i=e.current();if(/^\.[\w$]+$/.test(i)){return"variable"}else{return t}}if(i==="return"){r.dedent=true}if((i==="->"||i==="=>")&&!r.lambda&&!e.peek()||n==="indent"){y(e,r)}var f="[({".indexOf(i);if(f!==-1){y(e,r,"])}".slice(f,f+1))}if(c.exec(i)){y(e,r)}if(i=="then"){b(e,r)}if(n==="dedent"){if(b(e,r)){return t}}f="])}".indexOf(i);if(f!==-1){while(r.scope.type=="coffee"&&r.scope.prev)r.scope=r.scope.prev;if(r.scope.type==i)r.scope=r.scope.prev}if(r.dedent&&e.eol()){if(r.scope.type=="coffee"&&r.scope.prev)r.scope=r.scope.prev;r.dedent=false}return n}var z={startState:function(e){return{tokenize:m,scope:{offset:e||0,type:"coffee",prev:null,align:false},lastToken:null,lambda:false,dedent:0}},token:function(e,t){var r=t.scope.align===null&&t.scope;if(r&&e.sol())r.align=false;var n=g(e,t);if(r&&n&&n!="comment")r.align=true;t.lastToken={style:n,content:e.current()};if(e.eol()&&e.lambda){t.lambda=false}return n},indent:function(e,t){if(e.tokenize!=m)return 0;var r=e.scope;var n=t&&"])}".indexOf(t.charAt(0))>-1;if(n)while(r.type=="coffee"&&r.prev)r=r.prev;var i=n&&r.type===t.charAt(0);if(r.align)return r.alignOffset-(i?1:0);else return(i?r.prev:r).offset},lineComment:"#",fold:"indent"};return z});e.defineMIME("text/x-coffeescript","coffeescript")});