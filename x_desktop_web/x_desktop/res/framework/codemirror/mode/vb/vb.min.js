(function(e){if(typeof exports=="object"&&typeof module=="object")e(require("../../lib/codemirror"));else if(typeof define=="function"&&define.amd)define(["../../lib/codemirror"],e);else e(CodeMirror)})(function(e){"use strict";e.defineMode("vb",function(e,r){var n="error";function t(e){return new RegExp("^(("+e.join(")|(")+"))\\b","i")}var i=new RegExp("^[\\+\\-\\*/%&\\\\|\\^~<>!]");var a=new RegExp("^[\\(\\)\\[\\]\\{\\}@,:`=;\\.]");var u=new RegExp("^((==)|(<>)|(<=)|(>=)|(<>)|(<<)|(>>)|(//)|(\\*\\*))");var o=new RegExp("^((\\+=)|(\\-=)|(\\*=)|(%=)|(/=)|(&=)|(\\|=)|(\\^=))");var f=new RegExp("^((//=)|(>>=)|(<<=)|(\\*\\*=))");var c=new RegExp("^[_A-Za-z][_A-Za-z0-9]*");var l=["class","module","sub","enum","select","while","if","function","get","set","property","try"];var d=["else","elseif","case","catch"];var s=["next","loop"];var v=t(["and","or","not","xor","in"]);var m=["as","dim","break","continue","optional","then","until","goto","byval","byref","new","handles","property","return","const","private","protected","friend","public","shared","static","true","false"];var h=["integer","string","double","decimal","boolean","short","char","float","single"];var p=t(m);var b=t(h);var k='"';var x=t(l);var g=t(d);var w=t(s);var y=t(["end"]);var I=t(["do"]);var E=null;function L(e,r){r.currentIndent++}function z(e,r){r.currentIndent--}function C(e,r){if(e.eatSpace()){return null}var t=e.peek();if(t==="'"){e.skipToEnd();return"comment"}if(e.match(/^((&H)|(&O))?[0-9\.a-f]/i,false)){var l=false;if(e.match(/^\d*\.\d+F?/i)){l=true}else if(e.match(/^\d+\.\d*F?/)){l=true}else if(e.match(/^\.\d+F?/)){l=true}if(l){e.eat(/J/i);return"number"}var d=false;if(e.match(/^&H[0-9a-f]+/i)){d=true}else if(e.match(/^&O[0-7]+/i)){d=true}else if(e.match(/^[1-9]\d*F?/)){e.eat(/J/i);d=true}else if(e.match(/^0(?![\dx])/i)){d=true}if(d){e.eat(/L/i);return"number"}}if(e.match(k)){r.tokenize=R(e.current());return r.tokenize(e,r)}if(e.match(f)||e.match(o)){return null}if(e.match(u)||e.match(i)||e.match(v)){return"operator"}if(e.match(a)){return null}if(e.match(I)){L(e,r);r.doInCurrentLine=true;return"keyword"}if(e.match(x)){if(!r.doInCurrentLine)L(e,r);else r.doInCurrentLine=false;return"keyword"}if(e.match(g)){return"keyword"}if(e.match(y)){z(e,r);z(e,r);return"keyword"}if(e.match(w)){z(e,r);return"keyword"}if(e.match(b)){return"keyword"}if(e.match(p)){return"keyword"}if(e.match(c)){return"variable"}e.next();return n}function R(e){var t=e.length==1;var i="string";return function(a,u){while(!a.eol()){a.eatWhile(/[^'"]/);if(a.match(e)){u.tokenize=C;return i}else{a.eat(/['"]/)}}if(t){if(r.singleLineStringErrors){return n}else{u.tokenize=C}}return i}}function F(e,r){var t=r.tokenize(e,r);var i=e.current();if(i==="."){t=r.tokenize(e,r);i=e.current();if(t==="variable"){return"variable"}else{return n}}var a="[({".indexOf(i);if(a!==-1){L(e,r)}if(E==="dedent"){if(z(e,r)){return n}}a="])}".indexOf(i);if(a!==-1){if(z(e,r)){return n}}return t}var M={electricChars:"dDpPtTfFeE ",startState:function(){return{tokenize:C,lastToken:null,currentIndent:0,nextLineIndent:0,doInCurrentLine:false}},token:function(e,r){if(e.sol()){r.currentIndent+=r.nextLineIndent;r.nextLineIndent=0;r.doInCurrentLine=0}var n=F(e,r);r.lastToken={style:n,content:e.current()};return n},indent:function(r,n){var t=n.replace(/^\s+|\s+$/g,"");if(t.match(w)||t.match(y)||t.match(g))return e.indentUnit*(r.currentIndent-1);if(r.currentIndent<0)return 0;return r.currentIndent*e.indentUnit}};return M});e.defineMIME("text/x-vb","vb")});