(function(e){if(typeof exports=="object"&&typeof module=="object")e(require("../../lib/codemirror"));else if(typeof define=="function"&&define.amd)define(["../../lib/codemirror"],e);else e(CodeMirror)})(function(e){"use strict";e.defineMode("smarty",function(e){"use strict";var t={rightDelimiter:"}",leftDelimiter:"{",smartyVersion:2};if(e.hasOwnProperty("leftDelimiter")){t.leftDelimiter=e.leftDelimiter}if(e.hasOwnProperty("rightDelimiter")){t.rightDelimiter=e.rightDelimiter}if(e.hasOwnProperty("smartyVersion")&&e.smartyVersion===3){t.smartyVersion=3}var r=["debug","extends","function","include","literal"];var i;var n={operatorChars:/[+\-*&%=<>!?]/,validIdentifier:/[a-zA-Z0-9_]/,stringChar:/['"]/};var a={cont:function(e,t){i=t;return e},chain:function(e,t,r){t.tokenize=r;return r(e,t)}};var o={tokenizer:function(e,r){if(e.match(t.leftDelimiter,true)){if(e.eat("*")){return a.chain(e,r,o.inBlock("comment","*"+t.rightDelimiter))}else{r.depth++;var n=e.eol();var l=/\s/.test(e.peek());if(t.smartyVersion===3&&t.leftDelimiter==="{"&&(n||l)){r.depth--;return null}else{r.tokenize=o.smarty;i="startTag";return"tag"}}}else{e.next();return null}},smarty:function(e,l){if(e.match(t.rightDelimiter,true)){if(t.smartyVersion===3){l.depth--;if(l.depth<=0){l.tokenize=o.tokenizer}}else{l.tokenize=o.tokenizer}return a.cont("tag",null)}if(e.match(t.leftDelimiter,true)){l.depth++;return a.cont("tag","startTag")}var f=e.next();if(f=="$"){e.eatWhile(n.validIdentifier);return a.cont("variable-2","variable")}else if(f=="|"){return a.cont("operator","pipe")}else if(f=="."){return a.cont("operator","property")}else if(n.stringChar.test(f)){l.tokenize=o.inAttribute(f);return a.cont("string","string")}else if(n.operatorChars.test(f)){e.eatWhile(n.operatorChars);return a.cont("operator","operator")}else if(f=="["||f=="]"){return a.cont("bracket","bracket")}else if(f=="("||f==")"){return a.cont("bracket","operator")}else if(/\d/.test(f)){e.eatWhile(/\d/);return a.cont("number","number")}else{if(l.last=="variable"){if(f=="@"){e.eatWhile(n.validIdentifier);return a.cont("property","property")}else if(f=="|"){e.eatWhile(n.validIdentifier);return a.cont("qualifier","modifier")}}else if(l.last=="pipe"){e.eatWhile(n.validIdentifier);return a.cont("qualifier","modifier")}else if(l.last=="whitespace"){e.eatWhile(n.validIdentifier);return a.cont("attribute","modifier")}if(l.last=="property"){e.eatWhile(n.validIdentifier);return a.cont("property",null)}else if(/\s/.test(f)){i="whitespace";return null}var s="";if(f!="/"){s+=f}var u=null;while(u=e.eat(n.validIdentifier)){s+=u}for(var c=0,d=r.length;c<d;c++){if(r[c]==s){return a.cont("keyword","keyword")}}if(/\s/.test(f)){return null}return a.cont("tag","tag")}},inAttribute:function(e){return function(t,r){var i=null;var n=null;while(!t.eol()){n=t.peek();if(t.next()==e&&i!=="\\"){r.tokenize=o.smarty;break}i=n}return"string"}},inBlock:function(e,t){return function(r,i){while(!r.eol()){if(r.match(t)){i.tokenize=o.tokenizer;break}r.next()}return e}}};return{startState:function(){return{tokenize:o.tokenizer,mode:"smarty",last:null,depth:0}},token:function(e,t){var r=t.tokenize(e,t);t.last=i;return r},electricChars:""}});e.defineMIME("text/x-smarty","smarty")});