(function(e){if(typeof exports=="object"&&typeof module=="object")e(require("../../lib/codemirror"));else if(typeof define=="function"&&define.amd)define(["../../lib/codemirror"],e);else e(CodeMirror)})(function(e){"use strict";e.defineMode("tiddlywiki",function(){var e={};var t=function(){function e(e){return{type:e,style:"macro"}}return{allTags:e("allTags"),closeAll:e("closeAll"),list:e("list"),newJournal:e("newJournal"),newTiddler:e("newTiddler"),permaview:e("permaview"),saveChanges:e("saveChanges"),search:e("search"),slider:e("slider"),tabs:e("tabs"),tag:e("tag"),tagging:e("tagging"),tags:e("tags"),tiddler:e("tiddler"),timeline:e("timeline"),today:e("today"),version:e("version"),option:e("option"),with:e("with"),filter:e("filter")}}();var r=/[\w_\-]/i,n=/^\-\-\-\-+$/,i=/^\/\*\*\*$/,a=/^\*\*\*\/$/,o=/^<<<$/,u=/^\/\/\{\{\{$/,f=/^\/\/\}\}\}$/,l=/^<!--\{\{\{-->$/,c=/^<!--\}\}\}-->$/,s=/^\{\{\{$/,m=/^\}\}\}$/,d=/.*?\}\}\}/;function h(e,t,r){t.tokenize=r;return r(e,t)}var k,b;function p(e,t,r){k=e;b=r;return t}function v(t,m){var d=t.sol(),k;m.block=false;k=t.peek();if(d&&/[<\/\*{}\-]/.test(k)){if(t.match(s)){m.block=true;return h(t,m,g)}if(t.match(o)){return p("quote","quote")}if(t.match(i)||t.match(a)){return p("code","comment")}if(t.match(u)||t.match(f)||t.match(l)||t.match(c)){return p("code","comment")}if(t.match(n)){return p("hr","hr")}}k=t.next();if(d&&/[\/\*!#;:>|]/.test(k)){if(k=="!"){t.skipToEnd();return p("header","header")}if(k=="*"){t.eatWhile("*");return p("list","comment")}if(k=="#"){t.eatWhile("#");return p("list","comment")}if(k==";"){t.eatWhile(";");return p("list","comment")}if(k==":"){t.eatWhile(":");return p("list","comment")}if(k==">"){t.eatWhile(">");return p("quote","quote")}if(k=="|"){return p("table","header")}}if(k=="{"&&t.match(/\{\{/)){return h(t,m,g)}if(/[hf]/i.test(k)){if(/[ti]/i.test(t.peek())&&t.match(/\b(ttps?|tp|ile):\/\/[\-A-Z0-9+&@#\/%?=~_|$!:,.;]*[A-Z0-9+&@#\/%=~_|$]/i)){return p("link","link")}}if(k=='"'){return p("string","string")}if(k=="~"){return p("text","brace")}if(/[\[\]]/.test(k)){if(t.peek()==k){t.next();return p("brace","brace")}}if(k=="@"){t.eatWhile(r);return p("link","link")}if(/\d/.test(k)){t.eatWhile(/\d/);return p("number","number")}if(k=="/"){if(t.eat("%")){return h(t,m,x)}else if(t.eat("/")){return h(t,m,y)}}if(k=="_"){if(t.eat("_")){return h(t,m,$)}}if(k=="-"){if(t.eat("-")){if(t.peek()!=" ")return h(t,m,z);if(t.peek()==" ")return p("text","brace")}}if(k=="'"){if(t.eat("'")){return h(t,m,w)}}if(k=="<"){if(t.eat("<")){return h(t,m,W)}}else{return p(k)}t.eatWhile(/[\w\$_]/);var b=t.current(),v=e.propertyIsEnumerable(b)&&e[b];return v?p(v.type,v.style,b):p("text",null,b)}function x(e,t){var r=false,n;while(n=e.next()){if(n=="/"&&r){t.tokenize=v;break}r=n=="%"}return p("comment","comment")}function w(e,t){var r=false,n;while(n=e.next()){if(n=="'"&&r){t.tokenize=v;break}r=n=="'"}return p("text","strong")}function g(e,t){var r,n=t.block;if(n&&e.current()){return p("code","comment")}if(!n&&e.match(d)){t.tokenize=v;return p("code","comment")}if(n&&e.sol()&&e.match(m)){t.tokenize=v;return p("code","comment")}r=e.next();return n?p("code","comment"):p("code","comment")}function y(e,t){var r=false,n;while(n=e.next()){if(n=="/"&&r){t.tokenize=v;break}r=n=="/"}return p("text","em")}function $(e,t){var r=false,n;while(n=e.next()){if(n=="_"&&r){t.tokenize=v;break}r=n=="_"}return p("text","underlined")}function z(e,t){var r=false,n;while(n=e.next()){if(n=="-"&&r){t.tokenize=v;break}r=n=="-"}return p("text","strikethrough")}function W(e,r){var n,i,a;if(e.current()=="<<"){return p("brace","macro")}n=e.next();if(!n){r.tokenize=v;return p(n)}if(n==">"){if(e.peek()==">"){e.next();r.tokenize=v;return p("brace","macro")}}e.eatWhile(/[\w\$_]/);i=e.current();a=t.propertyIsEnumerable(i)&&t[i];if(a){return p(a.type,a.style,i)}else{return p("macro",null,i)}}return{startState:function(){return{tokenize:v,indented:0,level:0}},token:function(e,t){if(e.eatSpace())return null;var r=t.tokenize(e,t);return r},electricChars:""}});e.defineMIME("text/x-tiddlywiki","tiddlywiki")});