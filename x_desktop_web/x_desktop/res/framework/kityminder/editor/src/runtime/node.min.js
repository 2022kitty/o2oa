define(function(e,t,n){function o(){var e=this;var t=this.minder;var n=this.hotbox;var o=this.fsm;var i=n.state("main");var a=["前移:Alt+Up:ArrangeUp","下级:Tab|Insert:AppendChildNode","同级:Enter:AppendSiblingNode","后移:Alt+Down:ArrangeDown","删除:Delete|Backspace:RemoveNode","上级:Shift+Tab|Shift+Insert:AppendParentNode"];var r=0;a.forEach(function(n){var a=n.split(":");var l=a.shift();var f=a.shift();var d=a.shift();i.button({position:"ring",label:l,key:f,action:function(){if(d.indexOf("Append")===0){r++;t.execCommand(d,"分支主题");function n(){if(!--r){e.editText()}t.off("layoutallfinish",n)}t.on("layoutallfinish",n)}else{t.execCommand(d);o.jump("normal","command-executed")}},enable:function(){return t.queryCommandState(d)!=-1}})});i.button({position:"bottom",label:"导入节点",key:"Alt + V",enable:function(){var e=t.getSelectedNodes();return e.length==1},action:l,next:"idle"});i.button({position:"bottom",label:"导出节点",key:"Alt + C",enable:function(){var e=t.getSelectedNodes();return e.length==1},action:f,next:"idle"});function l(){t.fire("importNodeData")}function f(){t.fire("exportNodeData")}}return n.exports=o});