define(function(e,t,r){var a=e("../core/kity");var s=e("../core/utils");var n=e("../core/minder");var i=e("../core/node");var o=e("../core/command");var c=e("../core/module");var l=e("../core/render");c.register("ProgressModule",function(){var e=this;var t="progress";var r="#FFED83";var n="#43BC00";var i="M10,3c4.418,0,8,3.582,8,8h1c0-5.523-3.477-10-9-10S1,5.477,1,11h1C2,6.582,5.582,3,10,3z";var c="#8E8E8E";var h="M10,0C4.477,0,0,4.477,0,10c0,5.523,4.477,10,10,10s10-4.477,10-10C20,4.477,15.523,0,10,0zM10,18c-4.418,0-8-3.582-8-8s3.582-8,8-8s8,3.582,8,8S14.418,18,10,18z";var u=(new a.LinearGradient).pipe(function(e){e.setStartPosition(0,0);e.setEndPosition(0,1);e.addStop(0,"#fff");e.addStop(1,"#ccc")});var d="M15.812,7.896l-6.75,6.75l-4.5-4.5L6.25,8.459l2.812,2.803l5.062-5.053L15.812,7.896z";var f="#EEE";e.getPaper().addResource(u);var v=a.createClass("ProgressIcon",{base:a.Group,constructor:function(e){this.callBase();this.setSize(20);this.create();this.setValue(e);this.setId(s.uuid("node_progress"));this.translate(.5,.5)},setSize:function(e){this.width=this.height=e},create:function(){var e,t,s,o,l;e=new a.Circle(9).fill(r);t=new a.Pie(9,0).fill(n);s=(new a.Path).setPathData(i).setTranslate(-10,-10).fill(c);o=(new a.Path).setTranslate(-10,-10).setPathData(h).fill(u);l=(new a.Path).setTranslate(-10,-10).setPathData(d).fill(f);this.addShapes([e,t,s,l,o]);this.pie=t;this.check=l},setValue:function(e){this.pie.setAngle(-360*(e-1)/8);this.check.setVisible(e==9)}});var g=a.createClass("ProgressCommand",{base:o,execute:function(e,r){var a=e.getSelectedNodes();for(var s=0;s<a.length;s++){a[s].setData(t,r||null).render()}e.layout()},queryValue:function(e){var r=e.getSelectedNodes();var a;for(var s=0;s<r.length;s++){a=r[s].getData(t);if(a)break}return a||null},queryState:function(e){return e.getSelectedNodes().length?0:-1}});return{commands:{progress:g},renderers:{left:a.createClass("ProgressRenderer",{base:l,create:function(e){return new v},shouldRender:function(e){return e.getData(t)},update:function(e,r,s){var n=r.getData(t);var i=r.getStyle("space-left");var o,c;e.setValue(n);o=s.left-e.width-i;c=-e.height/2;e.setTranslate(o+e.width/2,c+e.height/2);return new a.Box(o,c,e.width,e.height)}})}}})});