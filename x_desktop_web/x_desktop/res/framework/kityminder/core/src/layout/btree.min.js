define(function(t,e,o){var r=t("../core/kity");var i=t("../core/layout");["left","right","top","bottom"].forEach(n);function n(t){var e=t=="left"||t=="right"?"x":"y";var o=t=="left"||t=="top"?-1:1;var n={left:"right",right:"left",top:"bottom",bottom:"top",x:"y",y:"x"};function a(t){var o=[];var i=t.getLayoutBox();var n=5;if(e=="x"){o.push({type:"up",node:t,area:new r.Box({x:i.x,y:i.top-t.getStyle("margin-top")-n,width:i.width,height:t.getStyle("margin-top")}),path:["M",i.x,i.top-n,"L",i.right,i.top-n]});o.push({type:"down",node:t,area:new r.Box({x:i.x,y:i.bottom+n,width:i.width,height:t.getStyle("margin-bottom")}),path:["M",i.x,i.bottom+n,"L",i.right,i.bottom+n]})}else{o.push({type:"up",node:t,area:new r.Box({x:i.left-t.getStyle("margin-left")-n,y:i.top,width:t.getStyle("margin-left"),height:i.height}),path:["M",i.left-n,i.top,"L",i.left-n,i.bottom]});o.push({type:"down",node:t,area:new r.Box({x:i.right+n,y:i.top,width:t.getStyle("margin-right"),height:i.height}),path:["M",i.right+n,i.top,"L",i.right+n,i.bottom]})}return o}i.register(t,r.createClass({base:i,doLayout:function(i,a){var h=i.getContentBox();if(e=="x"){i.setVertexOut(new r.Point(h[t],h.cy));i.setLayoutVectorOut(new r.Vector(o,0))}else{i.setVertexOut(new r.Point(h.cx,h[t]));i.setLayoutVectorOut(new r.Vector(0,o))}if(!a.length){return false}a.forEach(function(i){var a=i.getContentBox();i.setLayoutTransform(new r.Matrix);if(e=="x"){i.setVertexIn(new r.Point(a[n[t]],a.cy));i.setLayoutVectorIn(new r.Vector(o,0))}else{i.setVertexIn(new r.Point(a.cx,a[n[t]]));i.setLayoutVectorIn(new r.Vector(0,o))}});this.align(a,n[t]);this.stack(a,n[e]);var g=this.getBranchBox(a);var y=0,x=0;if(e=="x"){y=h[t];y+=o*i.getStyle("margin-"+t);y+=o*a[0].getStyle("margin-"+n[t]);x=h.bottom;x-=h.height/2;x-=g.height/2;x-=g.y}else{y=h.right;y-=h.width/2;y-=g.width/2;y-=g.x;x=h[t];x+=o*i.getStyle("margin-"+t);x+=o*a[0].getStyle("margin-"+n[t])}this.move(a,y,x)},getOrderHint:a}))}});