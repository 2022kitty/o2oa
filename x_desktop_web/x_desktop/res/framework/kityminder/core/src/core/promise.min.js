define(function(e,t,n){var i=0;var r=1;var f=2;var u=function(e){if(!(this instanceof u))return new u(e);this.id="Thenable/1.0.7";this.state=i;this.fulfillValue=undefined;this.rejectReason=undefined;this.onFulfilled=[];this.onRejected=[];if(typeof e==="function")e.call(this,this.fulfill.bind(this),this.reject.bind(this))};u.prototype={fulfill:function(e){return c(this,r,"fulfillValue",e)},reject:function(e){return c(this,f,"rejectReason",e)},then:function(e,t){var n=this;var i=new u;n.onFulfilled.push(s(e,i,"fulfill"));n.onRejected.push(s(t,i,"reject"));o(n);return i}};u.all=function(e){return new u(function(t,n){var i=e.length,r=0,f=0,u=[];if(i===0){t(u)}while(r<i){e[r].then(function(e){u.push(e);if(++f===i){t(u)}},function(e){n(e)});r++}})};var c=function(e,t,n,r){if(e.state===i){e.state=t;e[n]=r;o(e)}return e};var o=function(e){if(e.state===r)l(e,"onFulfilled",e.fulfillValue);else if(e.state===f)l(e,"onRejected",e.rejectReason)};var l=function(e,t,n){if(e[t].length===0)return;var i=e[t];e[t]=[];var r=function(){for(var e=0;e<i.length;e++)i[e](n)};if(typeof process==="object"&&typeof process.nextTick==="function")process.nextTick(r);else if(typeof setImmediate==="function")setImmediate(r);else setTimeout(r,0)};var s=function(e,t,n){return function(i){if(typeof e!=="function")t[n].call(t,i);else{var r;try{if(i instanceof u){r=i.then(e)}else r=e(i)}catch(e){t.reject(e);return}a(t,r)}}};var a=function(e,t){if(e===t){e.reject(new TypeError("cannot resolve promise with itself"));return}var n;if(typeof t==="object"&&t!==null||typeof t==="function"){try{n=t.then}catch(t){e.reject(t);return}}if(typeof n==="function"){var i=false;try{n.call(t,function(n){if(i)return;i=true;if(n===t)e.reject(new TypeError("circular thenable chain"));else a(e,n)},function(t){if(i)return;i=true;e.reject(t)})}catch(t){if(!i)e.reject(t)}return}e.fulfill(t)};u.resolve=function(e){return new u(function(t){t(e)})};u.reject=function(e){return new u(function(t,n){n(e)})};n.exports=u});