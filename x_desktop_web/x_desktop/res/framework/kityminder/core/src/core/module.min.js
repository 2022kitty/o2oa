define(function(e,s,t){var i=e("./kity");var r=e("./utils");var n=e("./minder");var o={};s.register=function(e,s){o[e]=s};n.registerInitHook(function(){this._initModules()});i.extendClass(n,{_initModules:function(){var e=o;var s=this._options.modules||r.keys(e);this._commands={};this._query={};this._modules={};this._rendererClasses={};var t,i,n,a,h,l,d,f;var c=this;for(t=0;t<s.length;t++){i=s[t];if(!e[i])continue;if(typeof e[i]=="function"){h=e[i].call(c)}else{h=e[i]}this._modules[i]=h;if(!h)continue;if(h.defaultOptions){c.setDefaultOptions(h.defaultOptions)}if(h.init){h.init.call(c,this._options)}l=h.commands;for(i in l){this._commands[i.toLowerCase()]=new l[i]}d=h.events;if(d){for(n in d){c.on(n,d[n])}}f=h.renderers;if(f){for(n in f){this._rendererClasses[n]=this._rendererClasses[n]||[];if(r.isArray(f[n])){this._rendererClasses[n]=this._rendererClasses[n].concat(f[n])}else{this._rendererClasses[n].push(f[n])}}}if(h.commandShortcutKeys){this.addCommandShortcutKeys(h.commandShortcutKeys)}}},_garbage:function(){this.clearSelect();while(this._root.getChildren().length){this._root.removeChild(0)}},destroy:function(){var e=this._modules;this._resetEvents();this._garbage();for(var s in e){if(!e[s].destroy)continue;e[s].destroy.call(this)}},reset:function(){var e=this._modules;this._garbage();for(var s in e){if(!e[s].reset)continue;e[s].reset.call(this)}}})});