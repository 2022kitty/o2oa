define(function(t,s,a){var i=t("./kity");var n=t("./minder");var u=~window.location.href.indexOf("status");var o=~window.location.href.indexOf("trace");n.registerInitHook(function(){this._initStatus()});i.extendClass(n,{_initStatus:function(){this._status="normal";this._rollbackStatus="normal"},setStatus:function(t,s){if(this._status=="readonly"&&!s)return this;if(t!=this._status){this._rollbackStatus=this._status;this._status=t;this.fire("statuschange",{lastStatus:this._rollbackStatus,currentStatus:this._status});if(u){console.log(window.event.type,this._rollbackStatus,"->",this._status);if(o){console.trace()}}}return this},rollbackStatus:function(){this.setStatus(this._rollbackStatus)},getRollbackStatus:function(){return this._rollbackStatus},getStatus:function(){return this._status}})});