ace.define("ace/ext/elastic_tabstops_lite",["require","exports","module","ace/editor","ace/config"],function(t,e,s){"use strict";var i=function(t){this.$editor=t;var e=this,s=[],i=!1;this.onAfterExec=function(){i=!1,e.processRows(s),s=[]},this.onExec=function(){i=!0},this.onChange=function(t){i&&(s.indexOf(t.start.row)==-1&&s.push(t.start.row),t.end.row!=t.start.row&&s.push(t.end.row))}};(function(){this.processRows=function(t){this.$inChange=!0;var e=[];for(var s=0,i=t.length;s<i;s++){var o=t[s];if(e.indexOf(o)>-1)continue;var n=this.$findCellWidthsForBlock(o),r=this.$setBlockCellWidthsToMax(n.cellWidths),a=n.firstRow;for(var h=0,c=r.length;h<c;h++){var l=r[h];e.push(a),this.$adjustRow(a,l),a++}}this.$inChange=!1},this.$findCellWidthsForBlock=function(t){var e=[],s,i=t;while(i>=0){s=this.$cellWidthsForRow(i);if(s.length==0)break;e.unshift(s),i--}var o=i+1;i=t;var n=this.$editor.session.getLength();while(i<n-1){i++,s=this.$cellWidthsForRow(i);if(s.length==0)break;e.push(s)}return{cellWidths:e,firstRow:o}},this.$cellWidthsForRow=function(t){var e=this.$selectionColumnsForRow(t),s=[-1].concat(this.$tabsForRow(t)),i=s.map(function(t){return 0}).slice(1),o=this.$editor.session.getLine(t);for(var n=0,r=s.length-1;n<r;n++){var a=s[n]+1,h=s[n+1],c=this.$rightmostSelectionInCell(e,h),l=o.substring(a,h);i[n]=Math.max(l.replace(/\s+$/g,"").length,c-a)}return i},this.$selectionColumnsForRow=function(t){var e=[],s=this.$editor.getCursorPosition();return this.$editor.session.getSelection().isEmpty()&&t==s.row&&e.push(s.column),e},this.$setBlockCellWidthsToMax=function(t){var e=!0,s,i,o,n=this.$izip_longest(t);for(var r=0,a=n.length;r<a;r++){var h=n[r];if(!h.push){console.error(h);continue}h.push(NaN);for(var c=0,l=h.length;c<l;c++){var u=h[c];e&&(s=c,o=0,e=!1);if(isNaN(u)){i=c;for(var f=s;f<i;f++)t[f][r]=o;e=!0}o=Math.max(o,u)}}return t},this.$rightmostSelectionInCell=function(t,e){var s=0;if(t.length){var i=[];for(var o=0,n=t.length;o<n;o++)t[o]<=e?i.push(o):i.push(0);s=Math.max.apply(Math,i)}return s},this.$tabsForRow=function(t){var e=[],s=this.$editor.session.getLine(t),i=/\t/g,o;while((o=i.exec(s))!=null)e.push(o.index);return e},this.$adjustRow=function(t,e){var s=this.$tabsForRow(t);if(s.length==0)return;var i=0,o=-1,n=this.$izip(e,s);for(var r=0,a=n.length;r<a;r++){var h=n[r][0],c=n[r][1];o+=1+h,c+=i;var l=o-c;if(l==0)continue;var u=this.$editor.session.getLine(t).substr(0,c),f=u.replace(/\s*$/g,""),g=u.length-f.length;l>0&&(this.$editor.session.getDocument().insertInLine({row:t,column:c+1},Array(l+1).join(" ")+"\t"),this.$editor.session.getDocument().removeInLine(t,c,c+1),i+=l),l<0&&g>=-l&&(this.$editor.session.getDocument().removeInLine(t,c+l,c),i+=l)}},this.$izip_longest=function(t){if(!t[0])return[];var e=t[0].length,s=t.length;for(var i=1;i<s;i++){var o=t[i].length;o>e&&(e=o)}var n=[];for(var r=0;r<e;r++){var a=[];for(var i=0;i<s;i++)t[i][r]===""?a.push(NaN):a.push(t[i][r]);n.push(a)}return n},this.$izip=function(t,e){var s=t.length>=e.length?e.length:t.length,i=[];for(var o=0;o<s;o++){var n=[t[o],e[o]];i.push(n)}return i}}).call(i.prototype),e.ElasticTabstopsLite=i;var o=t("../editor").Editor;t("../config").defineOptions(o.prototype,"editor",{useElasticTabstops:{set:function(t){t?(this.elasticTabstops||(this.elasticTabstops=new i(this)),this.commands.on("afterExec",this.elasticTabstops.onAfterExec),this.commands.on("exec",this.elasticTabstops.onExec),this.on("change",this.elasticTabstops.onChange)):this.elasticTabstops&&(this.commands.removeListener("afterExec",this.elasticTabstops.onAfterExec),this.commands.removeListener("exec",this.elasticTabstops.onExec),this.removeListener("change",this.elasticTabstops.onChange))}}})});(function(){ace.require(["ace/ext/elastic_tabstops_lite"],function(){})})();