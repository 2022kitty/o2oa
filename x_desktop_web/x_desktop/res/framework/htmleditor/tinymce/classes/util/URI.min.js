define("tinymce/util/URI",["tinymce/util/Tools"],function(t){var o=t.each,e=t.trim,r={ftp:21,http:80,https:443,mailto:25};function i(t,r){var s=this,n,h;t=e(t);r=s.settings=r||{};if(/^([\w\-]+):([^\/]{2})/i.test(t)||/^\s*#/.test(t)){s.source=t;return}var f=t.indexOf("//")===0;if(t.indexOf("/")===0&&!f){t=(r.base_uri?r.base_uri.protocol||"http":"http")+"://mce_host"+t}if(!/^[\w\-]*:?\/\//.test(t)){h=r.base_uri?r.base_uri.path:new i(location.href).directory;if(r.base_uri.protocol===""){t="//mce_host"+s.toAbsPath(h,t)}else{t=(r.base_uri&&r.base_uri.protocol||"http")+"://mce_host"+s.toAbsPath(h,t)}}t=t.replace(/@@/g,"(mce_at)");t=/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@\/]*):?([^:@\/]*))?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/.exec(t);o(["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],function(o,e){var r=t[e];if(r){r=r.replace(/\(mce_at\)/g,"@@")}s[o]=r});n=r.base_uri;if(n){if(!s.protocol){s.protocol=n.protocol}if(!s.userInfo){s.userInfo=n.userInfo}if(!s.port&&s.host==="mce_host"){s.port=n.port}if(!s.host||s.host==="mce_host"){s.host=n.host}s.source=""}if(f){s.protocol=""}}i.prototype={setPath:function(t){var o=this;t=/^(.*?)\/?(\w+)?$/.exec(t);o.path=t[0];o.directory=t[1];o.file=t[2];o.source="";o.getURI()},toRelative:function(t){var o=this,e;if(t==="./"){return t}t=new i(t,{base_uri:o});if(t.host!="mce_host"&&o.host!=t.host&&t.host||o.port!=t.port||o.protocol!=t.protocol&&t.protocol!==""){return t.getURI()}var r=o.getURI(),s=t.getURI();if(r==s||r.charAt(r.length-1)=="/"&&r.substr(0,r.length-1)==s){return r}e=o.toRelPath(o.path,t.path);if(t.query){e+="?"+t.query}if(t.anchor){e+="#"+t.anchor}return e},toAbsolute:function(t,o){t=new i(t,{base_uri:this});return t.getURI(o&&this.isSameOrigin(t))},isSameOrigin:function(t){if(this.host==t.host&&this.protocol==t.protocol){if(this.port==t.port){return true}var o=r[this.protocol];if(o&&(this.port||o)==(t.port||o)){return true}}return false},toRelPath:function(t,o){var e,r=0,i="",s,n;t=t.substring(0,t.lastIndexOf("/"));t=t.split("/");e=o.split("/");if(t.length>=e.length){for(s=0,n=t.length;s<n;s++){if(s>=e.length||t[s]!=e[s]){r=s+1;break}}}if(t.length<e.length){for(s=0,n=e.length;s<n;s++){if(s>=t.length||t[s]!=e[s]){r=s+1;break}}}if(r===1){return o}for(s=0,n=t.length-(r-1);s<n;s++){i+="../"}for(s=r-1,n=e.length;s<n;s++){if(s!=r-1){i+="/"+e[s]}else{i+=e[s]}}return i},toAbsPath:function(t,e){var r,i=0,s=[],n,h;n=/\/$/.test(e)?"/":"";t=t.split("/");e=e.split("/");o(t,function(t){if(t){s.push(t)}});t=s;for(r=e.length-1,s=[];r>=0;r--){if(e[r].length===0||e[r]==="."){continue}if(e[r]===".."){i++;continue}if(i>0){i--;continue}s.push(e[r])}r=t.length-i;if(r<=0){h=s.reverse().join("/")}else{h=t.slice(0,r).join("/")+"/"+s.reverse().join("/")}if(h.indexOf("/")!==0){h="/"+h}if(n&&h.lastIndexOf("/")!==h.length-1){h+=n}return h},getURI:function(t){var o,e=this;if(!e.source||t){o="";if(!t){if(e.protocol){o+=e.protocol+"://"}else{o+="//"}if(e.userInfo){o+=e.userInfo+"@"}if(e.host){o+=e.host}if(e.port){o+=":"+e.port}}if(e.path){o+=e.path}if(e.query){o+="?"+e.query}if(e.anchor){o+="#"+e.anchor}e.source=o}return e.source}};return i});