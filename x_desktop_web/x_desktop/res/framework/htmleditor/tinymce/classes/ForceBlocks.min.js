define("tinymce/ForceBlocks",[],function(){return function(e){var t=e.settings,o=e.dom,n=e.selection;var r=e.schema,a=r.getBlockElements();function c(){var c=n.getStart(),i=e.getBody(),l;var d,s,f,m,g;var h,p=-16777215,u,v;var y,T,C;C=t.forced_root_block;if(!c||c.nodeType!==1||!C){return}while(c&&c!=i){if(a[c.nodeName]){return}c=c.parentNode}l=n.getRng();if(l.setStart){d=l.startContainer;s=l.startOffset;f=l.endContainer;m=l.endOffset;try{v=e.getDoc().activeElement===i}catch(e){}}else{if(l.item){c=l.item(0);l=e.getDoc().body.createTextRange();l.moveToElementText(c)}v=l.parentElement().ownerDocument===e.getDoc();y=l.duplicate();y.collapse(true);s=y.move("character",p)*-1;if(!y.collapsed){y=l.duplicate();y.collapse(false);m=y.move("character",p)*-1-s}}c=i.firstChild;T=i.nodeName.toLowerCase();while(c){if((c.nodeType===3||c.nodeType==1&&!a[c.nodeName])&&r.isValidChild(T,C.toLowerCase())){if(c.nodeType===3&&c.nodeValue.length===0){h=c;c=c.nextSibling;o.remove(h);continue}if(!g){g=o.create(C,e.settings.forced_root_block_attrs);c.parentNode.insertBefore(g,c);u=true}h=c;c=c.nextSibling;g.appendChild(h)}else{g=null;c=c.nextSibling}}if(u&&v){if(l.setStart){l.setStart(d,s);l.setEnd(f,m);n.setRng(l)}else{try{l=e.getDoc().body.createTextRange();l.moveToElementText(i);l.collapse(true);l.moveStart("character",s);if(m>0){l.moveEnd("character",m)}l.select()}catch(e){}}e.nodeChanged()}}if(t.forced_root_block){e.on("NodeChange",c)}}});