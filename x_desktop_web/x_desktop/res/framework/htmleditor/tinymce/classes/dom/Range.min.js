define("tinymce/dom/Range",["tinymce/util/Tools"],function(e){function n(t){var r=this,i=t.doc,o=0,f=1,l=2,d=true,a=false,u="startOffset",s="startContainer",p="endContainer",c="endOffset",h=e.extend,N=t.nodeIndex;function C(){return i.createDocumentFragment()}function g(e,n){P(d,e,n)}function S(e,n){P(a,e,n)}function v(e){g(e.parentNode,N(e))}function T(e){g(e.parentNode,N(e)+1)}function b(e){S(e.parentNode,N(e))}function w(e){S(e.parentNode,N(e)+1)}function m(e){if(e){r[p]=r[s];r[c]=r[u]}else{r[s]=r[p];r[u]=r[c]}r.collapsed=d}function x(e){v(e);w(e)}function A(e){g(e,0);S(e,e.nodeType===1?e.childNodes.length:e.nodeValue.length)}function y(e,n){var t=r[s],i=r[u],o=r[p],f=r[c],l=n.startContainer,d=n.startOffset,a=n.endContainer,h=n.endOffset;if(e===0){return F(t,i,l,d)}if(e===1){return F(o,f,l,d)}if(e===2){return F(o,f,a,h)}if(e===3){return F(t,i,a,h)}}function O(){j(l)}function E(){return j(o)}function B(){return j(f)}function V(e){var n=this[s],r=this[u],i,o;if((n.nodeType===3||n.nodeType===4)&&n.nodeValue){if(!r){n.parentNode.insertBefore(e,n)}else if(r>=n.nodeValue.length){t.insertAfter(e,n)}else{i=n.splitText(r);n.parentNode.insertBefore(e,i)}}else{if(n.childNodes.length>0){o=n.childNodes[r]}if(o){n.insertBefore(e,o)}else{if(n.nodeType==3){t.insertAfter(e,n)}else{n.appendChild(e)}}}}function _(e){var n=r.extractContents();r.insertNode(e);e.appendChild(n);r.selectNode(e)}function D(){return h(new n(t),{startContainer:r[s],startOffset:r[u],endContainer:r[p],endOffset:r[c],collapsed:r.collapsed,commonAncestorContainer:r.commonAncestorContainer})}function R(e,n){var t;if(e.nodeType==3){return e}if(n<0){return e}t=e.firstChild;while(t&&n>0){--n;t=t.nextSibling}if(t){return t}return e}function I(){return r[s]==r[p]&&r[u]==r[c]}function F(e,n,r,i){var o,f,l,d,a,u;if(e==r){if(n==i){return 0}if(n<i){return-1}return 1}o=r;while(o&&o.parentNode!=e){o=o.parentNode}if(o){f=0;l=e.firstChild;while(l!=o&&f<n){f++;l=l.nextSibling}if(n<=f){return-1}return 1}o=e;while(o&&o.parentNode!=r){o=o.parentNode}if(o){f=0;l=r.firstChild;while(l!=o&&f<i){f++;l=l.nextSibling}if(f<i){return-1}return 1}d=t.findCommonAncestor(e,r);a=e;while(a&&a.parentNode!=d){a=a.parentNode}if(!a){a=d}u=r;while(u&&u.parentNode!=d){u=u.parentNode}if(!u){u=d}if(a==u){return 0}l=d.firstChild;while(l){if(l==a){return-1}if(l==u){return 1}l=l.nextSibling}}function P(e,n,i){var o,f;if(e){r[s]=n;r[u]=i}else{r[p]=n;r[c]=i}o=r[p];while(o.parentNode){o=o.parentNode}f=r[s];while(f.parentNode){f=f.parentNode}if(f==o){if(F(r[s],r[u],r[p],r[c])>0){r.collapse(e)}}else{r.collapse(e)}r.collapsed=I();r.commonAncestorContainer=t.findCommonAncestor(r[s],r[p])}function j(e){var n,t=0,i=0,o,f,l,d,a,u;if(r[s]==r[p]){return k(e)}for(n=r[p],o=n.parentNode;o;n=o,o=o.parentNode){if(o==r[s]){return q(n,e)}++t}for(n=r[s],o=n.parentNode;o;n=o,o=o.parentNode){if(o==r[p]){return z(n,e)}++i}f=i-t;l=r[s];while(f>0){l=l.parentNode;f--}d=r[p];while(f<0){d=d.parentNode;f++}for(a=l.parentNode,u=d.parentNode;a!=u;a=a.parentNode,u=u.parentNode){l=a;d=u}return G(l,d,e)}function k(e){var n,t,o,a,p,h,N,g,S;if(e!=l){n=C()}if(r[u]==r[c]){return n}if(r[s].nodeType==3){t=r[s].nodeValue;o=t.substring(r[u],r[c]);if(e!=f){a=r[s];g=r[u];S=r[c]-r[u];if(g===0&&S>=a.nodeValue.length-1){a.parentNode.removeChild(a)}else{a.deleteData(g,S)}r.collapse(d)}if(e==l){return}if(o.length>0){n.appendChild(i.createTextNode(o))}return n}a=R(r[s],r[u]);p=r[c]-r[u];while(a&&p>0){h=a.nextSibling;N=L(a,e);if(n){n.appendChild(N)}--p;a=h}if(e!=f){r.collapse(d)}return n}function q(e,n){var t,i,o,d,s,p;if(n!=l){t=C()}i=H(e,n);if(t){t.appendChild(i)}o=N(e);d=o-r[u];if(d<=0){if(n!=f){r.setEndBefore(e);r.collapse(a)}return t}i=e.previousSibling;while(d>0){s=i.previousSibling;p=L(i,n);if(t){t.insertBefore(p,t.firstChild)}--d;i=s}if(n!=f){r.setEndBefore(e);r.collapse(a)}return t}function z(e,n){var t,i,o,a,u,s;if(n!=l){t=C()}o=J(e,n);if(t){t.appendChild(o)}i=N(e);++i;a=r[c]-i;o=e.nextSibling;while(o&&a>0){u=o.nextSibling;s=L(o,n);if(t){t.appendChild(s)}--a;o=u}if(n!=f){r.setStartAfter(e);r.collapse(d)}return t}function G(e,n,t){var i,o,a,u,s,p,c;if(t!=l){o=C()}i=J(e,t);if(o){o.appendChild(i)}a=N(e);u=N(n);++a;s=u-a;p=e.nextSibling;while(s>0){c=p.nextSibling;i=L(p,t);if(o){o.appendChild(i)}p=c;--s}i=H(n,t);if(o){o.appendChild(i)}if(t!=f){r.setStartAfter(e);r.collapse(d)}return o}function H(e,n){var t=R(r[p],r[c]-1),i,o;var f,u,s,h=t!=r[p];if(t==e){return K(t,h,a,n)}i=t.parentNode;o=K(i,a,a,n);while(i){while(t){f=t.previousSibling;u=K(t,h,a,n);if(n!=l){o.insertBefore(u,o.firstChild)}h=d;t=f}if(i==e){return o}t=i.previousSibling;i=i.parentNode;s=K(i,a,a,n);if(n!=l){s.appendChild(o)}o=s}}function J(e,n){var t=R(r[s],r[u]),i=t!=r[s];var o,f,p,c,h;if(t==e){return K(t,i,d,n)}o=t.parentNode;f=K(o,a,d,n);while(o){while(t){p=t.nextSibling;c=K(t,i,d,n);if(n!=l){f.appendChild(c)}i=d;t=p}if(o==e){return f}t=o.nextSibling;o=o.parentNode;h=K(o,a,d,n);if(n!=l){h.appendChild(f)}f=h}}function K(e,n,i,o){var d,s,p,h,N;if(n){return L(e,o)}if(e.nodeType==3){d=e.nodeValue;if(i){h=r[u];s=d.substring(h);p=d.substring(0,h)}else{h=r[c];s=d.substring(0,h);p=d.substring(h)}if(o!=f){e.nodeValue=p}if(o==l){return}N=t.clone(e,a);N.nodeValue=s;return N}if(o==l){return}return t.clone(e,a)}function L(e,n){if(n!=l){return n==f?t.clone(e,d):e}e.parentNode.removeChild(e)}function M(){return t.create("body",null,B()).outerText}h(r,{startContainer:i,startOffset:0,endContainer:i,endOffset:0,collapsed:d,commonAncestorContainer:i,START_TO_START:0,START_TO_END:1,END_TO_END:2,END_TO_START:3,setStart:g,setEnd:S,setStartBefore:v,setStartAfter:T,setEndBefore:b,setEndAfter:w,collapse:m,selectNode:x,selectNodeContents:A,compareBoundaryPoints:y,deleteContents:O,extractContents:E,cloneContents:B,insertNode:V,surroundContents:_,cloneRange:D,toStringIE:M});return r}n.prototype.toString=function(){return this.toStringIE()};return n});