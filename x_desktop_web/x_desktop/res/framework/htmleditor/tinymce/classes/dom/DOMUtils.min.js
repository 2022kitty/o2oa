define("tinymce/dom/DOMUtils",["tinymce/dom/Sizzle","tinymce/html/Styles","tinymce/dom/EventUtils","tinymce/dom/TreeWalker","tinymce/dom/Range","tinymce/html/Entities","tinymce/Env","tinymce/util/Tools","tinymce/dom/StyleSheetLoader"],function(e,t,n,r,i,s,o,a,l){var u=a.each,c=a.is,f=a.grep,d=a.trim,h=a.extend;var p=o.webkit,m=o.ie;var g=/^([a-z0-9],?)+$/i;var y=/^[ \t\r\n]*$/;var v=a.makeMap("fillOpacity fontWeight lineHeight opacity orphans widows zIndex zoom"," ");function b(e,r){var i=this,s;i.doc=e;i.win=window;i.files={};i.counter=0;i.stdMode=!m||e.documentMode>=8;i.boxModel=!m||e.compatMode=="CSS1Compat"||i.stdMode;i.hasOuterHTML="outerHTML"in e.createElement("a");i.styleSheetLoader=new l(e);this.boundEvents=[];i.settings=r=h({keep_values:false,hex_colors:1},r);i.schema=r.schema;i.styles=new t({url_converter:r.url_converter,url_converter_scope:r.url_converter_scope},r.schema);i.fixDoc(e);i.events=r.ownEvents?new n(r.proxy):n.Event;s=r.schema?r.schema.getBlockElements():{};i.isBlock=function(e){if(!e){return false}var t=e.nodeType;if(t){return!!(t===1&&s[e.nodeName])}return!!s[e]}}b.prototype={root:null,props:{for:"htmlFor",class:"className",className:"className",checked:"checked",disabled:"disabled",maxlength:"maxLength",readonly:"readOnly",selected:"selected",value:"value",id:"id",name:"name",type:"type"},fixDoc:function(e){var t=this.settings,n;if(m&&t.schema){("abbr article aside audio canvas "+"details figcaption figure footer "+"header hgroup mark menu meter nav "+"output progress section summary "+"time video").replace(/\w+/g,function(t){e.createElement(t)});for(n in t.schema.getCustomElements()){e.createElement(n)}}},clone:function(e,t){var n=this,r,i;if(!m||e.nodeType!==1||t){return e.cloneNode(t)}i=n.doc;if(!t){r=i.createElement(e.nodeName);u(n.getAttribs(e),function(t){n.setAttrib(r,t.nodeName,n.getAttrib(e,t.nodeName))});return r}return r.firstChild},getRoot:function(){var e=this;return e.get(e.settings.root_element)||e.doc.body},getViewPort:function(e){var t,n;e=!e?this.win:e;t=e.document;n=this.boxModel?t.documentElement:t.body;return{x:e.pageXOffset||n.scrollLeft,y:e.pageYOffset||n.scrollTop,w:e.innerWidth||n.clientWidth,h:e.innerHeight||n.clientHeight}},getRect:function(e){var t=this,n,r;e=t.get(e);n=t.getPos(e);r=t.getSize(e);return{x:n.x,y:n.y,w:r.w,h:r.h}},getSize:function(e){var t=this,n,r;e=t.get(e);n=t.getStyle(e,"width");r=t.getStyle(e,"height");if(n.indexOf("px")===-1){n=0}if(r.indexOf("px")===-1){r=0}return{w:parseInt(n,10)||e.offsetWidth||e.clientWidth,h:parseInt(r,10)||e.offsetHeight||e.clientHeight}},getParent:function(e,t,n){return this.getParents(e,t,n,false)},getParents:function(e,t,n,r){var i=this,s,o=[];e=i.get(e);r=r===undefined;n=n||(i.getRoot().nodeName!="BODY"?i.getRoot().parentNode:null);if(c(t,"string")){s=t;if(t==="*"){t=function(e){return e.nodeType==1}}else{t=function(e){return i.is(e,s)}}}while(e){if(e==n||!e.nodeType||e.nodeType===9){break}if(!t||t(e)){if(r){o.push(e)}else{return e}}e=e.parentNode}return r?o:null},get:function(e){var t;if(e&&this.doc&&typeof e=="string"){t=e;e=this.doc.getElementById(e);if(e&&e.id!==t){return this.doc.getElementsByName(t)[1]}}return e},getNext:function(e,t){return this._findSib(e,t,"nextSibling")},getPrev:function(e,t){return this._findSib(e,t,"previousSibling")},select:function(t,n){var r=this;return e(t,r.get(n)||r.get(r.settings.root_element)||r.doc,[])},is:function(t,n){var r;if(t.length===undefined){if(n==="*"){return t.nodeType==1}if(g.test(n)){n=n.toLowerCase().split(/,/);t=t.nodeName.toLowerCase();for(r=n.length-1;r>=0;r--){if(n[r]==t){return true}}return false}}if(t.nodeType&&t.nodeType!=1){return false}var i=t.nodeType?[t]:t;return e(n,i[0].ownerDocument||i[0],null,i).length>0},add:function(e,t,n,r,i){var s=this;return this.run(e,function(e){var o;o=c(t,"string")?s.doc.createElement(t):t;s.setAttribs(o,n);if(r){if(r.nodeType){o.appendChild(r)}else{s.setHTML(o,r)}}return!i?e.appendChild(o):o})},create:function(e,t,n){return this.add(this.doc.createElement(e),e,t,n,1)},createHTML:function(e,t,n){var r="",i;r+="<"+e;for(i in t){if(t.hasOwnProperty(i)&&t[i]!==null){r+=" "+i+'="'+this.encode(t[i])+'"'}}if(typeof n!="undefined"){return r+">"+n+"</"+e+">"}return r+" />"},createFragment:function(e){var t,n,r=this.doc,i;i=r.createElement("div");t=r.createDocumentFragment();if(e){i.innerHTML=e}while(n=i.firstChild){t.appendChild(n)}return t},remove:function(e,t){return this.run(e,function(e){var n,r=e.parentNode;if(!r){return null}if(t){while(n=e.firstChild){if(!m||n.nodeType!==3||n.nodeValue){r.insertBefore(n,e)}else{e.removeChild(n)}}}return r.removeChild(e)})},setStyle:function(e,t,n){return this.run(e,function(e){var r=this,i,s;if(t){if(typeof t==="string"){i=e.style;t=t.replace(/-(\D)/g,function(e,t){return t.toUpperCase()});if(typeof n==="number"&&!v[t]){n+="px"}if(t==="opacity"&&e.runtimeStyle&&typeof e.runtimeStyle.opacity==="undefined"){i.filter=n===""?"":"alpha(opacity="+n*100+")"}if(t=="float"){t="cssFloat"in e.style?"cssFloat":"styleFloat"}try{i[t]=n}catch(e){}if(r.settings.update_styles){e.removeAttribute("data-mce-style")}}else{for(s in t){r.setStyle(e,s,t[s])}}}})},getStyle:function(e,t,n){e=this.get(e);if(!e){return}if(this.doc.defaultView&&n){t=t.replace(/[A-Z]/g,function(e){return"-"+e});try{return this.doc.defaultView.getComputedStyle(e,null).getPropertyValue(t)}catch(e){return null}}t=t.replace(/-(\D)/g,function(e,t){return t.toUpperCase()});if(t=="float"){t=m?"styleFloat":"cssFloat"}if(e.currentStyle&&n){return e.currentStyle[t]}return e.style?e.style[t]:undefined},setStyles:function(e,t){this.setStyle(e,t)},css:function(e,t,n){this.setStyle(e,t,n)},removeAllAttribs:function(e){return this.run(e,function(e){var t,n=e.attributes;for(t=n.length-1;t>=0;t--){e.removeAttributeNode(n.item(t))}})},setAttrib:function(e,t,n){var r=this;if(!e||!t){return}return this.run(e,function(e){var i=r.settings;var s=e.getAttribute(t);if(n!==null){switch(t){case"style":if(!c(n,"string")){u(n,function(t,n){r.setStyle(e,n,t)});return}if(i.keep_values){if(n){e.setAttribute("data-mce-style",n,2)}else{e.removeAttribute("data-mce-style",2)}}e.style.cssText=n;break;case"class":e.className=n||"";break;case"src":case"href":if(i.keep_values){if(i.url_converter){n=i.url_converter.call(i.url_converter_scope||r,n,t,e)}r.setAttrib(e,"data-mce-"+t,n,2)}break;case"shape":e.setAttribute("data-mce-style",n);break}}if(c(n)&&n!==null&&n.length!==0){e.setAttribute(t,""+n,2)}else{e.removeAttribute(t,2)}if(s!=n&&i.onSetAttrib){i.onSetAttrib({attrElm:e,attrName:t,attrValue:n})}})},setAttribs:function(e,t){var n=this;return this.run(e,function(e){u(t,function(t,r){n.setAttrib(e,r,t)})})},getAttrib:function(e,t,n){var r,i=this,s;e=i.get(e);if(!e||e.nodeType!==1){return n===s?false:n}if(!c(n)){n=""}if(/^(src|href|style|coords|shape)$/.test(t)){r=e.getAttribute("data-mce-"+t);if(r){return r}}if(m&&i.props[t]){r=e[i.props[t]];r=r&&r.nodeValue?r.nodeValue:r}if(!r){r=e.getAttribute(t,2)}if(/^(checked|compact|declare|defer|disabled|ismap|multiple|nohref|noshade|nowrap|readonly|selected)$/.test(t)){if(e[i.props[t]]===true&&r===""){return t}return r?t:""}if(e.nodeName==="FORM"&&e.getAttributeNode(t)){return e.getAttributeNode(t).nodeValue}if(t==="style"){r=r||e.style.cssText;if(r){r=i.serializeStyle(i.parseStyle(r),e.nodeName);if(i.settings.keep_values){e.setAttribute("data-mce-style",r)}}}if(p&&t==="class"&&r){r=r.replace(/(apple|webkit)\-[a-z\-]+/gi,"")}if(m){switch(t){case"rowspan":case"colspan":if(r===1){r=""}break;case"size":if(r==="+0"||r===20||r===0){r=""}break;case"width":case"height":case"vspace":case"checked":case"disabled":case"readonly":if(r===0){r=""}break;case"hspace":if(r===-1){r=""}break;case"maxlength":case"tabindex":if(r===32768||r===2147483647||r==="32768"){r=""}break;case"multiple":case"compact":case"noshade":case"nowrap":if(r===65535){return t}return n;case"shape":r=r.toLowerCase();break;default:if(t.indexOf("on")===0&&r){r=(""+r).replace(/^function\s+\w+\(\)\s+\{\s+(.*)\s+\}$/,"$1")}}}return r!==s&&r!==null&&r!==""?""+r:n},getPos:function(e,t){var n=this,r=0,i=0,s,o=n.doc,a;e=n.get(e);t=t||o.body;if(e){if(t===o.body&&e.getBoundingClientRect){a=e.getBoundingClientRect();t=n.boxModel?o.documentElement:o.body;r=a.left+(o.documentElement.scrollLeft||o.body.scrollLeft)-t.clientLeft;i=a.top+(o.documentElement.scrollTop||o.body.scrollTop)-t.clientTop;return{x:r,y:i}}s=e;while(s&&s!=t&&s.nodeType){r+=s.offsetLeft||0;i+=s.offsetTop||0;s=s.offsetParent}s=e.parentNode;while(s&&s!=t&&s.nodeType){r-=s.scrollLeft||0;i-=s.scrollTop||0;s=s.parentNode}}return{x:r,y:i}},parseStyle:function(e){return this.styles.parse(e)},serializeStyle:function(e,t){return this.styles.serialize(e,t)},addStyle:function(e){var t=this,n=t.doc,r,i;if(t!==b.DOM&&n===document){var s=b.DOM.addedStyles;s=s||[];if(s[e]){return}s[e]=true;b.DOM.addedStyles=s}i=n.getElementById("mceDefaultStyles");if(!i){i=n.createElement("style");i.id="mceDefaultStyles";i.type="text/css";r=n.getElementsByTagName("head")[0];if(r.firstChild){r.insertBefore(i,r.firstChild)}else{r.appendChild(i)}}if(i.styleSheet){i.styleSheet.cssText+=e}else{i.appendChild(n.createTextNode(e))}},loadCSS:function(e){var t=this,n=t.doc,r;if(t!==b.DOM&&n===document){b.DOM.loadCSS(e);return}if(!e){e=""}r=n.getElementsByTagName("head")[0];u(e.split(","),function(e){var i;if(t.files[e]){return}t.files[e]=true;i=t.create("link",{rel:"stylesheet",href:e});if(m&&n.documentMode&&n.recalc){i.onload=function(){if(n.recalc){n.recalc()}i.onload=null}}r.appendChild(i)})},addClass:function(e,t){return this.run(e,function(e){var n;if(!t){return 0}if(this.hasClass(e,t)){return e.className}n=this.removeClass(e,t);e.className=n=(n!==""?n+" ":"")+t;return n})},removeClass:function(e,t){var n=this,r;return n.run(e,function(e){var i;if(n.hasClass(e,t)){if(!r){r=new RegExp("(^|\\s+)"+t+"(\\s+|$)","g")}i=e.className.replace(r," ");i=d(i!=" "?i:"");e.className=i;if(!i){e.removeAttribute("class");e.removeAttribute("className")}return i}return e.className})},hasClass:function(e,t){e=this.get(e);if(!e||!t){return false}return(" "+e.className+" ").indexOf(" "+t+" ")!==-1},toggleClass:function(e,t,n){n=n===undefined?!this.hasClass(e,t):n;if(this.hasClass(e,t)!==n){if(n){this.addClass(e,t)}else{this.removeClass(e,t)}}},show:function(e){return this.setStyle(e,"display","block")},hide:function(e){return this.setStyle(e,"display","none")},isHidden:function(e){e=this.get(e);return!e||e.style.display=="none"||this.getStyle(e,"display")=="none"},uniqueId:function(e){return(!e?"mce_":e)+this.counter++},setHTML:function(e,t){var n=this;return n.run(e,function(e){if(m){while(e.firstChild){e.removeChild(e.firstChild)}try{e.innerHTML="<br />"+t;e.removeChild(e.firstChild)}catch(i){var r=n.create("div");r.innerHTML="<br />"+t;u(f(r.childNodes),function(t,n){if(n&&e.canHaveHTML){e.appendChild(t)}})}}else{e.innerHTML=t}return t})},getOuterHTML:function(e){var t,n=this;e=n.get(e);if(!e){return null}if(e.nodeType===1&&n.hasOuterHTML){return e.outerHTML}t=(e.ownerDocument||n.doc).createElement("body");t.appendChild(e.cloneNode(true));return t.innerHTML},setOuterHTML:function(e,t,n){var r=this;return r.run(e,function(e){function i(){var i,s;s=n.createElement("body");s.innerHTML=t;i=s.lastChild;while(i){r.insertAfter(i.cloneNode(true),e);i=i.previousSibling}r.remove(e)}if(e.nodeType==1){n=n||e.ownerDocument||r.doc;if(m){try{if(e.nodeType==1&&r.hasOuterHTML){e.outerHTML=t}else{i()}}catch(e){i()}}else{i()}}})},decode:s.decode,encode:s.encodeAllRaw,insertAfter:function(e,t){t=this.get(t);return this.run(e,function(e){var n,r;n=t.parentNode;r=t.nextSibling;if(r){n.insertBefore(e,r)}else{n.appendChild(e)}return e})},replace:function(e,t,n){var r=this;return r.run(t,function(t){if(c(t,"array")){e=e.cloneNode(true)}if(n){u(f(t.childNodes),function(t){e.appendChild(t)})}return t.parentNode.replaceChild(e,t)})},rename:function(e,t){var n=this,r;if(e.nodeName!=t.toUpperCase()){r=n.create(t);u(n.getAttribs(e),function(t){n.setAttrib(r,t.nodeName,n.getAttrib(e,t.nodeName))});n.replace(r,e,1)}return r||e},findCommonAncestor:function(e,t){var n=e,r;while(n){r=t;while(r&&n!=r){r=r.parentNode}if(n==r){break}n=n.parentNode}if(!n&&e.ownerDocument){return e.ownerDocument.documentElement}return n},toHex:function(e){return this.styles.toHex(a.trim(e))},run:function(e,t,n){var r=this,i;if(typeof e==="string"){e=r.get(e)}if(!e){return false}n=n||this;if(!e.nodeType&&(e.length||e.length===0)){i=[];u(e,function(e,s){if(e){if(typeof e=="string"){e=r.get(e)}i.push(t.call(n,e,s))}});return i}return t.call(n,e)},getAttribs:function(e){var t;e=this.get(e);if(!e){return[]}if(m){t=[];if(e.nodeName=="OBJECT"){return e.attributes}if(e.nodeName==="OPTION"&&this.getAttrib(e,"selected")){t.push({specified:1,nodeName:"selected"})}var n=/<\/?[\w:\-]+ ?|=[\"][^\"]+\"|=\'[^\']+\'|=[\w\-]+|>/gi;e.cloneNode(false).outerHTML.replace(n,"").replace(/[\w:\-]+/gi,function(e){t.push({specified:1,nodeName:e})});return t}return e.attributes},isEmpty:function(e,t){var n=this,i,s,o,a,l,u=0;e=e.firstChild;if(e){a=new r(e,e.parentNode);t=t||n.schema?n.schema.getNonEmptyElements():null;do{o=e.nodeType;if(o===1){if(e.getAttribute("data-mce-bogus")){continue}l=e.nodeName.toLowerCase();if(t&&t[l]){if(l==="br"){u++;continue}return false}s=n.getAttribs(e);i=s.length;while(i--){l=s[i].nodeName;if(l==="name"||l==="data-mce-bookmark"){return false}}}if(o==8){return false}if(o===3&&!y.test(e.nodeValue)){return false}}while(e=a.next())}return u<=1},createRng:function(){var e=this.doc;return e.createRange?e.createRange():new i(this)},nodeIndex:function(e,t){var n=0,r,i;if(e){for(r=e.nodeType,e=e.previousSibling;e;e=e.previousSibling){i=e.nodeType;if(t&&i==3){if(i==r||!e.nodeValue.length){continue}}n++;r=i}}return n},split:function(e,t,n){var r=this,i=r.createRng(),s,o,a;function l(e){var t,n=e.childNodes,i=e.nodeType;function s(e){var t=e.previousSibling&&e.previousSibling.nodeName=="SPAN";var n=e.nextSibling&&e.nextSibling.nodeName=="SPAN";return t&&n}if(i==1&&e.getAttribute("data-mce-type")=="bookmark"){return}for(t=n.length-1;t>=0;t--){l(n[t])}if(i!=9){if(i==3&&e.nodeValue.length>0){var o=d(e.nodeValue).length;if(!r.isBlock(e.parentNode)||o>0||o===0&&s(e)){return}}else if(i==1){n=e.childNodes;if(n.length==1&&n[0]&&n[0].nodeType==1&&n[0].getAttribute("data-mce-type")=="bookmark"){e.parentNode.insertBefore(n[0],e)}if(n.length||/^(br|hr|input|img)$/i.test(e.nodeName)){return}}r.remove(e)}return e}if(e&&t){i.setStart(e.parentNode,r.nodeIndex(e));i.setEnd(t.parentNode,r.nodeIndex(t));s=i.extractContents();i=r.createRng();i.setStart(t.parentNode,r.nodeIndex(t)+1);i.setEnd(e.parentNode,r.nodeIndex(e)+1);o=i.extractContents();a=e.parentNode;a.insertBefore(l(s),e);if(n){a.replaceChild(n,t)}else{a.insertBefore(t,e)}a.insertBefore(l(o),e);r.remove(e);return n||t}},bind:function(e,t,n,r){var i=this;if(a.isArray(e)){var s=e.length;while(s--){e[s]=i.bind(e[s],t,n,r)}return e}if(i.settings.collect&&(e===i.doc||e===i.win)){i.boundEvents.push([e,t,n,r])}return i.events.bind(e,t,n,r||i)},unbind:function(e,t,n){var r=this,i;if(a.isArray(e)){i=e.length;while(i--){e[i]=r.unbind(e[i],t,n)}return e}if(r.boundEvents&&(e===r.doc||e===r.win)){i=r.boundEvents.length;while(i--){var s=r.boundEvents[i];if(e==s[0]&&(!t||t==s[1])&&(!n||n==s[2])){this.events.unbind(s[0],s[1],s[2])}}}return this.events.unbind(e,t,n)},fire:function(e,t,n){return this.events.fire(e,t,n)},getContentEditable:function(e){var t;if(!e||e.nodeType!=1){return null}t=e.getAttribute("data-mce-contenteditable");if(t&&t!=="inherit"){return t}return e.contentEditable!=="inherit"?e.contentEditable:null},getContentEditableParent:function(e){var t=this.getRoot(),n=null;for(;e&&e!==t;e=e.parentNode){n=this.getContentEditable(e);if(n!==null){break}}return n},destroy:function(){var t=this;if(t.boundEvents){var n=t.boundEvents.length;while(n--){var r=t.boundEvents[n];this.events.unbind(r[0],r[1],r[2])}t.boundEvents=null}if(e.setDocument){e.setDocument()}t.win=t.doc=t.root=t.events=t.frag=null},isChildOf:function(e,t){while(e){if(t===e){return true}e=e.parentNode}return false},dumpRng:function(e){return"startContainer: "+e.startContainer.nodeName+", startOffset: "+e.startOffset+", endContainer: "+e.endContainer.nodeName+", endOffset: "+e.endOffset},_findSib:function(e,t,n){var r=this,i=t;if(e){if(typeof i=="string"){i=function(e){return r.is(e,t)}}for(e=e[n];e;e=e[n]){if(i(e)){return e}}}return null}};b.DOM=new b(document);return b});