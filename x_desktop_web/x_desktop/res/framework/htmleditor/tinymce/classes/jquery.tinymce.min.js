(function(e){var t,n,i=[],r=window;e.fn.tinymce=function(t){var c=this,f,l,o,u="",s;if(!c.length){return c}if(!t){return window.tinymce?tinymce.get(c[0].id):null}c.css("visibility","hidden");function p(){var n=[],i=0;if(!s){a();s=true}c.each(function(e,r){var a,f=r.id,l=t.oninit;if(!f){r.id=f=tinymce.DOM.uniqueId()}if(tinymce.get(f)){return}a=new tinymce.Editor(f,t,tinymce.EditorManager);n.push(a);a.on("init",function(){var e,t=l;c.css("visibility","");if(l){if(++i==n.length){if(typeof t==="string"){e=t.indexOf(".")===-1?null:tinymce.resolve(t.replace(/\.\w+$/,""));t=tinymce.resolve(t)}t.apply(e||tinymce,n)}}})});e.each(n,function(e,t){t.render()})}if(!r.tinymce&&!n&&(f=t.script_url)){n=1;l=f.substring(0,f.lastIndexOf("/"));if(f.indexOf(".min")!=-1){u=".min"}r.tinymce=r.tinyMCEPreInit||{base:l,suffix:u};if(f.indexOf("gzip")!=-1){o=t.language||"en";f=f+(/\?/.test(f)?"&":"?")+"js=true&core=true&suffix="+escape(u)+"&themes="+escape(t.theme||"modern")+"&plugins="+escape(t.plugins||"")+"&languages="+(o||"");if(!r.tinyMCE_GZ){r.tinyMCE_GZ={start:function(){function n(e){tinymce.ScriptLoader.markDone(tinymce.baseURI.toAbsolute(e))}n("langs/"+o+".js");n("themes/"+t.theme+"/theme"+u+".js");n("themes/"+t.theme+"/langs/"+o+".js");e.each(t.plugins.split(","),function(e,t){if(t){n("plugins/"+t+"/plugin"+u+".js");n("plugins/"+t+"/langs/"+o+".js")}})},end:function(){}}}}var m=document.createElement("script");m.type="text/javascript";m.onload=m.onreadystatechange=function(r){r=r||window.event;if(n!==2&&(r.type=="load"||/complete|loaded/.test(m.readyState))){tinymce.dom.Event.domLoaded=1;n=2;if(t.script_loaded){t.script_loaded()}p();e.each(i,function(e,t){t()})}};m.src=f;document.body.appendChild(m)}else{if(n===1){i.push(p)}else{p()}}return c};e.extend(e.expr[":"],{tinymce:function(e){return!!(e.id&&"tinymce"in window&&tinymce.get(e.id))}});function a(){function n(e){if(e==="remove"){this.each(function(e,t){var n=a(t);if(n){n.remove()}})}this.find("span.mceEditor,div.mceEditor").each(function(e,t){var n=tinymce.get(t.id.replace(/_parent$/,""));if(n){n.remove()}})}function i(e){var t=this,i;if(e!=null){n.call(t);t.each(function(t,n){var i;if(i=tinymce.get(n.id)){i.setContent(e)}})}else if(t.length>0){if(i=tinymce.get(t[0].id)){return i.getContent()}}}function a(e){var t=null;if(e&&e.id&&r.tinymce){t=tinymce.get(e.id)}return t}function c(e){return!!(e&&e.length&&r.tinymce&&e.is(":tinymce"))}var f={};e.each(["text","html","val"],function(n,r){var l=f[r]=e.fn[r],o=r==="text";e.fn[r]=function(n){var r=this;if(!c(r)){return l.apply(r,arguments)}if(n!==t){i.call(r.filter(":tinymce"),n);l.apply(r.not(":tinymce"),arguments);return r}else{var f="";var u=arguments;(o?r:r.eq(0)).each(function(t,n){var i=a(n);if(i){f+=o?i.getContent().replace(/<(?:"[^"]*"|'[^']*'|[^'">])*>/g,""):i.getContent({save:true})}else{f+=l.apply(e(n),u)}});return f}}});e.each(["append","prepend"],function(n,i){var r=f[i]=e.fn[i],l=i==="prepend";e.fn[i]=function(e){var n=this;if(!c(n)){return r.apply(n,arguments)}if(e!==t){n.filter(":tinymce").each(function(t,n){var i=a(n);if(i){i.setContent(l?e+i.getContent():i.getContent()+e)}});r.apply(n.not(":tinymce"),arguments);return n}}});e.each(["remove","replaceWith","replaceAll","empty"],function(t,i){var r=f[i]=e.fn[i];e.fn[i]=function(){n.call(this,i);return r.apply(this,arguments)}});f.attr=e.fn.attr;e.fn.attr=function(n,r){var l=this,o=arguments;if(!n||n!=="value"||!c(l)){if(r!==t){return f.attr.apply(l,o)}else{return f.attr.apply(l,o)}}if(r!==t){i.call(l.filter(":tinymce"),r);f.attr.apply(l.not(":tinymce"),o);return l}else{var u=l[0],s=a(u);return s?s.getContent({save:true}):f.attr.apply(e(u),o)}}}})(jQuery);