define("tinymce/Formatter",["tinymce/dom/TreeWalker","tinymce/dom/RangeUtils","tinymce/util/Tools","tinymce/fmt/Preview"],function(e,t,n,i){return function(r){var o={},l=r.dom,f=r.selection,a=new t(l),s=r.schema.isValidChild,d=l.isBlock,u=r.settings.forced_root_block,c=l.nodeIndex,p="\ufeff",h=/^(src|href|style)$/,g=false,m=true,v,y,b=l.getContentEditable,N,k;var C=n.each,T=n.grep,x=n.walk,S=n.extend;function w(e){if(e.nodeType){e=e.nodeName}return!!r.schema.getTextBlockElements()[e.toLowerCase()]}function A(e,t){return l.getParents(e,t,l.getRoot())}function B(e){return e.nodeType===1&&e.id==="_mce_caret"}function _(){V({valigntop:[{selector:"td,th",styles:{verticalAlign:"top"}}],valignmiddle:[{selector:"td,th",styles:{verticalAlign:"middle"}}],valignbottom:[{selector:"td,th",styles:{verticalAlign:"bottom"}}],alignleft:[{selector:"figure,p,h1,h2,h3,h4,h5,h6,td,th,tr,div,ul,ol,li",styles:{textAlign:"left"},defaultBlock:"div"},{selector:"img,table",collapsed:false,styles:{float:"left"}}],aligncenter:[{selector:"figure,p,h1,h2,h3,h4,h5,h6,td,th,tr,div,ul,ol,li",styles:{textAlign:"center"},defaultBlock:"div"},{selector:"img",collapsed:false,styles:{display:"block",marginLeft:"auto",marginRight:"auto"}},{selector:"table",collapsed:false,styles:{marginLeft:"auto",marginRight:"auto"}}],alignright:[{selector:"figure,p,h1,h2,h3,h4,h5,h6,td,th,tr,div,ul,ol,li",styles:{textAlign:"right"},defaultBlock:"div"},{selector:"img,table",collapsed:false,styles:{float:"right"}}],alignjustify:[{selector:"figure,p,h1,h2,h3,h4,h5,h6,td,th,tr,div,ul,ol,li",styles:{textAlign:"justify"},defaultBlock:"div"}],bold:[{inline:"strong",remove:"all"},{inline:"span",styles:{fontWeight:"bold"}},{inline:"b",remove:"all"}],italic:[{inline:"em",remove:"all"},{inline:"span",styles:{fontStyle:"italic"}},{inline:"i",remove:"all"}],underline:[{inline:"span",styles:{textDecoration:"underline"},exact:true},{inline:"u",remove:"all"}],strikethrough:[{inline:"span",styles:{textDecoration:"line-through"},exact:true},{inline:"strike",remove:"all"}],forecolor:{inline:"span",styles:{color:"%value"},wrap_links:false},hilitecolor:{inline:"span",styles:{backgroundColor:"%value"},wrap_links:false},fontname:{inline:"span",styles:{fontFamily:"%value"}},fontsize:{inline:"span",styles:{fontSize:"%value"}},fontsize_class:{inline:"span",attributes:{class:"%value"}},blockquote:{block:"blockquote",wrapper:1,remove:"all"},subscript:{inline:"sub"},superscript:{inline:"sup"},code:{inline:"code"},link:{inline:"a",selector:"a",remove:"all",split:true,deep:true,onmatch:function(){return true},onformat:function(e,t,n){C(n,function(t,n){l.setAttrib(e,n,t)})}},removeformat:[{selector:"b,strong,em,i,font,u,strike,sub,sup,dfn,code,samp,kbd,var,cite,mark,q",remove:"all",split:true,expand:false,block_expand:true,deep:true},{selector:"span",attributes:["style","class"],remove:"empty",split:true,expand:false,deep:true},{selector:"*",attributes:["style","class"],split:false,expand:false,deep:true}]});C("p h1 h2 h3 h4 h5 h6 div address pre div dt dd samp".split(/\s/),function(e){V(e,{block:e,remove:"all"})});V(r.settings.formats)}function R(){r.addShortcut("ctrl+b","bold_desc","Bold");r.addShortcut("ctrl+i","italic_desc","Italic");r.addShortcut("ctrl+u","underline_desc","Underline");for(var e=1;e<=6;e++){r.addShortcut("ctrl+"+e,"",["FormatBlock",false,"h"+e])}r.addShortcut("ctrl+7","",["FormatBlock",false,"p"]);r.addShortcut("ctrl+8","",["FormatBlock",false,"div"]);r.addShortcut("ctrl+9","",["FormatBlock",false,"address"])}function O(e){return e?o[e]:o}function V(e,t){if(e){if(typeof e!=="string"){C(e,function(e,t){V(t,e)})}else{t=t.length?t:[t];C(t,function(e){if(e.deep===y){e.deep=!e.selector}if(e.split===y){e.split=!e.selector||e.inline}if(e.remove===y&&e.selector&&!e.inline){e.remove="none"}if(e.selector&&e.inline){e.mixed=true;e.block_expand=true}if(typeof e.classes==="string"){e.classes=e.classes.split(/\s+/)}});o[e]=t}}}function P(e){var t;r.dom.getParent(e,function(e){t=r.dom.getStyle(e,"text-decoration");return t&&t!=="none"});return t}function E(e){var t;if(e.nodeType===1&&e.parentNode&&e.parentNode.nodeType===1){t=P(e.parentNode);if(r.dom.getStyle(e,"color")&&t){r.dom.setStyle(e,"text-decoration",t)}else if(r.dom.getStyle(e,"textdecoration")===t){r.dom.setStyle(e,"text-decoration",null)}}}function L(t,n,i){var o=O(t),c=o[0],p,h,v=!i&&f.isCollapsed();function y(e,t){t=t||c;if(e){if(t.onformat){t.onformat(e,t,n,i)}C(t.styles,function(t,i){l.setStyle(e,i,Y(t,n))});if(t.styles){var r=l.getAttrib(e,"style");if(r){e.setAttribute("data-mce-style",r)}}C(t.attributes,function(t,i){l.setAttrib(e,i,Y(t,n))});C(t.classes,function(t){t=Y(t,n);if(!l.hasClass(e,t)){l.addClass(e,t)}})}}function N(){function t(t,n){var r=new e(n);for(i=r.current();i;i=r.prev()){if(i.childNodes.length>1||i==t||i.tagName=="BR"){return i}}}var n=r.selection.getRng();var o=n.startContainer;var l=n.endContainer;if(o!=l&&n.endOffset===0){var f=t(o,l);var a=f.nodeType==3?f.length:f.childNodes.length;n.setEnd(f,a)}return n}function k(e,t,n,i,r){var o=[],f=-1,a,s=-1,d=-1,u;C(e.childNodes,function(e,t){if(e.nodeName==="UL"||e.nodeName==="OL"){f=t;a=e;return false}});C(e.childNodes,function(e,n){if(e.nodeName==="SPAN"&&l.getAttrib(e,"data-mce-type")=="bookmark"){if(e.id==t.id+"_start"){s=n}else if(e.id==t.id+"_end"){d=n}}});if(f<=0||s<f&&d>f){C(T(e.childNodes),r);return 0}else{u=l.clone(n,g);C(T(e.childNodes),function(e,t){if(s<f&&t<f||s>f&&t>f){o.push(e);e.parentNode.removeChild(e)}});if(s<f){e.insertBefore(u,a)}else if(s>f){e.insertBefore(u,a.nextSibling)}i.push(u);C(o,function(e){u.appendChild(e)});return u}}function S(e,i,r){var f=[],u,p,h=true;u=c.inline||c.block;p=l.create(u);y(p);a.walk(e,function(e){var a;function m(e){var N,x,S,A,_;_=h;N=e.nodeName.toLowerCase();x=e.parentNode.nodeName.toLowerCase();if(e.nodeType===1&&b(e)){_=h;h=b(e)==="true";A=true}if(j(N,"br")){a=0;if(c.block){l.remove(e)}return}if(c.wrapper&&$(e,t,n)){a=0;return}if(h&&!A&&c.block&&!c.wrapper&&w(N)&&s(x,u)){e=l.rename(e,u);y(e);f.push(e);a=0;return}if(c.selector){C(o,function(t){if("collapsed"in t&&t.collapsed!==v){return}if(l.is(e,t.selector)&&!B(e)){y(e,t);S=true}});if(!c.inline||S){a=0;return}}if(h&&!A&&s(u,N)&&s(x,u)&&!(!r&&e.nodeType===3&&e.nodeValue.length===1&&e.nodeValue.charCodeAt(0)===65279)&&!B(e)&&(!c.inline||!d(e))){if(!a){a=l.clone(p,g);e.parentNode.insertBefore(a,e);f.push(a)}a.appendChild(e)}else if(N=="li"&&i){a=k(e,i,p,f,m)}else{a=0;C(T(e.childNodes),m);if(A){h=_}a=0}}C(e,m)});if(c.wrap_links===false){C(f,function(e){function t(e){var n,i,r;if(e.nodeName==="A"){i=l.clone(p,g);f.push(i);r=T(e.childNodes);for(n=0;n<r.length;n++){i.appendChild(r[n])}e.appendChild(i)}C(T(e.childNodes),t)}t(e)})}C(f,function(e){var i;function r(e){var t=0;C(e.childNodes,function(e){if(!J(e)&&!te(e)){t++}});return t}function a(e){var t,n;C(e.childNodes,function(e){if(e.nodeType==1&&!te(e)&&!B(e)){t=e;return g}});if(t&&!te(t)&&W(t,c)){n=l.clone(t,g);y(n);l.replace(n,e,m);l.remove(t,1)}return n||e}i=r(e);if((f.length>1||!d(e))&&i===0){l.remove(e,1);return}if(c.inline||c.wrapper){if(!c.exact&&i===1){e=a(e)}C(o,function(t){C(l.select(t.inline,e),function(e){var i;if(te(e)){return}if(t.wrap_links===false){i=e.parentNode;do{if(i.nodeName==="A"){return}}while(i=i.parentNode)}X(t,n,e,t.exact?e:null)})});if($(e.parentNode,t,n)){l.remove(e,1);e=0;return m}if(c.merge_with_parents){l.getParent(e.parentNode,function(i){if($(i,t,n)){l.remove(e,1);e=0;return m}})}if(e&&c.merge_siblings!==false){e=ne(ee(e),e);e=ne(e,ee(e,m))}}})}if(c){if(i){if(i.nodeType){h=l.createRng();h.setStartBefore(i);h.setEndAfter(i);S(Q(h,o),null,true)}else{S(i,null,true)}}else{if(!v||!c.inline||l.select("td.mce-item-selected,th.mce-item-selected").length){var A=r.selection.getNode();if(!u&&o[0].defaultBlock&&!l.getParent(A,l.isBlock)){L(o[0].defaultBlock)}r.selection.setRng(N());p=f.getBookmark();S(Q(f.getRng(m),o),p);if(c.styles&&(c.styles.color||c.styles.textDecoration)){x(A,E,"childNodes");E(A)}f.moveToBookmark(p);oe(f.getRng(m));r.nodeChanged()}else{re("apply",t,n)}}}}function D(e,t,n){var i=O(e),o=i[0],s,u,p=true;function h(e){var n,r,l,f,a;if(e.nodeType===1&&b(e)){f=p;p=b(e)==="true";a=true}n=T(e.childNodes);if(p&&!a){for(r=0,l=i.length;r<l;r++){if(X(i[r],t,e,e)){break}}}if(o.deep){if(n.length){for(r=0,l=n.length;r<l;r++){h(n[r])}if(a){p=f}}}}function v(n){var i;C(A(n.parentNode).reverse(),function(n){var r;if(!i&&n.id!="_start"&&n.id!="_end"){r=$(n,e,t);if(r&&r.split!==false){i=n}}});return i}function y(e,n,r,f){var a,s,u,c,p,h;if(e){h=e.parentNode;for(a=n.parentNode;a&&a!=h;a=a.parentNode){s=l.clone(a,g);for(p=0;p<i.length;p++){if(X(i[p],t,s,s)){s=0;break}}if(s){if(u){s.appendChild(u)}if(!c){c=s}u=s}}if(f&&(!o.mixed||!d(e))){n=l.split(e,n)}if(u){r.parentNode.insertBefore(u,r);c.appendChild(r)}}return n}function N(e){return y(v(e),e,e,true)}function k(e){var t=l.get(e?"_start":"_end"),n=t[e?"firstChild":"lastChild"];if(te(n)){n=n[e?"firstChild":"lastChild"]}l.remove(t,true);return n}function x(e){var t,n;var l=e.commonAncestorContainer;e=Q(e,i,m);if(o.split){t=ie(e,m);n=ie(e);if(t!=n){if(/^(TR|TH|TD)$/.test(t.nodeName)&&t.firstChild){if(t.nodeName=="TR"){t=t.firstChild.firstChild||t}else{t=t.firstChild||t}}if(l&&/^T(HEAD|BODY|FOOT|R)$/.test(l.nodeName)&&/^(TH|TD)$/.test(n.nodeName)&&n.firstChild){n=n.firstChild||n}t=K(t,"span",{id:"_start","data-mce-type":"bookmark"});n=K(n,"span",{id:"_end","data-mce-type":"bookmark"});N(t);N(n);t=k(m);n=k()}else{t=n=N(t)}e.startContainer=t.parentNode;e.startOffset=c(t);e.endContainer=n.parentNode;e.endOffset=c(n)+1}a.walk(e,function(e){C(e,function(e){h(e);if(e.nodeType===1&&r.dom.getStyle(e,"text-decoration")==="underline"&&e.parentNode&&P(e.parentNode)==="underline"){X({deep:false,exact:true,inline:"span",styles:{textDecoration:"underline"}},null,e)}})})}if(n){if(n.nodeType){u=l.createRng();u.setStartBefore(n);u.setEndAfter(n);x(u)}else{x(n)}return}if(!f.isCollapsed()||!o.inline||l.select("td.mce-item-selected,th.mce-item-selected").length){s=f.getBookmark();x(f.getRng(m));f.moveToBookmark(s);if(o.inline&&H(e,t,f.getStart())){oe(f.getRng(true))}r.nodeChanged()}else{re("remove",e,t)}}function F(e,t,n){var i=O(e);if(H(e,t,n)&&(!("toggle"in i[0])||i[0].toggle)){D(e,t,n)}else{L(e,t,n)}}function $(e,t,n,i){var r=O(t),o,f,a;function s(e,t,r){var o,f,a=t[r],s;if(t.onmatch){return t.onmatch(e,t,r)}if(a){if(a.length===y){for(o in a){if(a.hasOwnProperty(o)){if(r==="attributes"){f=l.getAttrib(e,o)}else{f=G(e,o)}if(i&&!f&&!t.exact){return}if((!i||t.exact)&&!j(f,M(Y(a[o],n),o))){return}}}}else{for(s=0;s<a.length;s++){if(r==="attributes"?l.getAttrib(e,a[s]):G(e,a[s])){return t}}}}return t}if(r&&e){for(f=0;f<r.length;f++){o=r[f];if(W(e,o)&&s(e,o,"attributes")&&s(e,o,"styles")){if(a=o.classes){for(f=0;f<a.length;f++){if(!l.hasClass(e,a[f])){return}}}return o}}}}function H(e,t,n){var i;function r(n){var i=l.getRoot();if(n===i){return false}n=l.getParent(n,function(n){return n.parentNode===i||!!$(n,e,t,true)});return $(n,e,t)}if(n){return r(n)}n=f.getNode();if(r(n)){return m}i=f.getStart();if(i!=n){if(r(i)){return m}}return g}function I(e,t){var n,i=[],r={};n=f.getStart();l.getParent(n,function(n){var o,l;for(o=0;o<e.length;o++){l=e[o];if(!r[l]&&$(n,l,t)){r[l]=true;i.push(l)}}},l.getRoot());return i}function q(e){var t=O(e),n,i,r,o,a;if(t){n=f.getStart();i=A(n);for(o=t.length-1;o>=0;o--){a=t[o].selector;if(!a||t[o].defaultBlock){return m}for(r=i.length-1;r>=0;r--){if(l.is(i[r],a)){return m}}}}return g}function z(e,t,n){var i;if(!v){v={};i={};r.on("NodeChange",function(e){var t=A(e.element),n={};C(v,function(e,r){C(t,function(o){if($(o,r,{},e.similar)){if(!i[r]){C(e,function(e){e(true,{node:o,format:r,parents:t})});i[r]=e}n[r]=e;return false}})});C(i,function(r,o){if(!n[o]){delete i[o];C(r,function(n){n(false,{node:e.element,format:o,parents:t})})}})})}C(e.split(","),function(e){if(!v[e]){v[e]=[];v[e].similar=n}v[e].push(t)});return this}function U(e){return i.getCssText(r,e)}S(this,{get:O,register:V,apply:L,remove:D,toggle:F,match:H,matchAll:I,matchNode:$,canApply:q,formatChanged:z,getCssText:U});_();R();r.on("BeforeGetContent",function(){if(k){k()}});r.on("mouseup keydown",function(e){if(N){N(e)}});function W(e,t){if(j(e,t.inline)){return m}if(j(e,t.block)){return m}if(t.selector){return e.nodeType==1&&l.is(e,t.selector)}}function j(e,t){e=e||"";t=t||"";e=""+(e.nodeName||e);t=""+(t.nodeName||t);return e.toLowerCase()==t.toLowerCase()}function G(e,t){return M(l.getStyle(e,t),t)}function M(e,t){if(t=="color"||t=="backgroundColor"){e=l.toHex(e)}if(t=="fontWeight"&&e==700){e="bold"}if(t=="fontFamily"){e=e.replace(/[\'\"]/g,"").replace(/,\s+/g,",")}return""+e}function Y(e,t){if(typeof e!="string"){e=e(t)}else if(t){e=e.replace(/%(\w+)/g,function(e,n){return t[n]||e})}return e}function J(e){return e&&e.nodeType===3&&/^([\t \r\n]+|)$/.test(e.nodeValue)}function K(e,t,n){var i=l.create(t,n);e.parentNode.insertBefore(i,e);i.appendChild(e);return i}function Q(t,n,i){var o,f,a,s=t.startContainer,u=t.startOffset,p=t.endContainer,h=t.endOffset;function m(e){var t,i,r,o,f;t=i=e?s:p;o=e?"previousSibling":"nextSibling";f=l.getRoot();function a(e){return e.nodeName=="BR"&&e.getAttribute("data-mce-bogus")&&!e.nextSibling}if(t.nodeType==3&&!J(t)){if(e?u>0:h<t.nodeValue.length){return t}}while(true){if(!n[0].block_expand&&d(i)){return i}for(r=i[o];r;r=r[o]){if(!te(r)&&!J(r)&&!a(r)){return i}}if(i.parentNode==f){t=i;break}i=i.parentNode}return t}function v(e,t){if(t===y){t=e.nodeType===3?e.length:e.childNodes.length}while(e&&e.hasChildNodes()){e=e.childNodes[t];if(e){t=e.nodeType===3?e.length:e.childNodes.length}}return{node:e,offset:t}}if(s.nodeType==1&&s.hasChildNodes()){o=s.childNodes.length-1;s=s.childNodes[u>o?o:u];if(s.nodeType==3){u=0}}if(p.nodeType==1&&p.hasChildNodes()){o=p.childNodes.length-1;p=p.childNodes[h>o?o:h-1];if(p.nodeType==3){h=p.nodeValue.length}}function N(e){var t=e;while(t){if(t.nodeType===1&&b(t)){return b(t)==="false"?t:e}t=t.parentNode}return e}function k(t,n,o){var f,a,s,u;function c(e,t){var n,r,l=e.nodeValue;if(typeof t=="undefined"){t=o?l.length:0}if(o){n=l.lastIndexOf(" ",t);r=l.lastIndexOf(" ",t);n=n>r?n:r;if(n!==-1&&!i){n++}}else{n=l.indexOf(" ",t);r=l.indexOf(" ",t);n=n!==-1&&(r===-1||n<r)?n:r}return n}if(t.nodeType===3){s=c(t,n);if(s!==-1){return{container:t,offset:s}}u=t}f=new e(t,l.getParent(t,d)||r.getBody());while(a=f[o?"prev":"next"]()){if(a.nodeType===3){u=a;s=c(a);if(s!==-1){return{container:a,offset:s}}}else if(d(a)){break}}if(u){if(o){n=0}else{n=u.length}return{container:u,offset:n}}}function C(e,i){var r,o,f,a;if(e.nodeType==3&&e.nodeValue.length===0&&e[i]){e=e[i]}r=A(e);for(o=0;o<r.length;o++){for(f=0;f<n.length;f++){a=n[f];if("collapsed"in a&&a.collapsed!==t.collapsed){continue}if(l.is(r[o],a.selector)){return r[o]}}}return e}function T(e,t){var i,r=l.getRoot();if(!n[0].wrapper){i=l.getParent(e,n[0].block,r)}if(!i){i=l.getParent(e.nodeType==3?e.parentNode:e,function(e){return e!=r&&w(e)})}if(i&&n[0].wrapper){i=A(i,"ul,ol").reverse()[0]||i}if(!i){i=e;while(i[t]&&!d(i[t])){i=i[t];if(j(i,"br")){break}}}return i||e}s=N(s);p=N(p);if(te(s.parentNode)||te(s)){s=te(s)?s:s.parentNode;s=s.nextSibling||s;if(s.nodeType==3){u=0}}if(te(p.parentNode)||te(p)){p=te(p)?p:p.parentNode;p=p.previousSibling||p;if(p.nodeType==3){h=p.length}}if(n[0].inline){if(t.collapsed){a=k(s,u,true);if(a){s=a.container;u=a.offset}a=k(p,h);if(a){p=a.container;h=a.offset}}f=v(p,h);if(f.node){while(f.node&&f.offset===0&&f.node.previousSibling){f=v(f.node.previousSibling)}if(f.node&&f.offset>0&&f.node.nodeType===3&&f.node.nodeValue.charAt(f.offset-1)===" "){if(f.offset>1){p=f.node;p.splitText(f.offset-1)}}}}if(n[0].inline||n[0].block_expand){if(!n[0].inline||(s.nodeType!=3||u===0)){s=m(true)}if(!n[0].inline||(p.nodeType!=3||h===p.nodeValue.length)){p=m()}}if(n[0].selector&&n[0].expand!==g&&!n[0].inline){s=C(s,"previousSibling");p=C(p,"nextSibling")}if(n[0].block||n[0].selector){s=T(s,"previousSibling");p=T(p,"nextSibling");if(n[0].block){if(!d(s)){s=m(true)}if(!d(p)){p=m()}}}if(s.nodeType==1){u=c(s);s=s.parentNode}if(p.nodeType==1){h=c(p)+1;p=p.parentNode}return{startContainer:s,startOffset:u,endContainer:p,endOffset:h}}function X(e,t,n,i){var r,o,f;if(!W(n,e)){return g}if(e.remove!="all"){C(e.styles,function(e,r){e=M(Y(e,t),r);if(typeof r==="number"){r=e;i=0}if(!i||j(G(i,r),e)){l.setStyle(n,r,"")}f=1});if(f&&l.getAttrib(n,"style")===""){n.removeAttribute("style");n.removeAttribute("data-mce-style")}C(e.attributes,function(e,r){var o;e=Y(e,t);if(typeof r==="number"){r=e;i=0}if(!i||j(l.getAttrib(i,r),e)){if(r=="class"){e=l.getAttrib(n,r);if(e){o="";C(e.split(/\s+/),function(e){if(/mce\w+/.test(e)){o+=(o?" ":"")+e}});if(o){l.setAttrib(n,r,o);return}}}if(r=="class"){n.removeAttribute("className")}if(h.test(r)){n.removeAttribute("data-mce-"+r)}n.removeAttribute(r)}});C(e.classes,function(e){e=Y(e,t);if(!i||l.hasClass(i,e)){l.removeClass(n,e)}});o=l.getAttribs(n);for(r=0;r<o.length;r++){if(o[r].nodeName.indexOf("_")!==0){return g}}}if(e.remove!="none"){Z(n,e);return m}}function Z(e,t){var n=e.parentNode,i;function o(e,t,n){e=ee(e,t,n);return!e||(e.nodeName=="BR"||d(e))}if(t.block){if(!u){if(d(e)&&!d(n)){if(!o(e,g)&&!o(e.firstChild,m,1)){e.insertBefore(l.create("br"),e.firstChild)}if(!o(e,m)&&!o(e.lastChild,g,1)){e.appendChild(l.create("br"))}}}else{if(n==l.getRoot()){if(!t.list_block||!j(e,t.list_block)){C(T(e.childNodes),function(e){if(s(u,e.nodeName.toLowerCase())){if(!i){i=K(e,u);l.setAttribs(i,r.settings.forced_root_block_attrs)}else{i.appendChild(e)}}else{i=0}})}}}}if(t.selector&&t.inline&&!j(t.inline,e)){return}l.remove(e,1)}function ee(e,t,n){if(e){t=t?"nextSibling":"previousSibling";for(e=n?e:e[t];e;e=e[t]){if(e.nodeType==1||!J(e)){return e}}}}function te(e){return e&&e.nodeType==1&&e.getAttribute("data-mce-type")=="bookmark"}function ne(e,t){var n,i;function r(e,t){if(e.nodeName!=t.nodeName){return g}function n(e){var t={};C(l.getAttribs(e),function(n){var i=n.nodeName.toLowerCase();if(i.indexOf("_")!==0&&i!=="style"&&i!=="data-mce-style"){t[i]=l.getAttrib(e,i)}});return t}function i(e,t){var n,i;for(i in e){if(e.hasOwnProperty(i)){n=t[i];if(n===y){return g}if(e[i]!=n){return g}delete t[i]}}for(i in t){if(t.hasOwnProperty(i)){return g}}return m}if(!i(n(e),n(t))){return g}if(!i(l.parseStyle(l.getAttrib(e,"style")),l.parseStyle(l.getAttrib(t,"style")))){return g}return!te(e)&&!te(t)}function o(e,t){for(n=e;n;n=n[t]){if(n.nodeType==3&&n.nodeValue.length!==0){return e}if(n.nodeType==1&&!te(n)){return n}}return e}if(e&&t){e=o(e,"previousSibling");t=o(t,"nextSibling");if(r(e,t)){for(n=e.nextSibling;n&&n!=t;){i=n;n=n.nextSibling;e.appendChild(i)}l.remove(t);C(T(t.childNodes),function(t){e.appendChild(t)});return e}}return t}function ie(t,n){var i,o,l;i=t[n?"startContainer":"endContainer"];o=t[n?"startOffset":"endOffset"];if(i.nodeType==1){l=i.childNodes.length-1;if(!n&&o){o--}i=i.childNodes[o>l?l:o]}if(i.nodeType===3&&n&&o>=i.nodeValue.length){i=new e(i,r.getBody()).next()||i}if(i.nodeType===3&&!n&&o===0){i=new e(i,r.getBody()).prev()||i}return i}function re(t,n,i){var o="_mce_caret",s=r.settings.caret_debug;function d(e){var t=l.create("span",{id:o,"data-mce-bogus":true,style:s?"color:red":""});if(e){t.appendChild(r.getDoc().createTextNode(p))}return t}function u(e,t){while(e){if(e.nodeType===3&&e.nodeValue!==p||e.childNodes.length>1){return false}if(t&&e.nodeType===1){t.push(e)}e=e.firstChild}return true}function c(e){while(e){if(e.id===o){return e}e=e.parentNode}}function h(t){var n;if(t){n=new e(t,t);for(t=n.current();t;t=n.next()){if(t.nodeType===3){return t}}}}function g(e,t){var n,i;if(!e){e=c(f.getStart());if(!e){while(e=l.get(o)){g(e,false)}}}else{i=f.getRng(true);if(u(e)){if(t!==false){i.setStartBefore(e);i.setEndBefore(e)}l.remove(e)}else{n=h(e);if(n.nodeValue.charAt(0)===p){n=n.deleteData(0,1)}l.remove(e,1)}f.setRng(i)}}function m(){var e,t,r,o,l,s,u;e=f.getRng(true);o=e.startOffset;s=e.startContainer;u=s.nodeValue;t=c(f.getStart());if(t){r=h(t)}if(u&&o>0&&o<u.length&&/\w/.test(u.charAt(o))&&/\w/.test(u.charAt(o-1))){l=f.getBookmark();e.collapse(true);e=Q(e,O(n));e=a.split(e);L(n,i,e);f.moveToBookmark(l)}else{if(!t||r.nodeValue!==p){t=d(true);r=t.firstChild;e.insertNode(t);o=1;L(n,i,t)}else{L(n,i,t)}f.setCursorLocation(r,o)}}function v(){var e=f.getRng(true),t,r,o,s,u,c,h=[],g,m;t=e.startContainer;r=e.startOffset;u=t;if(t.nodeType==3){if(r!=t.nodeValue.length||t.nodeValue===p){s=true}u=u.parentNode}while(u){if($(u,n,i)){c=u;break}if(u.nextSibling){s=true}h.push(u);u=u.parentNode}if(!c){return}if(s){o=f.getBookmark();e.collapse(true);e=Q(e,O(n),true);e=a.split(e);D(n,i,e);f.moveToBookmark(o)}else{m=d();u=m;for(g=h.length-1;g>=0;g--){u.appendChild(l.clone(h[g],false));u=u.firstChild}u.appendChild(l.doc.createTextNode(p));u=u.firstChild;var v=l.getParent(c,w);if(v&&l.isEmpty(v)){c.parentNode.replaceChild(m,c)}else{l.insertAfter(m,c)}f.setCursorLocation(u,1);if(l.isEmpty(c)){l.remove(c)}}}function y(){var e;e=c(f.getStart());if(e&&!l.isEmpty(e)){x(e,function(e){if(e.nodeType==1&&e.id!==o&&!l.isEmpty(e)){l.setAttrib(e,"data-mce-bogus",null)}},"childNodes")}}if(!r._hasCaretEvents){k=function(){var e=[],t;if(u(c(f.getStart()),e)){t=e.length;while(t--){l.setAttrib(e[t],"data-mce-bogus","1")}}};N=function(e){var t=e.keyCode;g();if(t==8||t==37||t==39){g(c(f.getStart()))}y()};r.on("SetContent",function(e){if(e.selection){y()}});r._hasCaretEvents=true}if(t=="apply"){m()}else{v()}}function oe(t){var n=t.startContainer,i=t.startOffset,r,o,a,s,d;if(n.nodeType==3&&i>=n.nodeValue.length){i=c(n);n=n.parentNode;r=true}if(n.nodeType==1){s=n.childNodes;n=s[Math.min(i,s.length-1)];o=new e(n,l.getParent(n,l.isBlock));if(i>s.length-1||r){o.next()}for(a=o.current();a;a=o.next()){if(a.nodeType==3&&!J(a)){d=l.create("a",null,p);a.parentNode.insertBefore(d,a);t.setStart(a,0);f.setRng(t);l.remove(d);return}}}}}});