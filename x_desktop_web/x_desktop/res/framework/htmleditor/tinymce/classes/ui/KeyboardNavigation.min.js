define("tinymce/ui/KeyboardNavigation",[],function(){"use strict";return function(e){var t=e.root,n,r;n=document.activeElement;r=t.getParentCtrl(n);function i(e){e=e||n;return e&&e.getAttribute("role")}function a(e){var t,r=e||n;while(r=r.parentNode){if(t=i(r)){return t}}}function u(e){var t=n;if(t){return t.getAttribute("aria-"+e)}}function f(e){var t=e.tagName.toUpperCase();return t=="INPUT"||t=="TEXTAREA"}function o(e){if(f(e)&&!e.hidden){return true}if(/^(button|menuitem|checkbox|tab|menuitemcheckbox|option|gridcell)$/.test(i(e))){return true}return false}function c(e){var n=[];function r(e){if(e.nodeType!=1||e.style.display=="none"){return}if(o(e)){n.push(e)}for(var t=0;t<e.childNodes.length;t++){r(e.childNodes[t])}}r(e||t.getEl());return n}function s(e){var t,n;e=e||r;n=e.parents().toArray();n.unshift(e);for(var i=0;i<n.length;i++){t=n[i];if(t.settings.ariaRoot){break}}return t}function l(e){var t=s(e);var n=c(t.getEl());if(t.settings.ariaRemember&&"lastAriaIndex"in t){b(t.lastAriaIndex,n)}else{b(0,n)}}function b(e,t){if(e<0){e=t.length-1}else if(e>=t.length){e=0}if(t[e]){t[e].focus()}return e}function d(e,t){var r=-1,i=s();t=t||c(i.getEl());for(var a=0;a<t.length;a++){if(t[a]===n){r=a}}r+=e;i.lastAriaIndex=b(r,t)}function v(){var e=a();if(e=="tablist"){d(-1,c(n.parentNode))}else if(r.parent().submenu){k()}else{d(-1)}}function g(){var e=i(),t=a();if(t=="tablist"){d(1,c(n.parentNode))}else if(e=="menuitem"&&t=="menu"&&u("haspopup")){y()}else{d(1)}}function p(){d(-1)}function h(){var e=i(),t=a();if(e=="menuitem"&&t=="menubar"){y()}else if(e=="button"&&u("haspopup")){y({key:"down"})}else{d(1)}}function m(e){var t=a();if(t=="tablist"){var n=c(r.getEl("body"))[0];if(n){n.focus()}}else{d(e.shiftKey?-1:1)}}function k(){r.fire("cancel")}function y(e){e=e||{};r.fire("click",{target:n,aria:e})}t.on("keydown",function(e){function t(e,t){if(f(n)){return}if(t(e)!==false){e.preventDefault()}}if(e.isDefaultPrevented()){return}switch(e.keyCode){case 37:t(e,v);break;case 39:t(e,g);break;case 38:t(e,p);break;case 40:t(e,h);break;case 27:k();break;case 14:case 13:case 32:t(e,y);break;case 9:if(m(e)!==false){e.preventDefault()}break}});t.on("focusin",function(e){n=e.target;r=e.control});return{focusFirst:l}}});