define("tinymce/ui/Window",["tinymce/ui/FloatPanel","tinymce/ui/Panel","tinymce/ui/DomUtils","tinymce/ui/DragHelper"],function(e,t,i,a){"use strict";var s=e.extend({modal:true,Defaults:{border:1,layout:"flex",containerCls:"panel",role:"dialog",callbacks:{submit:function(){this.fire("submit",{data:this.toJSON()})},close:function(){this.close()}}},init:function(e){var i=this;i._super(e);if(i.isRtl()){i.addClass("rtl")}i.addClass("window");i._fixed=true;if(e.buttons){i.statusbar=new t({layout:"flex",border:"1 0 0 0",spacing:3,padding:10,align:"center",pack:i.isRtl()?"start":"end",defaults:{type:"button"},items:e.buttons});i.statusbar.addClass("foot");i.statusbar.parent(i)}i.on("click",function(e){if(e.target.className.indexOf(i.classPrefix+"close")!=-1){i.close()}});i.on("cancel",function(){i.close()});i.aria("describedby",i.describedBy||i._id+"-none");i.aria("label",e.title);i._fullscreen=false},recalc:function(){var e=this,t=e.statusbar,a,s,n,r;if(e._fullscreen){e.layoutRect(i.getWindowSize());e.layoutRect().contentH=e.layoutRect().innerH}e._super();a=e.layoutRect();if(e.settings.title&&!e._fullscreen){s=a.headerW;if(s>a.w){n=a.x-Math.max(0,s/2);e.layoutRect({w:s,x:n});r=true}}if(t){t.layoutRect({w:e.layoutRect().innerW}).recalc();s=t.layoutRect().minW+a.deltaW;if(s>a.w){n=a.x-Math.max(0,s-a.w);e.layoutRect({w:s,x:n});r=true}}if(r){e.recalc()}},initLayoutRect:function(){var e=this,t=e._super(),a=0,s;if(e.settings.title&&!e._fullscreen){s=e.getEl("head");var n=i.getSize(s);t.headerW=n.width;t.headerH=n.height;a+=t.headerH}if(e.statusbar){a+=e.statusbar.layoutRect().h}t.deltaH+=a;t.minH+=a;t.h+=a;var r=i.getWindowSize();t.x=Math.max(0,r.w/2-t.w/2);t.y=Math.max(0,r.h/2-t.h/2);return t},renderHtml:function(){var e=this,t=e._layout,i=e._id,a=e.classPrefix;var s=e.settings,n="",r="",l=s.html;e.preRender();t.preRender(e);if(s.title){n='<div id="'+i+'-head" class="'+a+'window-head">'+'<div id="'+i+'-title" class="'+a+'title">'+e.encode(s.title)+"</div>"+'<button type="button" class="'+a+'close" aria-hidden="true">Ã—</button>'+'<div id="'+i+'-dragh" class="'+a+'dragh"></div>'+"</div>"}if(s.url){l='<iframe src="'+s.url+'" tabindex="-1"></iframe>'}if(typeof l=="undefined"){l=t.renderHtml(e)}if(e.statusbar){r=e.statusbar.renderHtml()}return'<div id="'+i+'" class="'+e.classes()+'" hidefocus="1">'+'<div class="'+e.classPrefix+'reset" role="application">'+n+'<div id="'+i+'-body" class="'+e.classes("body")+'">'+l+"</div>"+r+"</div>"+"</div>"},fullscreen:function(e){var t=this,a=document.documentElement,s,n=t.classPrefix,r;if(e!=t._fullscreen){i.on(window,"resize",function(){var e;if(t._fullscreen){if(!s){e=(new Date).getTime();var a=i.getWindowSize();t.moveTo(0,0).resizeTo(a.w,a.h);if((new Date).getTime()-e>50){s=true}}else{if(!t._timer){t._timer=setTimeout(function(){var e=i.getWindowSize();t.moveTo(0,0).resizeTo(e.w,e.h);t._timer=0},50)}}}});r=t.layoutRect();t._fullscreen=e;if(!e){t._borderBox=t.parseBox(t.settings.border);t.getEl("head").style.display="";r.deltaH+=r.headerH;i.removeClass(a,n+"fullscreen");i.removeClass(document.body,n+"fullscreen");t.removeClass("fullscreen");t.moveTo(t._initial.x,t._initial.y).resizeTo(t._initial.w,t._initial.h)}else{t._initial={x:r.x,y:r.y,w:r.w,h:r.h};t._borderBox=t.parseBox("0");t.getEl("head").style.display="none";r.deltaH-=r.headerH+2;i.addClass(a,n+"fullscreen");i.addClass(document.body,n+"fullscreen");t.addClass("fullscreen");var l=i.getWindowSize();t.moveTo(0,0).resizeTo(l.w,l.h)}}return t.reflow()},postRender:function(){var e=this,t;setTimeout(function(){e.addClass("in")},0);e._super();if(e.statusbar){e.statusbar.postRender()}e.focus();this.dragHelper=new a(e._id+"-dragh",{start:function(){t={x:e.layoutRect().x,y:e.layoutRect().y}},drag:function(i){e.moveTo(t.x+i.deltaX,t.y+i.deltaY)}});e.on("submit",function(t){if(!t.isDefaultPrevented()){e.close()}})},submit:function(){return this.fire("submit",{data:this.toJSON()})},remove:function(){var e=this,t=e.classPrefix;e.dragHelper.destroy();e._super();if(e.statusbar){this.statusbar.remove()}if(e._fullscreen){i.removeClass(document.documentElement,t+"fullscreen");i.removeClass(document.body,t+"fullscreen")}},getContentWindow:function(){var e=this.getEl().getElementsByTagName("iframe")[0];return e?e.contentWindow:null}});return s});