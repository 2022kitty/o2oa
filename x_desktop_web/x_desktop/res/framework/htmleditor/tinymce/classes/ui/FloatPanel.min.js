define("tinymce/ui/FloatPanel",["tinymce/ui/Panel","tinymce/ui/Movable","tinymce/ui/Resizable","tinymce/ui/DomUtils"],function(e,i,t,n){"use strict";var o,r,a=[];var l=[],s;var f=e.extend({Mixins:[i,t],init:function(e){var i=this;function t(){var e,t=f.zIndex||65535,o;if(l.length){for(e=0;e<l.length;e++){if(l[e].modal){t++;o=l[e]}l[e].getEl().style.zIndex=t;l[e].zIndex=t;t++}}var r=document.getElementById(i.classPrefix+"modal-block");if(o){n.css(r,"z-index",o.zIndex-1)}else if(r){r.parentNode.removeChild(r);s=false}f.currentZIndex=t}function u(e,i){while(e){if(e==i){return true}e=e.parent()}}function d(e){var i=n.getViewPort().y;function t(i,t){var n;for(var o=0;o<a.length;o++){if(a[o]!=e){n=a[o].parent();while(n&&(n=n.parent())){if(n==e){a[o].fixed(i).moveBy(0,t).repaint()}}}}}if(e.settings.autofix){if(!e._fixed){e._autoFixY=e.layoutRect().y;if(e._autoFixY<i){e.fixed(true).layoutRect({y:0}).repaint();t(true,i-e._autoFixY)}}else{if(e._autoFixY>i){e.fixed(false).layoutRect({y:e._autoFixY}).repaint();t(false,e._autoFixY-i)}}}}i._super(e);i._eventsRoot=i;i.addClass("floatpanel");if(e.autohide){if(!o){o=function(e){var i=a.length;while(i--){var t=a[i],n=t.getParentCtrl(e.target);if(t.settings.autohide){if(n){if(u(n,t)||t.parent()===n){continue}}e=t.fire("autohide",{target:e.target});if(!e.isDefaultPrevented()){t.hide()}}}};n.on(document,"click",o)}a.push(i)}if(e.autofix){if(!r){r=function(){var e;e=a.length;while(e--){d(a[e])}};n.on(window,"scroll",r)}i.on("move",function(){d(this)})}i.on("postrender show",function(e){if(e.control==i){var o,r=i.classPrefix;if(i.modal&&!s){o=n.createFragment('<div id="'+r+'modal-block" class="'+r+"reset "+r+'fade"></div>');o=o.firstChild;i.getContainerElm().appendChild(o);setTimeout(function(){n.addClass(o,r+"in");n.addClass(i.getEl(),r+"in")},0);s=true}l.push(i);t()}});i.on("close hide",function(e){if(e.control==i){var n=l.length;while(n--){if(l[n]===i){l.splice(n,1)}}t()}});i.on("show",function(){i.parents().each(function(e){if(e._fixed){i.fixed(true);return false}})});if(e.popover){i._preBodyHtml='<div class="'+i.classPrefix+'arrow"></div>';i.addClass("popover").addClass("bottom").addClass(i.isRtl()?"end":"start")}},fixed:function(e){var i=this;if(i._fixed!=e){if(i._rendered){var t=n.getViewPort();if(e){i.layoutRect().y-=t.y}else{i.layoutRect().y+=t.y}}i.toggleClass("fixed",e);i._fixed=e}return i},show:function(){var e=this,i,t=e._super();i=a.length;while(i--){if(a[i]===e){break}}if(i===-1){a.push(e)}return t},hide:function(){u(this);return this._super()},hideAll:function(){f.hideAll()},close:function(){var e=this;e.fire("close");return e.remove()},remove:function(){u(this);this._super()},postRender:function(){var e=this;if(e.settings.bodyRole){this.getEl("body").setAttribute("role",e.settings.bodyRole)}return e._super()}});f.hideAll=function(){var e=a.length;while(e--){var i=a[e];if(i&&i.settings.autohide){i.hide();a.splice(e,1)}}};function u(e){var i;i=a.length;while(i--){if(a[i]===e){a.splice(i,1)}}i=l.length;while(i--){if(l[i]===e){l.splice(i,1)}}}return f});