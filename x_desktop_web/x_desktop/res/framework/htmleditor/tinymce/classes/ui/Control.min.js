define("tinymce/ui/Control",["tinymce/util/Class","tinymce/util/Tools","tinymce/ui/Collection","tinymce/ui/DomUtils"],function(e,t,n,i){"use strict";var r=t.makeMap("focusin focusout scroll click dblclick mousedown mouseup mousemove mouseover"+" mouseout mouseenter mouseleave wheel keydown keypress input keyup contextmenu"," ");var o={};var a="onmousewheel"in document;var s=false;var l="mce-";var f=e.extend({Statics:{elementIdCache:o,classPrefix:l},isRtl:function(){return f.rtl},classPrefix:l,init:function(e){var n=this,r,o;n.settings=e=t.extend({},n.Defaults,e);n._id=e.id||i.id();n._text=n._name="";n._width=n._height=0;n._aria={role:e.role};r=e.classes;if(r){r=r.split(" ");r.map={};o=r.length;while(o--){r.map[r[o]]=true}}n._classes=r||[];n.visible(true);t.each("title text width height name classes visible disabled active value".split(" "),function(t){var i=e[t],r;if(i!==r){n[t](i)}else if(n["_"+t]===r){n["_"+t]=false}});n.on("click",function(){if(n.disabled()){return false}});if(e.classes){t.each(e.classes.split(" "),function(e){n.addClass(e)})}n.settings=e;n._borderBox=n.parseBox(e.border);n._paddingBox=n.parseBox(e.padding);n._marginBox=n.parseBox(e.margin);if(e.hidden){n.hide()}},Properties:"parent,title,text,width,height,disabled,active,name,value",Methods:"renderHtml",getContainerElm:function(){return document.body},getParentCtrl:function(e){var t,n=this.getRoot().controlIdLookup;while(e&&n){t=n[e.id];if(t){break}e=e.parentNode}return t},parseBox:function(e){var t,n=10;if(!e){return}if(typeof e==="number"){e=e||0;return{top:e,left:e,bottom:e,right:e}}e=e.split(" ");t=e.length;if(t===1){e[1]=e[2]=e[3]=e[0]}else if(t===2){e[2]=e[0];e[3]=e[1]}else if(t===3){e[3]=e[1]}return{top:parseInt(e[0],n)||0,right:parseInt(e[1],n)||0,bottom:parseInt(e[2],n)||0,left:parseInt(e[3],n)||0}},borderBox:function(){return this._borderBox},paddingBox:function(){return this._paddingBox},marginBox:function(){return this._marginBox},measureBox:function(e,t){function n(t){var n=document.defaultView;if(n){t=t.replace(/[A-Z]/g,function(e){return"-"+e});return n.getComputedStyle(e,null).getPropertyValue(t)}return e.currentStyle[t]}function i(e){var t=parseFloat(n(e),10);return isNaN(t)?0:t}return{top:i(t+"TopWidth"),right:i(t+"RightWidth"),bottom:i(t+"BottomWidth"),left:i(t+"LeftWidth")}},initLayoutRect:function(){var e=this,t=e.settings,n,r;var o=e.getEl(),a,s,l,f,u;var d,h,c;n=e._borderBox=e._borderBox||e.measureBox(o,"border");e._paddingBox=e._paddingBox||e.measureBox(o,"padding");e._marginBox=e._marginBox||e.measureBox(o,"margin");c=i.getSize(o);d=t.minWidth;h=t.minHeight;l=d||c.width;f=h||c.height;a=t.width;s=t.height;u=t.autoResize;u=typeof u!="undefined"?u:!a&&!s;a=a||l;s=s||f;var p=n.left+n.right;var m=n.top+n.bottom;var g=t.maxWidth||65535;var v=t.maxHeight||65535;e._layoutRect=r={x:t.x||0,y:t.y||0,w:a,h:s,deltaW:p,deltaH:m,contentW:a-p,contentH:s-m,innerW:a-p,innerH:s-m,startMinWidth:d||0,startMinHeight:h||0,minW:Math.min(l,g),minH:Math.min(f,v),maxW:g,maxH:v,autoResize:u,scrollW:0};e._lastLayoutRect={};return r},layoutRect:function(e){var t=this,n=t._layoutRect,i,r,o,a,s,l;if(!n){n=t.initLayoutRect()}if(e){o=n.deltaW;a=n.deltaH;if(e.x!==s){n.x=e.x}if(e.y!==s){n.y=e.y}if(e.minW!==s){n.minW=e.minW}if(e.minH!==s){n.minH=e.minH}r=e.w;if(r!==s){r=r<n.minW?n.minW:r;r=r>n.maxW?n.maxW:r;n.w=r;n.innerW=r-o}r=e.h;if(r!==s){r=r<n.minH?n.minH:r;r=r>n.maxH?n.maxH:r;n.h=r;n.innerH=r-a}r=e.innerW;if(r!==s){r=r<n.minW-o?n.minW-o:r;r=r>n.maxW-o?n.maxW-o:r;n.innerW=r;n.w=r+o}r=e.innerH;if(r!==s){r=r<n.minH-a?n.minH-a:r;r=r>n.maxH-a?n.maxH-a:r;n.innerH=r;n.h=r+a}if(e.contentW!==s){n.contentW=e.contentW}if(e.contentH!==s){n.contentH=e.contentH}i=t._lastLayoutRect;if(i.x!==n.x||i.y!==n.y||i.w!==n.w||i.h!==n.h){l=f.repaintControls;if(l){if(l.map&&!l.map[t._id]){l.push(t);l.map[t._id]=true}}i.x=n.x;i.y=n.y;i.w=n.w;i.h=n.h}return t}return n},repaint:function(){var e=this,t,n,i,r,o=0,a=0,s,l;l=!document.createRange?Math.round:function(e){return e};t=e.getEl().style;i=e._layoutRect;s=e._lastRepaintRect||{};r=e._borderBox;o=r.left+r.right;a=r.top+r.bottom;if(i.x!==s.x){t.left=l(i.x)+"px";s.x=i.x}if(i.y!==s.y){t.top=l(i.y)+"px";s.y=i.y}if(i.w!==s.w){t.width=l(i.w-o)+"px";s.w=i.w}if(i.h!==s.h){t.height=l(i.h-a)+"px";s.h=i.h}if(e._hasBody&&i.innerW!==s.innerW){n=e.getEl("body").style;n.width=l(i.innerW)+"px";s.innerW=i.innerW}if(e._hasBody&&i.innerH!==s.innerH){n=n||e.getEl("body").style;n.height=l(i.innerH)+"px";s.innerH=i.innerH}e._lastRepaintRect=s;e.fire("repaint",{},false)},on:function(e,t){var n=this,i,o,a,s;function l(e){var t,i;return function(r){if(!t){n.parentsAndSelf().each(function(n){var r=n.settings.callbacks;if(r&&(t=r[e])){i=n;return false}})}return t.call(i,r)}}if(t){if(typeof t=="string"){t=l(t)}a=e.toLowerCase().split(" ");s=a.length;while(s--){e=a[s];i=n._bindings;if(!i){i=n._bindings={}}o=i[e];if(!o){o=i[e]=[]}o.push(t);if(r[e]){if(!n._nativeEvents){n._nativeEvents={}}n._nativeEvents[e]=true;if(n._rendered){n.bindPendingEvents()}}}}return n},off:function(e,t){var n=this,i,r=n._bindings,o,a,s,l;if(r){if(e){s=e.toLowerCase().split(" ");i=s.length;while(i--){e=s[i];o=r[e];if(!e){for(a in r){r[a].length=0}return n}if(o){if(!t){o.length=0}else{l=o.length;while(l--){if(o[l]===t){o.splice(l,1)}}}}}}else{n._bindings=[]}}return n},fire:function(e,t,n){var i=this,r,o,a,s;e=e.toLowerCase();function l(){return false}function f(){return true}t=t||{};if(!t.type){t.type=e}if(!t.control){t.control=i}if(!t.preventDefault){t.preventDefault=function(){t.isDefaultPrevented=f};t.stopPropagation=function(){t.isPropagationStopped=f};t.stopImmediatePropagation=function(){t.isImmediatePropagationStopped=f};t.isDefaultPrevented=l;t.isPropagationStopped=l;t.isImmediatePropagationStopped=l}if(i._bindings){a=i._bindings[e];if(a){for(r=0,o=a.length;r<o;r++){if(!t.isImmediatePropagationStopped()&&a[r].call(i,t)===false){break}}}}if(n!==false){s=i.parent();while(s&&!t.isPropagationStopped()){s.fire(e,t,false);s=s.parent()}}return t},hasEventListeners:function(e){return e in this._bindings},parents:function(e){var t=this,i,r=new n;for(i=t.parent();i;i=i.parent()){r.add(i)}if(e){r=r.filter(e)}return r},parentsAndSelf:function(e){return new n(this).add(this.parents(e))},next:function(){var e=this.parent().items();return e[e.indexOf(this)+1]},prev:function(){var e=this.parent().items();return e[e.indexOf(this)-1]},findCommonAncestor:function(e,t){var n;while(e){n=t;while(n&&e!=n){n=n.parent()}if(e==n){break}e=e.parent()}return e},hasClass:function(e,t){var n=this._classes[t||"control"];e=this.classPrefix+e;return n&&!!n.map[e]},addClass:function(e,t){var n=this,i,r;e=this.classPrefix+e;i=n._classes[t||"control"];if(!i){i=[];i.map={};n._classes[t||"control"]=i}if(!i.map[e]){i.map[e]=e;i.push(e);if(n._rendered){r=n.getEl(t);if(r){r.className=i.join(" ")}}}return n},removeClass:function(e,t){var n=this,i,r,o;e=this.classPrefix+e;i=n._classes[t||"control"];if(i&&i.map[e]){delete i.map[e];r=i.length;while(r--){if(i[r]===e){i.splice(r,1)}}}if(n._rendered){o=n.getEl(t);if(o){o.className=i.join(" ")}}return n},toggleClass:function(e,t,n){var i=this;if(t){i.addClass(e,n)}else{i.removeClass(e,n)}return i},classes:function(e){var t=this._classes[e||"control"];return t?t.join(" "):""},innerHtml:function(e){i.innerHtml(this.getEl(),e);return this},getEl:function(e,t){var n,r=e?this._id+"-"+e:this._id;n=o[r]=(t===true?null:o[r])||i.get(r);return n},visible:function(e){var t=this,n;if(typeof e!=="undefined"){if(t._visible!==e){if(t._rendered){t.getEl().style.display=e?"":"none"}t._visible=e;n=t.parent();if(n){n._lastRect=null}t.fire(e?"show":"hide")}return t}return t._visible},show:function(){return this.visible(true)},hide:function(){return this.visible(false)},focus:function(){try{this.getEl().focus()}catch(e){}return this},blur:function(){this.getEl().blur();return this},aria:function(e,t){var n=this,i=n.getEl(n.ariaTarget);if(typeof t==="undefined"){return n._aria[e]}else{n._aria[e]=t}if(n._rendered){i.setAttribute(e=="role"?e:"aria-"+e,t)}return n},encode:function(e,t){if(t!==false){e=this.translate(e)}return(e||"").replace(/[&<>"]/g,function(e){return"&#"+e.charCodeAt(0)+";"})},translate:function(e){return f.translate?f.translate(e):e},before:function(e){var t=this,n=t.parent();if(n){n.insert(e,n.items().indexOf(t),true)}return t},after:function(e){var t=this,n=t.parent();if(n){n.insert(e,n.items().indexOf(t))}return t},remove:function(){var e=this,t=e.getEl(),n=e.parent(),r,a;if(e.items){var s=e.items().toArray();a=s.length;while(a--){s[a].remove()}}if(n&&n.items){r=[];n.items().each(function(t){if(t!==e){r.push(t)}});n.items().set(r);n._lastRect=null}if(e._eventsRoot&&e._eventsRoot==e){i.off(t)}var l=e.getRoot().controlIdLookup;if(l){delete l[e._id]}delete o[e._id];if(t&&t.parentNode){var f=t.getElementsByTagName("*");a=f.length;while(a--){delete o[f[a].id]}t.parentNode.removeChild(t)}e._rendered=false;return e},renderBefore:function(e){var t=this;e.parentNode.insertBefore(i.createFragment(t.renderHtml()),e);t.postRender();return t},renderTo:function(e){var t=this;e=e||t.getContainerElm();e.appendChild(i.createFragment(t.renderHtml()));t.postRender();return t},postRender:function(){var e=this,t=e.settings,n,r,o,a,s;for(a in t){if(a.indexOf("on")===0){e.on(a.substr(2),t[a])}}if(e._eventsRoot){for(o=e.parent();!s&&o;o=o.parent()){s=o._eventsRoot}if(s){for(a in s._nativeEvents){e._nativeEvents[a]=true}}}e.bindPendingEvents();if(t.style){n=e.getEl();if(n){n.setAttribute("style",t.style);n.style.cssText=t.style}}if(!e._visible){i.css(e.getEl(),"display","none")}if(e.settings.border){r=e.borderBox();i.css(e.getEl(),{"border-top-width":r.top,"border-right-width":r.right,"border-bottom-width":r.bottom,"border-left-width":r.left})}var l=e.getRoot();if(!l.controlIdLookup){l.controlIdLookup={}}l.controlIdLookup[e._id]=e;for(var f in e._aria){e.aria(f,e._aria[f])}e.fire("postrender",{},false)},scrollIntoView:function(e){function t(e,t){var n,i,r=e;n=i=0;while(r&&r!=t&&r.nodeType){n+=r.offsetLeft||0;i+=r.offsetTop||0;r=r.offsetParent}return{x:n,y:i}}var n=this.getEl(),i=n.parentNode;var r,o,a,s,l,f;var u=t(n,i);r=u.x;o=u.y;a=n.offsetWidth;s=n.offsetHeight;l=i.clientWidth;f=i.clientHeight;if(e=="end"){r-=l-a;o-=f-s}else if(e=="center"){r-=l/2-a/2;o-=f/2-s/2}i.scrollLeft=r;i.scrollTop=o;return this},bindPendingEvents:function(){var e=this,t,n,r,o,l,f;function u(t){var n=e.getParentCtrl(t.target);if(n){n.fire(t.type,t)}}function d(){var e=o._lastHoverCtrl;if(e){e.fire("mouseleave",{target:e.getEl()});e.parents().each(function(e){e.fire("mouseleave",{target:e.getEl()})});o._lastHoverCtrl=null}}function h(t){var n=e.getParentCtrl(t.target),i=o._lastHoverCtrl,r=0,a,s,l;if(n!==i){o._lastHoverCtrl=n;s=n.parents().toArray().reverse();s.push(n);if(i){l=i.parents().toArray().reverse();l.push(i);for(r=0;r<l.length;r++){if(s[r]!==l[r]){break}}for(a=l.length-1;a>=r;a--){i=l[a];i.fire("mouseleave",{target:i.getEl()})}}for(a=r;a<s.length;a++){n=s[a];n.fire("mouseenter",{target:n.getEl()})}}}function c(t){t.preventDefault();if(t.type=="mousewheel"){t.deltaY=-1/40*t.wheelDelta;if(t.wheelDeltaX){t.deltaX=-1/40*t.wheelDeltaX}}else{t.deltaX=0;t.deltaY=t.detail}t=e.fire("wheel",t)}e._rendered=true;l=e._nativeEvents;if(l){r=e.parents().toArray();r.unshift(e);for(t=0,n=r.length;!o&&t<n;t++){o=r[t]._eventsRoot}if(!o){o=r[r.length-1]||e}e._eventsRoot=o;for(n=t,t=0;t<n;t++){r[t]._eventsRoot=o}var p=o._delegates;if(!p){p=o._delegates={}}for(f in l){if(!l){return false}if(f==="wheel"&&!s){if(a){i.on(e.getEl(),"mousewheel",c)}else{i.on(e.getEl(),"DOMMouseScroll",c)}continue}if(f==="mouseenter"||f==="mouseleave"){if(!o._hasMouseEnter){i.on(o.getEl(),"mouseleave",d);i.on(o.getEl(),"mouseover",h);o._hasMouseEnter=1}}else if(!p[f]){i.on(o.getEl(),f,u);p[f]=true}l[f]=false}}},getRoot:function(){var e=this,t,n=[];while(e){if(e.rootControl){t=e.rootControl;break}n.push(e);t=e;e=e.parent()}if(!t){t=this}var i=n.length;while(i--){n[i].rootControl=t}return t},reflow:function(){this.repaint();return this}});return f});