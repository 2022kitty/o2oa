define("tinymce/ui/MenuButton",["tinymce/ui/Button","tinymce/ui/Factory","tinymce/ui/MenuBar"],function(e,n,t){"use strict";function i(e,n){while(e){if(n===e){return true}e=e.parentNode}return false}var u=e.extend({init:function(e){var n=this;n._renderOpen=true;n._super(e);n.addClass("menubtn");if(e.fixedWidth){n.addClass("fixed-width")}n.aria("haspopup",true);n.hasPopup=true},showMenu:function(){var e=this,t=e.settings,i;if(e.menu&&e.menu.visible()){return e.hideMenu()}if(!e.menu){i=t.menu||[];if(i.length){i={type:"menu",items:i}}else{i.type=i.type||"menu"}e.menu=n.create(i).parent(e).renderTo();e.fire("createmenu");e.menu.reflow();e.menu.on("cancel",function(n){if(n.control.parent()===e.menu){n.stopPropagation();e.focus();e.hideMenu()}});e.menu.on("select",function(){e.focus()});e.menu.on("show hide",function(n){if(n.control==e.menu){e.activeMenu(n.type=="show")}e.aria("expanded",n.type=="show")}).fire("show")}e.menu.show();e.menu.layoutRect({w:e.layoutRect().w});e.menu.moveRel(e.getEl(),e.isRtl()?["br-tr","tr-br"]:["bl-tl","tl-bl"])},hideMenu:function(){var e=this;if(e.menu){e.menu.items().each(function(e){if(e.hideMenu){e.hideMenu()}});e.menu.hide()}},activeMenu:function(e){this.toggleClass("active",e)},renderHtml:function(){var e=this,n=e._id,i=e.classPrefix;var u=e.settings.icon?i+"ico "+i+"i-"+e.settings.icon:"";e.aria("role",e.parent()instanceof t?"menuitem":"button");return'<div id="'+n+'" class="'+e.classes()+'" tabindex="-1" aria-labelledby="'+n+'">'+'<button id="'+n+'-open" role="presentation" type="button" tabindex="-1">'+(u?'<i class="'+u+'"></i>':"")+"<span>"+(e._text?(u?" ":"")+e.encode(e._text):"")+"</span>"+' <i class="'+i+'caret"></i>'+"</button>"+"</div>"},postRender:function(){var e=this;e.on("click",function(n){if(n.control===e&&i(n.target,e.getEl())){e.showMenu();if(n.aria){e.menu.items()[0].focus()}}});e.on("mouseenter",function(n){var t=n.control,i=e.parent(),r;if(t&&i&&t instanceof u&&t.parent()==i){i.items().filter("MenuButton").each(function(e){if(e.hideMenu&&e!=t){if(e.menu&&e.menu.visible()){r=true}e.hideMenu()}});if(r){t.focus();t.showMenu()}}});return e._super()},text:function(e){var n=this,t,i;if(n._rendered){i=n.getEl("open").getElementsByTagName("span");for(t=0;t<i.length;t++){i[t].innerHTML=(n.settings.icon&&e?" ":"")+n.encode(e)}}return this._super(e)},remove:function(){this._super();if(this.menu){this.menu.remove()}}});return u});