define("tinymce/pasteplugin/WordFilter",["tinymce/util/Tools","tinymce/html/DomParser","tinymce/html/Schema","tinymce/html/Serializer","tinymce/html/Node","tinymce/pasteplugin/Utils"],function(e,t,i,n,s,a){function r(e){return/<font face="Times New Roman"|class="?Mso|style="[^"]*\bmso-|style='[^'']*\bmso-|w:WordDocument/i.test(e)||/class="OutlineElement/.test(e)||/id="?docs\-internal\-guid\-/.test(e)}function l(l){var o=l.settings;l.on("BeforePastePreProcess",function(f){var c=f.content,u,m;u=o.paste_retain_style_properties;if(u){m=e.makeMap(u.split(/[, ]/))}function d(e){var t,i,n=1;function a(e,a,r,l){var o=e._listLevel||n;if(o!=n){if(o<n){if(t){t=t.parent.parent}}else{i=t;t=null}}if(!t||t.name!=r){i=i||t;t=new s(r,1);if(l>1){t.attr("start",""+l)}e.wrap(t)}else{t.append(e)}e.name="li";a.value="";var f=a.next;if(f&&f.type==3){f.value=f.value.replace(/^\u00a0+/,"")}if(o>n&&i){i.lastChild.append(t)}n=o}var r=e.getAll("p");for(var l=0;l<r.length;l++){e=r[l];if(e.name=="p"&&e.firstChild){var o="";var f=e.firstChild;while(f){o=f.value;if(o){break}f=f.firstChild}if(/^\s*[\u2022\u00b7\u00a7\u00d8\u25CF]\s*$/.test(o)){a(e,f,"ul");continue}if(/^\s*\w+\.$/.test(o)){var c=/([0-9])\./.exec(o);var u=1;if(c){u=parseInt(c[1],10)}a(e,f,"ol",u);continue}t=null}}}function p(t,i){var n={},a=l.dom.parseStyle(i);if(t.name==="p"){var r=/mso-list:\w+ \w+([0-9]+)/.exec(i);if(r){t._listLevel=parseInt(r[1],10)}}e.each(a,function(e,i){switch(i){case"horiz-align":i="text-align";break;case"vert-align":i="vertical-align";break;case"font-color":case"mso-foreground":i="color";break;case"mso-background":case"mso-highlight":i="background";break;case"font-weight":case"font-style":if(e!="normal"){n[i]=e}return;case"mso-element":if(/^(comment|comment-list)$/i.test(e)){t.remove();return}break}if(i.indexOf("mso-comment")===0){t.remove();return}if(i.indexOf("mso-")===0){return}if(u=="all"||m&&m[i]){n[i]=e}});if(/(bold)/i.test(n["font-weight"])){delete n["font-weight"];t.wrap(new s("b",1))}if(/(italic)/i.test(n["font-style"])){delete n["font-style"];t.wrap(new s("i",1))}n=l.dom.serializeStyle(n,t.name);if(n){return n}return null}if(o.paste_enable_default_filters===false){return}if(r(f.content)){f.wordContent=true;c=a.filter(c,[/<!--[\s\S]+?-->/gi,/<(!|script[^>]*>.*?<\/script(?=[>\s])|\/?(\?xml(:\w+)?|img|meta|link|style|\w:\w+)(?=[\s\/>]))[^>]*>/gi,[/<(\/?)s>/gi,"<$1strike>"],[/&nbsp;/gi," "],[/<span\s+style\s*=\s*"\s*mso-spacerun\s*:\s*yes\s*;?\s*"\s*>([\s\u00a0]*)<\/span>/gi,function(e,t){return t.length>0?t.replace(/./," ").slice(Math.floor(t.length/2)).split("").join(" "):""}]]);var h=o.paste_word_valid_elements;if(!h){h="-strong/b,-em/i,-span,-p,-ol,-ul,-li,-h1,-h2,-h3,-h4,-h5,-h6,-p/div,"+"-table[width],-tr,-td[colspan|rowspan|width],-th,-thead,-tfoot,-tbody,-a[href|name],sub,sup,strike,br,del"}var v=new i({valid_elements:h,valid_children:"-li[p]"});e.each(v.elements,function(e){if(!e.attributes["class"]){e.attributes["class"]={};e.attributesOrder.push("class")}if(!e.attributes.style){e.attributes.style={};e.attributesOrder.push("style")}});var w=new t({},v);w.addAttributeFilter("style",function(e){var t=e.length,i;while(t--){i=e[t];i.attr("style",p(i,i.attr("style")));if(i.name=="span"&&i.parent&&!i.attributes.length){i.unwrap()}}});w.addAttributeFilter("class",function(e){var t=e.length,i,n;while(t--){i=e[t];n=i.attr("class");if(/^(MsoCommentReference|MsoCommentText|msoDel)$/i.test(n)){i.remove()}i.attr("class",null)}});w.addNodeFilter("del",function(e){var t=e.length;while(t--){e[t].remove()}});w.addNodeFilter("a",function(e){var t=e.length,i,n,s;while(t--){i=e[t];n=i.attr("href");s=i.attr("name");if(n&&n.indexOf("#_msocom_")!=-1){i.remove();continue}if(n&&n.indexOf("file://")===0){n=n.split("#")[1];if(n){n="#"+n}}if(!n&&!s){i.unwrap()}else{if(s&&!/^_?(?:toc|edn|ftn)/i.test(s)){i.unwrap();continue}i.attr({href:n,name:s})}}});var g=w.parse(c);d(g);f.content=new n({},v).serialize(g)}})}l.isWordContent=r;return l});