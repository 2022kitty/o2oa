MWF.xDesktop.requireApp("VsettanMail","Actions.RestActions",null,false);MWF.xApplication.VsettanMail.options.multitask=false;MWF.xApplication.VsettanMail.Main=new Class({Extends:MWF.xApplication.Common.Main,Implements:[Options,Events],options:{style:"default",name:"VsettanMail",icon:"icon.png",width:"1000",height:"700",title:MWF.xApplication.VsettanMail.LP.title},onQueryLoad:function(){this.lp=MWF.xApplication.VsettanMail.LP},loadApplication:function(i){debugger;this.action=new MWF.xApplication.VsettanMail.Actions.RestActions;this.createNode();if(Browser.ie){this.openMailNewWindow()}else{this.openMail()}},openMail:function(i){var t=i;this.action.getPassword(function(i){var t="http://"+layout.config.mail+"/names.nsf?login?login&username="+this.desktop.session.user.unique+"&password="+i.data.password+"&RedirectTo=/";this.iframe=new Element("iframe",{src:t,styles:this.css.iframe,border:"0"});this.iframe.inject(this.node)}.bind(this))},openMailNewWindow:function(){this.action.getPassword(function(i){var t="http://"+layout.config.mail+"/names.nsf?login?login&username="+this.desktop.session.user.unique+"&password="+i.data.password+"&RedirectTo=/";window.open(t);this.close()}.bind(this))},createNode:function(){this.content.setStyle("overflow","hidden");this.node=new Element("div",{styles:{width:"100%",height:"100%",overflow:"hidden"}}).inject(this.content)}});