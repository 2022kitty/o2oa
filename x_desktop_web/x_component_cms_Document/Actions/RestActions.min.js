MWF.xApplication.cms=MWF.xApplication.cms||{};MWF.xApplication.cms.Document=MWF.xApplication.cms.Document||{};MWF.xApplication.cms.Document.Actions=MWF.xApplication.cms.Document.Actions||{};MWF.require("MWF.xDesktop.Actions.RestActions",null,false);MWF.xApplication.cms.Document.Actions.RestActions=new Class({initialize:function(){this.actionPath="/x_component_cms_Document/Actions/action.json";this.actionDocument=new MWF.xDesktop.Actions.RestActions("","x_cms_assemble_control","x_component_cms_Document");this.actionDocument.getActions=function(t){this.getActionActions(this.actionDocument,t)}.bind(this);this.actionData=new MWF.xDesktop.Actions.RestActions("","x_cms_assemble_control","x_component_cms_Document");this.actionData.getActions=function(t){this.getActionActions(this.actionData,t)}.bind(this);this.actionAttachment=new MWF.xDesktop.Actions.RestActions("","x_cms_assemble_control","x_component_cms_Document");this.actionAttachment.getActions=function(t){this.getActionActions(this.actionAttachment,t)}.bind(this);this.actionHotPic=new MWF.xDesktop.Actions.RestActions("","x_hotpic_assemble_control","x_component_cms_Document");this.actionHotPic.getActions=function(t){this.getActionActions(this.actionHotPic,t)}.bind(this);this.actionOrg=new MWF.xDesktop.Actions.RestActions("","x_organization_assemble_express","x_component_cms_Document");this.actionOrg.getActions=function(t){this.getActionActions(this.actionOrg,t)}.bind(this)},getActionActions:function(t,e){if(!t.actions){this.getActions(function(n){t.actions=this.actions;if(e)e()}.bind(this))}else{if(e)e()}},getActions:function(t){if(!this.actions){MWF.getJSON(this.actionPath,function(e){this.actions=e;if(t)t()}.bind(this))}else{if(t)t()}},getId:function(t,e,n,i){this.action.invoke({name:"getId",async:i,parameter:{count:t},success:e,failure:n})},getUUID:function(t){var e="";this.action.invoke({name:"getId",async:false,parameter:{count:"1"},success:function(n){e=n.data[0];if(t)t(e)},failure:null});return e},listColumnController:function(t,e,n,i){this.actionDocument.invoke({name:"listColumnController",async:i,parameter:{appId:t},success:e,failure:n})},listCategoryController:function(t,e,n,i){this.actionDocument.invoke({name:"listCategoryController",async:i,parameter:{categoryId:t},success:e,failure:n})},getDocument:function(t,e,n){this.actionDocument.invoke({name:"getDocument",parameter:{id:t},success:e,failure:n})},viewDocument:function(t,e,n){this.actionDocument.invoke({name:"viewDocument",parameter:{id:t},success:e,failure:n})},saveDocument:function(t,e,n,i){if(!t.isNewDocument){this.updateDocument(t,e,n,i)}else{this.addDocument(t,e,n,i)}},addDocument:function(t,e,n,i){delete t.attachmentList;this.actionDocument.invoke({name:"addDocument",data:t,success:e,failure:n,async:i})},updateDocument:function(t,e,n,i){delete t.attachmentList;this.actionDocument.invoke({name:"updateDocument",data:t,parameter:{id:t.id},success:e,failure:n,async:i})},removeDocument:function(t,e,n,i){this.actionDocument.invoke({name:"removeDocument",async:i,parameter:{id:t},success:e,failure:n})},publishDocument:function(t,e,n){this.actionDocument.invoke({name:"publishDocument",data:t,parameter:{id:t.id},success:e,failure:n})},cancelPublishDocument:function(t,e,n){this.actionDocument.invoke({name:"cancelPublishDocument",data:t,parameter:{id:t.id},success:e,failure:n})},archiveDocument:function(t,e,n){this.actionDocument.invoke({name:"archiveDocument",data:t,parameter:{id:t.id},success:e,failure:n})},redraftDocument:function(t,e,n){this.actionDocument.invoke({name:"redraftDocument",data:t,parameter:{id:t.id},success:e,failure:n})},getCategory:function(t,e,n){var i=this;this.actionDocument.invoke({name:"getCategory",parameter:{id:t},success:function(t){i.transCategoryData(t);e.call(this,t)},failure:n})},transCategoryData:function(t){var e=function(t){if(!t.name)t.name=t.categoryName;if(!t.alias)t.alias=t.categoryAlias;if(!t.categoryName)t.categoryName=t.name;if(!t.categoryAlias)t.categoryAlias=t.alias};if(t.data){if(typeOf(t.data)=="array"){t.data.each(function(t){e(t)})}else{e(t.data)}}else{t.data=[]}},getForm:function(t,e,n,i){this.actionDocument.invoke({name:"getForm",async:i,parameter:{id:t},success:e,failure:n})},saveData:function(t,e,n,i,a){if(!i.isNew){this.updateData(t,e,n,i,a)}else{this.addData(t,e,n,i,a)}},addData:function(t,e,n,i,a){this.actionData.invoke({name:"addData",async:a,data:i,parameter:{id:n},success:t,failure:e})},updateData:function(t,e,n,i,a){this.actionData.invoke({name:"updateData",async:a,data:i,parameter:{id:n},success:t,failure:e})},listAttachment:function(t,e,n,i){this.actionDocument.invoke({name:"listAttachment",async:i,parameter:{documentid:t},success:e,failure:n})},uploadAttachment:function(t,e,n,i,a){this.actionAttachment.invoke({name:"uploadAttachment",parameter:{id:t},data:i,file:a,success:e,failure:n})},replaceAttachment:function(t,e,n,i,a,c){this.actionAttachment.invoke({name:"replaceAttachment",parameter:{documentid:e,id:t},data:a,file:c,success:n,failure:i})},getAttachment:function(t,e,n,i,a){this.actionAttachment.invoke({name:"getAttachment",async:a,parameter:{id:t,documentid:e},success:n,failure:i})},deleteAttachment:function(t,e,n,i,a){this.actionAttachment.invoke({name:"deleteAttachment",async:a,parameter:{id:t,documentid:e},success:n,failure:i})},getAttachmentData:function(t,e){this.actionAttachment.getActions(function(){var n=this.actionAttachment.actions.getAttachmentData.uri;n=n.replace("{id}",encodeURIComponent(t));n=n.replace("{documentid}",encodeURIComponent(e));window.open(this.actionAttachment.address+n)}.bind(this))},getAttachmentStream:function(t,e){this.actionAttachment.getActions(function(){var n=this.actionAttachment.actions.getAttachmentStream.uri;n=n.replace("{id}",encodeURIComponent(t));n=n.replace("{documentid}",encodeURIComponent(e));window.open(this.actionAttachment.address+n)}.bind(this))},getAttachmentUrl:function(t,e,n){this.actionAttachment.getActions(function(){var i=this.actionAttachment.actions.getAttachmentData.uri;i=i.replace("{id}",encodeURIComponent(t));i=i.replace("{documentid}",encodeURIComponent(e));if(n)n(this.actionAttachment.address+i)}.bind(this))},getHotPic:function(t,e,n,i,a){this.actionHotPic.invoke({name:"getHotPic",parameter:{application:t,infoId:e},success:n,failure:i,async:a})},saveHotPic:function(t,e,n,i){this.actionHotPic.invoke({name:"saveHotPic",data:t,success:e,failure:n,async:i})},removeHotPic:function(t,e,n,i){this.actionHotPic.invoke({name:"removeHotPic",async:i,parameter:{id:t},success:e,failure:n})},removeHotPicByInfor:function(t,e,n,i){this.actionHotPic.invoke({name:"removeHotPicByInfor",parameter:{application:t,infoId:e},success:n,failure:i})},listHotPicFilterPage:function(t,e,n,i,a,c){this.actionHotPic.invoke({name:"listHotPicFilterPage",parameter:{page:t,count:e},data:n,async:c,success:i,failure:a})},getInternetImageBaseBase64:function(t,e,n,i){this.actionAttachment.invoke({name:"getInternetImageBaseBase64",data:t,success:e,failure:n,async:i})},convertLocalImageToBase64:function(t,e,n,i,a){this.actionAttachment.invoke({name:"convertLocalImageToBase64",parameter:{size:t},data:i,file:a,success:e,failure:n})},getSubjectAttachmentBase64:function(t,e,n,i,a){this.actionAttachment.invoke({name:"getSubjectAttachmentBase64",parameter:{id:t,size:e},success:n,failure:i,async:a})},getPersonByIdentity:function(t,e,n,i){this.actionOrg.invoke({name:"getPersonByIdentity",async:i,parameter:{name:n},success:t,failure:e})},getPerson:function(t,e,n,i){this.actionOrg.invoke({name:"getPerson",async:i,parameter:{name:n},success:t,failure:e})},saveImage:function(t,e,n,i){this.actionDocument.invoke({name:"saveImage",data:t,success:e,failure:n,async:i})},getImage:function(t,e,n,i){this.actionDocument.invoke({name:"getImage",async:i,parameter:{id:t},success:e,failure:n})},listImage:function(t,e,n,i){this.actionDocument.invoke({name:"listImage",async:i,parameter:{documentid:t},success:e,failure:n})},removeImage:function(t,e,n,i){this.actionDocument.invoke({name:"removeImage",async:i,parameter:{id:t},success:e,failure:n})},getImageByDocument:function(t,e,n,i){this.actionDocument.invoke({name:"getImageByDocument",async:i,parameter:{documentid:t},success:e,failure:n})},getImageUrl:function(t,e,n){this.actionDocument.getActions(function(){var i=this.actionDocument.actions.getImage.uri;i=i.replace("{id}",encodeURIComponent(t));i=i.replace("{documentid}",encodeURIComponent(e));if(n)n(this.actionDocument.address+i)}.bind(this))}});