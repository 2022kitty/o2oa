MWF.xApplication.cms=MWF.xApplication.cms||{};MWF.xApplication.cms.Document=MWF.xApplication.cms.Document||{};MWF.xApplication.cms.Document.Actions=MWF.xApplication.cms.Document.Actions||{};MWF.require("MWF.xDesktop.Actions.RestActions",null,false);MWF.xApplication.cms.Document.Actions.RestActions=new Class({initialize:function(){this.actionPath="/x_component_cms_Document/Actions/action.json";this.actionDocument=new MWF.xDesktop.Actions.RestActions("","x_cms_assemble_control","x_component_cms_Document");this.actionDocument.getActions=function(t){this.getActionActions(this.actionDocument,t)}.bind(this);this.actionData=new MWF.xDesktop.Actions.RestActions("","x_cms_assemble_control","x_component_cms_Document");this.actionData.getActions=function(t){this.getActionActions(this.actionData,t)}.bind(this);this.actionAttachment=new MWF.xDesktop.Actions.RestActions("","x_cms_assemble_control","x_component_cms_Document");this.actionAttachment.getActions=function(t){this.getActionActions(this.actionAttachment,t)}.bind(this);this.actionHotPic=new MWF.xDesktop.Actions.RestActions("","x_hotpic_assemble_control","x_component_cms_Document");this.actionHotPic.getActions=function(t){this.getActionActions(this.actionHotPic,t)}.bind(this)},getActionActions:function(t,e){if(!t.actions){this.getActions(function(n){t.actions=this.actions;if(e)e()}.bind(this))}else{if(e)e()}},getActions:function(t){if(!this.actions){MWF.getJSON(this.actionPath,function(e){this.actions=e;if(t)t()}.bind(this))}else{if(t)t()}},getId:function(t,e,n,a){this.action.invoke({name:"getId",async:a,parameter:{count:t},success:e,failure:n})},getUUID:function(t){var e="";this.action.invoke({name:"getId",async:false,parameter:{count:"1"},success:function(n){e=n.data[0];if(t)t(e)},failure:null});return e},listColumnController:function(t,e,n,a){this.actionDocument.invoke({name:"listColumnController",async:a,parameter:{appId:t},success:e,failure:n})},getDocument:function(t,e,n){this.actionDocument.invoke({name:"getDocument",parameter:{id:t},success:e,failure:n})},saveDocument:function(t,e,n,a){if(!t.isNewDocument){this.updateDocument(t,e,n,a)}else{this.addDocument(t,e,n,a)}},addDocument:function(t,e,n,a){delete t.attachmentList;this.actionDocument.invoke({name:"addDocument",data:t,success:e,failure:n,async:a})},updateDocument:function(t,e,n,a){delete t.attachmentList;this.actionDocument.invoke({name:"updateDocument",data:t,parameter:{id:t.id},success:e,failure:n,async:a})},removeDocument:function(t,e,n,a){this.actionDocument.invoke({name:"removeDocument",async:a,parameter:{id:t},success:e,failure:n})},publishDocument:function(t,e,n){this.actionDocument.invoke({name:"publishDocument",data:t,parameter:{id:t.id},success:e,failure:n})},cancelPublishDocument:function(t,e,n){this.actionDocument.invoke({name:"cancelPublishDocument",data:t,parameter:{id:t.id},success:e,failure:n})},archiveDocument:function(t,e,n){this.actionDocument.invoke({name:"archiveDocument",data:t,parameter:{id:t.id},success:e,failure:n})},redraftDocument:function(t,e,n){this.actionDocument.invoke({name:"redraftDocument",data:t,parameter:{id:t.id},success:e,failure:n})},getCategory:function(t,e,n){var a=this;this.actionDocument.invoke({name:"getCategory",parameter:{id:t},success:function(t){a.transCategoryData(t);e.call(this,t)},failure:n})},transCategoryData:function(t){var e=function(t){if(!t.name)t.name=t.catagoryName;if(!t.alias)t.alias=t.catagoryAlias;if(!t.catagoryName)t.catagoryName=t.name;if(!t.catagoryAlias)t.catagoryAlias=t.alias};if(t.data){if(typeOf(t.data)=="array"){t.data.each(function(t){e(t)})}else{e(t.data)}}else{t.data=[]}},getForm:function(t,e,n,a){this.actionDocument.invoke({name:"getForm",async:a,parameter:{id:t},success:e,failure:n})},saveData:function(t,e,n,a,i){if(!a.isNew){this.updateData(t,e,n,a,i)}else{this.addData(t,e,n,a,i)}},addData:function(t,e,n,a,i){this.actionData.invoke({name:"addData",async:i,data:a,parameter:{id:n},success:t,failure:e})},updateData:function(t,e,n,a,i){this.actionData.invoke({name:"updateData",async:i,data:a,parameter:{id:n},success:t,failure:e})},listAttachment:function(t,e,n,a){this.actionDocument.invoke({name:"listAttachment",async:a,parameter:{documentid:t},success:e,failure:n})},uploadAttachment:function(t,e,n,a,i){this.actionAttachment.invoke({name:"uploadAttachment",parameter:{id:t},data:a,file:i,success:e,failure:n})},replaceAttachment:function(t,e,n,a,i,c){this.actionAttachment.invoke({name:"replaceAttachment",parameter:{documentid:e,id:t},data:i,file:c,success:n,failure:a})},getAttachment:function(t,e,n,a,i){this.actionAttachment.invoke({name:"getAttachment",async:i,parameter:{id:t,documentid:e},success:n,failure:a})},deleteAttachment:function(t,e,n,a,i){this.actionAttachment.invoke({name:"deleteAttachment",async:i,parameter:{id:t,documentid:e},success:n,failure:a})},getAttachmentData:function(t,e){this.actionAttachment.getActions(function(){var n=this.actionAttachment.actions.getAttachmentData.uri;n=n.replace("{id}",encodeURIComponent(t));n=n.replace("{documentid}",encodeURIComponent(e));window.open(this.actionAttachment.address+n)}.bind(this))},getAttachmentStream:function(t,e){this.actionAttachment.getActions(function(){var n=this.actionAttachment.actions.getAttachmentStream.uri;n=n.replace("{id}",encodeURIComponent(t));n=n.replace("{documentid}",encodeURIComponent(e));window.open(this.actionAttachment.address+n)}.bind(this))},getAttachmentUrl:function(t,e,n){this.actionAttachment.getActions(function(){var a=this.actionAttachment.actions.getAttachmentData.uri;a=a.replace("{id}",encodeURIComponent(t));a=a.replace("{documentid}",encodeURIComponent(e));if(n)n(this.actionAttachment.address+a)}.bind(this))},getHotPic:function(t,e,n,a,i){this.actionHotPic.invoke({name:"getHotPic",parameter:{application:t,infoId:e},success:n,failure:a,async:i})},saveHotPic:function(t,e,n,a){this.actionHotPic.invoke({name:"saveHotPic",data:t,success:e,failure:n,async:a})},removeHotPic:function(t,e,n,a){this.actionHotPic.invoke({name:"removeHotPic",async:a,parameter:{id:t},success:e,failure:n})},removeHotPicByInfor:function(t,e,n,a){this.actionHotPic.invoke({name:"removeHotPicByInfor",parameter:{application:t,infoId:e},success:n,failure:a})},listHotPicFilterPage:function(t,e,n,a,i,c){this.actionHotPic.invoke({name:"listHotPicFilterPage",parameter:{page:t,count:e},data:n,async:c,success:a,failure:i})},getInternetImageBaseBase64:function(t,e,n,a){this.actionAttachment.invoke({name:"getInternetImageBaseBase64",data:t,success:e,failure:n,async:a})},convertLocalImageToBase64:function(t,e,n,a,i){this.actionAttachment.invoke({name:"convertLocalImageToBase64",parameter:{size:t},data:a,file:i,success:e,failure:n})},getSubjectAttachmentBase64:function(t,e,n,a,i){this.actionAttachment.invoke({name:"getSubjectAttachmentBase64",parameter:{id:t,size:e},success:n,failure:a,async:i})}});