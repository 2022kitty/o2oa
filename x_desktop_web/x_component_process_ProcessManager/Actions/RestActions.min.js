MWF.xApplication.process.ProcessManager=MWF.xApplication.process.ProcessManager||{};MWF.xApplication.process.ProcessManager.Actions=MWF.xApplication.process.ProcessManager.Actions||{};MWF.xDesktop.requireApp("process.ProcessManager","package",null,false);MWF.require("MWF.xDesktop.Actions.RestActions",null,false);MWF.require("MWF.widget.UUID",null,false);MWF.xApplication.process.ProcessManager.Actions.RestActions=new Class({initialize:function(){this.action=new MWF.xDesktop.Actions.RestActions("/Actions/action.json","x_processplatform_assemble_designer","x_component_process_ProcessManager")},getId:function(i,e,a,t){this.action.invoke({name:"getId",async:t,parameter:{count:i},success:e,failure:a})},getUUID:function(i){var e="";this.action.invoke({name:"getId",async:false,parameter:{count:"1"},success:function(a){e=a.data[0].id;if(i)i(e)},failure:null});return e},listApplication:function(i,e,a,t){if(i){this.action.invoke({name:"listApplicationByCategory",async:t,parameter:{applicationCategory:i},success:e,failure:a})}else{this.action.invoke({name:"listApplication",async:t,success:e,failure:a})}},getApplication:function(i,e,a,t){this.action.invoke({name:"getApplication",async:t,parameter:{id:i},success:e,failure:a})},saveApplication:function(i,e,a){if(i.id){this.updateApplication(i,e,a)}else{this.addApplication(i,e,a)}},updateApplication:function(i,e,a){this.action.invoke({name:"updataApplication",data:i,parameter:{id:i.id},success:e,failure:a})},addApplication:function(i,e,a){this.getId(1,function(t){i.id=t.data[0].id;this.action.invoke({name:"addApplication",data:i,success:e,failure:a})}.bind(this))},changeApplicationIcon:function(i,e,a,t,n){this.action.invoke({name:"updataApplicationIcon",parameter:{id:i},data:t,file:n,success:e,failure:a})},listProcess:function(i,e,a,t){this.action.invoke({name:"listProcess",async:t,parameter:{id:i},success:e,failure:a})},listForm:function(i,e,a,t){this.action.invoke({name:"listForm",async:t,parameter:{id:i},success:e,failure:a})},listDictionary:function(i,e,a,t){this.action.invoke({name:"listDictionary",async:t,parameter:{application:i},success:e,failure:a})},listScript:function(i,e,a,t){this.action.invoke({name:"listScript",async:t,parameter:{id:i},success:e,failure:a})},listView:function(i,e,a,t){this.action.invoke({name:"listView",async:t,parameter:{id:i},success:e,failure:a})},listStat:function(i,e,a,t){this.action.invoke({name:"listStat",async:t,parameter:{id:i},success:e,failure:a})},listFormField:function(i,e,a,t){this.action.invoke({name:"listFormField",async:t,parameter:{id:i},success:e,failure:a})},listFormTemplate:function(i,e,a){this.action.invoke({name:"listFormTemplate",async:a,success:i,failure:e})},listFormTemplateCategory:function(i,e,a){this.action.invoke({name:"listFormTemplateCategory",async:a,success:i,failure:e})},listFormTemplatByCategory:function(i,e,a){this.action.invoke({name:"listFormTemplatByCategory",async:a,success:i,failure:e})},getForm:function(i,e,a,t){this.action.invoke({name:"getForm",async:t,parameter:{id:i},success:e,failure:a})},getView:function(i,e,a,t){this.action.invoke({name:"getView",async:t,parameter:{id:i},success:e,failure:a})},getStat:function(i,e,a,t){this.action.invoke({name:"getStat",async:t,parameter:{id:i},success:e,failure:a})},getProcess:function(i,e,a,t){this.action.invoke({name:"getProcess",async:t,parameter:{id:i},success:e,failure:a})},getDictionary:function(i,e,a,t){this.action.invoke({name:"getDictionary",async:t,parameter:{applicationDict:i},success:e,failure:a})},getScript:function(i,e,a,t){this.action.invoke({name:"getScript",async:t,parameter:{id:i},success:e,failure:a})},getScriptByName:function(i,e,a,t,n){this.action.invoke({name:"getScriptByName",async:n,parameter:{name:i,applicationId:e},success:a,failure:t})},getFormTemplate:function(i,e,a,t){this.action.invoke({name:"getFormTemplate",async:t,parameter:{id:i},success:e,failure:a})},saveProcess:function(i,e,a){if(!i.isNewProcess){this.updateProcess(i,e,a)}else{this.addProcess(i,e,a)}},addProcess:function(i,e,a){this.action.invoke({name:"addProcess",data:i,parameter:{id:i.categoryId},success:e,failure:a})},updateProcess:function(i,e,a){this.action.invoke({name:"updataProcess",data:i,parameter:{id:i.id},success:e,failure:a})},deleteProcess:function(i,e,a,t){this.action.invoke({name:"removeProcess",async:t,parameter:{id:i},success:e,failure:a})},saveForm:function(i,e,a,t,n){if(!i.isNewForm){this.updateForm(i,e,a,t,n)}else{this.addForm(i,e,a,t,n)}},updateForm:function(i,e,a,t,n){var s,c;if(i)s=MWF.encodeJsonString(JSON.encode(i));if(e)c=MWF.encodeJsonString(JSON.encode(e));var o={id:i.json.id,name:i.json.name,alias:i.json.name,description:i.json.description,application:i.json.application,icon:i.json.formIcon,formFieldList:a};if(i)o.data=s;if(e)o.mobileData=c;this.action.invoke({name:"updataForm",data:o,parameter:{id:i.json.id},success:t,failure:n})},addForm:function(i,e,a,t,n){var s,c;debugger;if(!i.json.id){this.getUUID(function(o){i.json.id=o;if(i)i.isNewForm=false;if(e)e.isNewForm=false;if(i)s=MWF.encodeJsonString(JSON.encode(i));if(e)c=MWF.encodeJsonString(JSON.encode(e));var r={id:i.json.id,name:i.json.name,alias:i.json.name,description:i.json.description,application:i.json.application,icon:i.json.formIcon,formFieldList:a};if(i)r.data=s;if(e)r.mobileData=c;this.action.invoke({name:"addForm",data:r,parameter:{id:i.json.categoryId},success:t,failure:n})}.bind(this))}else{if(i)i.isNewForm=false;if(e)e.isNewForm=false;if(i)s=MWF.encodeJsonString(JSON.encode(i));if(e)e=MWF.encodeJsonString(JSON.encode(e));var o={id:i.json.id,name:i.json.name,alias:i.json.name,description:i.json.description,application:i.json.application};if(i)o.data=s;if(e)o.mobileData=e;this.action.invoke({name:"addForm",data:o,parameter:{id:i.json.categoryId},success:t,failure:n})}},deleteForm:function(i,e,a,t){this.action.invoke({name:"removeForm",async:t,parameter:{id:i},success:e,failure:a})},addFormTemplate:function(i,e,a,t,n){var s,c;debugger;this.getUUID(function(o){a.id=o;if(i){var r=Object.clone(i);r.json.id=o;r.json.name=a.name;s=MWF.encodeJsonString(JSON.encode(r))}if(e){var d=Object.clone(e);d.json.id=o;d.json.name=a.name;c=MWF.encodeJsonString(JSON.encode(d))}if(i)a.data=s;if(e)a.mobileData=c;this.action.invoke({name:"addFormTemplate",data:a,success:t,failure:n})}.bind(this))},deleteFormTemplate:function(i,e,a,t){this.action.invoke({name:"deleteFormTemplate",async:t,parameter:{id:i},success:e,failure:a})},saveView:function(i,e,a){if(!i.isNewView){this.updateView(i,e,a)}else{i.isNewView=false;this.addView(i,e,a)}},updateView:function(i,e,a){var t=i.data;i.data=JSON.encode(i.data);this.action.invoke({name:"updataView",data:i,parameter:{id:i.id},success:e,failure:a});i.data=t},addView:function(i,e,a){var t=i.data;i.data=JSON.encode(i.data);if(!t.id){this.getUUID(function(n){i.id=n;this.action.invoke({name:"addView",data:i,success:e,failure:a});i.data=t}.bind(this))}else{this.action.invoke({name:"addView",data:i,success:e,failure:a});i.data=t}},saveStat:function(i,e,a){if(!i.isNewView){this.updateStat(i,e,a)}else{i.isNewView=false;this.addStat(i,e,a)}},updateStat:function(i,e,a){var t=i.data;i.data=JSON.encode(i.data);this.action.invoke({name:"updataStat",data:i,parameter:{id:i.id},success:e,failure:a});i.data=t},addStat:function(i,e,a){var t=i.data;i.data=JSON.encode(i.data);if(!t.id){this.getUUID(function(n){i.id=n;this.action.invoke({name:"addStat",data:i,success:e,failure:a});i.data=t}.bind(this))}else{this.action.invoke({name:"addView",data:i,success:e,failure:a});i.data=t}},deleteView:function(i,e,a,t){this.action.invoke({name:"removeView",async:t,parameter:{id:i},success:e,failure:a})},deleteStat:function(i,e,a,t){this.action.invoke({name:"removeStat",async:t,parameter:{id:i},success:e,failure:a})},saveDictionary:function(i,e,a){if(i.id){this.updateDictionary(i,e,a)}else{this.addDictionary(i,e,a)}},updateDictionary:function(i,e,a){this.action.invoke({name:"updataDictionary",data:i,parameter:{applicationDict:i.id},success:e,failure:a})},addDictionary:function(i,e,a){if(!i.id){this.getUUID(function(t){i.id=t;this.action.invoke({name:"addDictionary",data:i,success:e,failure:a})}.bind(this))}},deleteDictionary:function(i,e,a,t){this.action.invoke({name:"removeDictionary",async:t,parameter:{applicationDict:i},success:e,failure:a})},saveScript:function(i,e,a){if(!i.isNewScript){this.updateScript(i,e,a)}else{this.addScript(i,e,a)}},updateScript:function(i,e,a){this.action.invoke({name:"updataScript",data:i,parameter:{id:i.id},success:e,failure:a})},addScript:function(i,e,a){this.action.invoke({name:"addScript",data:i,success:e,failure:a})},deleteScript:function(i,e,a,t){this.action.invoke({name:"removeScript",async:t,parameter:{id:i},success:e,failure:a})},loadView:function(i,e,a,t){this.action.invoke({name:"loadView",async:t,parameter:{id:i},success:e,failure:a})},loadStat:function(i,e,a,t){this.action.invoke({name:"loadStat",async:t,parameter:{id:i},success:e,failure:a})}});