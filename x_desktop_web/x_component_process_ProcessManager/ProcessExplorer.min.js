MWF.xDesktop.requireApp("process.ProcessManager","Explorer",null,false);MWF.xApplication.process.ProcessManager.ProcessExplorer=new Class({Extends:MWF.xApplication.process.ProcessManager.Explorer,Implements:[Options,Events],_createElement:function(e){var t=function(e,t){var s={template:t,onQueryLoad:function(){this.actions=r.app.restActions;this.application=r.app.options.application}};layout.desktop.openApplication(e,"process.ProcessDesigner",s)};var s=new Element("div",{styles:this.css.createTemplateMaskNode}).inject(this.app.content);var n=new Element("div",{styles:this.css.createTemplateAreaNode}).inject(this.app.content);n.fade("in");var o=new Element("div",{styles:this.css.createTemplateScrollNode}).inject(n);var i=new Element("div",{styles:this.css.createTemplateContentNode}).inject(o);MWF.require("MWF.widget.ScrollBar",function(){new MWF.widget.ScrollBar(o,{indent:false})}.bind(this));var r=this;var c="/x_component_process_ProcessDesigner/$Process/template/templates.json";MWF.getJSON(c,function(e){e.each(function(e){var o=new Element("div",{styles:this.css.templateNode}).inject(i);var c=new Element("div",{styles:this.css.templateIconNode}).inject(o);var a=new Element("div",{styles:this.css.templateTitleNode,text:e.title}).inject(o);o.store("template",e.name);var p=new Element("img",{styles:this.css.templateIconImgNode}).inject(c);p.set("src","/x_component_process_ProcessDesigner/$Process/template/"+e.icon);o.addEvents({mouseover:function(){this.setStyles(r.css.templateNode_over)},mouseout:function(){this.setStyles(r.css.templateNode)},mousedown:function(){this.setStyles(r.css.templateNode_down)},mouseup:function(){this.setStyles(r.css.templateNode_over)},click:function(e){t(e,this.retrieve("template"));n.destroy();s.destroy()}})}.bind(this))}.bind(this));s.addEvent("click",function(){n.destroy();s.destroy()});var a=this.app.content.getSize();var p=(a.y-262)/2;var l=(a.x-828)/2;if(p<0)p=0;if(l<0)l=0;n.setStyles({top:""+p+"px",left:""+l+"px"})},_loadItemDataList:function(e){this.app.restActions.listProcess(this.app.options.application.id,e)},_getItemObject:function(e){return new MWF.xApplication.process.ProcessManager.ProcessExplorer.Process(this,e)},deleteItems:function(){this.hideDeleteAction();while(this.deleteMarkItems.length){var e=this.deleteMarkItems.shift();if(this.deleteMarkItems.length){e.deleteProcess()}else{e.deleteProcess(function(){}.bind(this))}}}});MWF.xApplication.process.ProcessManager.ProcessExplorer.Process=new Class({Extends:MWF.xApplication.process.ProcessManager.Explorer.Item,_open:function(e){var t=this;var s={onQueryLoad:function(){this.actions=t.explorer.actions;this.category=t;this.options.id=t.data.id;this.application=t.explorer.app.options.application}};this.explorer.app.desktop.openApplication(e,"process.ProcessDesigner",s)},_getIcon:function(){var e=(Math.random()*49).toInt();return"process_icon_"+e+".png"},_getLnkPar:function(){return{icon:this.explorer.path+this.explorer.options.style+"/processIcon/lnk.png",title:this.data.name,par:'process.ProcessDesigner#{"id": "'+this.data.id+'"}'}},deleteProcess:function(e){this.explorer.actions.deleteProcess(this.data.id,function(){this.node.destroy();if(e)e()}.bind(this))}});