MWF.xApplication.Setting.applications=MWF.xApplication.Setting.applications||{};MWF.require("MWF.widget.Mask",null,false);MWF.xApplication.Setting.applications.Datas=new Class({Implements:[Options,Events],initialize:function(t){this.explorer=t;this.app=this.explorer.app;this.actions=this.app.actions;this.css=this.app.css;this.items=[];this.content=this.explorer.datasContent;this.dataJson=null;this.mappingJson=null;this.load()},load:function(){this.mask=new MWF.widget.Mask({style:"desktop"});this.mask.loadNode(this.explorer.contentAreaNode);this.actions.listDataMappings(function(t){this.mappingJson=t.data;this.loadDatas()}.bind(this));this.actions.listDatas(function(t){this.dataJson=t.data;this.loadDatas()}.bind(this))},loadDatas:function(){if(this.dataJson&&this.mappingJson){Object.each(this.dataJson,function(t,s){this.items.push(new MWF.xApplication.Setting.applications.Data(this,t,s))}.bind(this));if(this.mask)this.mask.hide()}},destroy:function(){this.items.each(function(t){t.destroy()}.bind(this));this.content.destroy();MWF.release(this)}});MWF.xApplication.Setting.applications.Data=new Class({Implements:[Events],initialize:function(t,s,i){this.list=t;this.explorer=this.list.explorer;this.app=this.list.explorer.app;this.dataJson=s;this.mappingJson=this.list.mappingJson[i];this.key=i;this.container=this.list.content;this.css=this.app.css;this.servers=[];this.load()},load:function(){this.node=new Element("div",{styles:this.css.applicationNode}).inject(this.container);this.nameNode=new Element("div",{styles:this.css.applicationNameNode}).inject(this.node);this.iconNode=new Element("div",{styles:this.css.dataNameIconNode}).inject(this.nameNode);this.textNode=new Element("div",{styles:this.css.applicationNameTextNode}).inject(this.nameNode);this.textNode.set("text",this.key);this.serverListNode=new Element("div",{styles:this.css.applicationServerListNode}).inject(this.node);this.dataJson.each(function(t,s){var i=this.mappingJson[s];this.servers.push(new MWF.xApplication.Setting.applications.Data.Server(this,t,i))}.bind(this))},destroy:function(){this.servers.each(function(t){t.destroy()}.bind(this));this.node.destroy();MWF.release(this)}});MWF.xApplication.Setting.applications.Data.Server=new Class({initialize:function(t,s,i){this.data=t;this.list=this.data.list;this.explorer=this.data.explorer;this.app=this.data.explorer.app;this.json=s;this.mappingJson=i;this.container=this.data.serverListNode;this.css=this.app.css;this.load()},load:function(){this.node=new Element("div",{styles:this.css.applicationInServerNode}).inject(this.container);this.tableNode=new Element("div",{styles:this.css.applicationInServerTableNode}).inject(this.node);var t="<table width='100%' cellSpacing='0' cellPadding='0'><tr>"+"<td width='40px'></td>"+"<td style='padding: 0px 5px'>"+this.json.dataServer+"</td>"+"<td style='padding: 0px 5px'>"+this.mappingJson.url+"</td>"+"<td style='padding: 0px 5px'>"+this.mappingJson.username+"</td>"+"<td style='padding: 0px 5px'>"+this.mappingJson.password+"</td>"+"</tr></table>";this.tableNode.set("html",t);tds=this.tableNode.getElements("td");tds[0].setStyles(this.css.applicationInServerIconNode);this.jsonNode=new Element("div",{styles:this.css.applicationInServerJsonNode}).inject(this.node);this.dataJsonNode=new Element("div",{styles:this.css.dataInServerDataJsonNode}).inject(this.jsonNode);this.mappingJsonNode=new Element("div",{styles:this.css.dataInServerMappingJsonNode}).inject(this.jsonNode);this.jsonButtonNode=new Element("div",{styles:this.css.applicationInServerJsonButtonNode}).inject(this.node);var s=JSON.stringify(this.json,null,"\t");jsonHtml=s.replace(/\n|\r/g,"<br>");jsonHtml=jsonHtml.replace(/\t/g,"<font>&nbsp;&nbsp;&nbsp;&nbsp;</font>");this.dataJsonNode.set("html","<div style='font-weight: bold'>Data</div>"+jsonHtml);var i=JSON.stringify(this.mappingJson,null,"\t");mappingJsonHtml=i.replace(/\n|\r/g,"<br>");mappingJsonHtml=mappingJsonHtml.replace(/\t/g,"<font>&nbsp;&nbsp;&nbsp;&nbsp;</font>");this.mappingJsonNode.set("html","<div style='font-weight: bold'>DataMappings</div>"+mappingJsonHtml);this.jsonButtonNode.addEvent("click",function(){if(this.jsonNode.getStyle("display")=="none"){this.jsonNode.setStyle("display","block");this.jsonButtonNode.setStyle("background","url(/x_component_Setting/$Main/default/icon/up.png) no-repeat center center")}else{this.jsonNode.setStyle("display","none");this.jsonButtonNode.setStyle("background","url(/x_component_Setting/$Main/default/icon/down.png) no-repeat center center")}}.bind(this))},destroy:function(){this.node.destroy();MWF.release(this)}});