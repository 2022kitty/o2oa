<?xml version="1.0" encoding="UTF-8"?>
<project basedir="." name="main" default="default">
	<basename property="project" file="${basedir}" />
	<dirname property="root.dir" file="${basedir}../" />
	<property file="${root.dir}/building/build.properties" />
	<include file="${root.dir}/building/build_common.xml" as="common" />


	<tstamp>
		<format property="TODAY" pattern="yyyyMMdd" locale="zh-cn" />
	</tstamp>

	<!--不需要拷贝config配置文件,也不创建node.cfg,不创建local目录和log目录,不拷贝jvm-->
	<target name="default">
		<mkdir dir="versions/4${TODAY}01" />
		<delete includeemptydirs="true">
			<fileset dir="versions/4${TODAY}01" includes="**/*" />
		</delete>
		<copy todir="versions/4${TODAY}01/commons/ext">
			<fileset dir="D:/o2server/commons/ext" />
		</copy>
		<copy todir="versions/4${TODAY}01/commons">
			<fileset dir="D:/o2server/commons">
				<include name="initialScriptText.js" />
				<include name="mime.types" />
				<include name="webdefault.xml" />
			</fileset>
		</copy>
		<mkdir dir="versions/4${TODAY}01/servers/centerServer/webapps" />
		<mkdir dir="versions/4${TODAY}01/servers/centerServer/work" />
		<mkdir dir="versions/4${TODAY}01/servers/applicationServer/webapps" />
		<mkdir dir="versions/4${TODAY}01/servers/applicationServer/work" />
		<copy todir="versions/4${TODAY}01/servers/webServer/">
			<fileset dir="D:/o2server/servers/webServer/">
				<exclude name="**/.svn/" />
				<exclude name="**/Thumbs.db" />
				<exclude name="**/*.bak" />
				<exclude name="**/~*" />
			</fileset>
		</copy>
		<copy todir="versions/4${TODAY}01/store/">
			<fileset dir="D:/o2server/store/" />
		</copy>
		<copy todir="versions/4${TODAY}01">
			<fileset dir="D:/o2server/">
				<include name="console.jar" />
				<include name="start.bat" />
				<include name="start.sh" />
				<!--include name="version.o2" /-->
			</fileset>
		</copy>
		<echo file="versions/4${TODAY}01/version.o2" append="false">4${TODAY}01</echo>
		<touch file="versions/4${TODAY}01/description.txt" />
	</target>
</project>